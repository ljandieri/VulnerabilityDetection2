C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  14:55
total length of the sample set: 55179
cutoff 38625
cutoff2 46902
Creating training dataset... (xss)
Creating validation dataset...
Creating finaltest dataset...
Train length: 38625
Test length: 8277
Finaltesting length: 8277
time:  14:55
Maxlen has been calculated to be 40
numpy array done.  14:55
38625 samples in the training set.
8277 samples in the validation set.
8277 samples in the final test set.
percentage of vulnerable samples: 8.81%
absolute amount of vulnerable samples in test set: 736
Starting Transformer:  14:55
2022-03-15 14:55:40.337929: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 14:55:40.779736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
38/38 [==============================] - 2s 18ms/step - loss: 0.7996 - f1: 0.2828
Epoch 2/100
38/38 [==============================] - 1s 17ms/step - loss: 0.2258 - f1: 0.8586
Epoch 3/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0798 - f1: 0.9251
Epoch 4/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0626 - f1: 0.9397
Epoch 5/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0491 - f1: 0.9527
Epoch 6/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0443 - f1: 0.9573
Epoch 7/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0449 - f1: 0.9563
Epoch 8/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0373 - f1: 0.9633
Epoch 9/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0406 - f1: 0.9603
Epoch 10/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0426 - f1: 0.9582
Epoch 11/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0399 - f1: 0.9606
Epoch 12/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0402 - f1: 0.9598
Epoch 13/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0355 - f1: 0.9642
Epoch 14/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0348 - f1: 0.9657
Epoch 15/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0369 - f1: 0.9635
Epoch 16/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0444 - f1: 0.9561
Epoch 17/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0306 - f1: 0.9694
Epoch 18/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0320 - f1: 0.9683
Epoch 19/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0274 - f1: 0.9731
Epoch 20/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0290 - f1: 0.9714
Epoch 21/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0272 - f1: 0.9730
Epoch 22/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0271 - f1: 0.9727
Epoch 23/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0262 - f1: 0.9734
Epoch 24/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0266 - f1: 0.9733
Epoch 25/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0271 - f1: 0.9730
Epoch 26/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0281 - f1: 0.9719
Epoch 27/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0288 - f1: 0.9717
Epoch 28/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0318 - f1: 0.9684
Epoch 29/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0273 - f1: 0.9728
Epoch 30/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0342 - f1: 0.9654
Epoch 31/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0294 - f1: 0.9707
Epoch 32/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0248 - f1: 0.9757
Epoch 33/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0263 - f1: 0.9740
Epoch 34/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0294 - f1: 0.9706
Epoch 35/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0270 - f1: 0.9732
Epoch 36/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0264 - f1: 0.9737
Epoch 37/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0246 - f1: 0.9756
Epoch 38/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0241 - f1: 0.9760
Epoch 39/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0245 - f1: 0.9755
Epoch 40/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0271 - f1: 0.9727
Epoch 41/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0246 - f1: 0.9756
Epoch 42/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0229 - f1: 0.9772
Epoch 43/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0227 - f1: 0.9774
Epoch 44/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0231 - f1: 0.9769
Epoch 45/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0230 - f1: 0.9772
Epoch 46/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9787
Epoch 47/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0216 - f1: 0.9784
Epoch 48/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0214 - f1: 0.9785
Epoch 49/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9784
Epoch 50/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9788
Epoch 51/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9788
Epoch 52/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9787
Epoch 53/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9788
Epoch 54/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9790
Epoch 55/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9788
Epoch 56/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0215 - f1: 0.9786
Epoch 57/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9786
Epoch 58/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9790
Epoch 59/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9789
Epoch 60/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0209 - f1: 0.9790
Epoch 61/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0214 - f1: 0.9786
Epoch 62/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9789
Epoch 63/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9791
Epoch 64/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9786
Epoch 65/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9790
Epoch 66/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9790
Epoch 67/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9788
Epoch 68/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0215 - f1: 0.9784
Epoch 69/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9788
Epoch 70/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0215 - f1: 0.9786
Epoch 71/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9786
Epoch 72/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9788
Epoch 73/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9789
Epoch 74/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0207 - f1: 0.9793
Epoch 75/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9790
Epoch 76/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9788
Epoch 77/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9785
Epoch 78/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9787
Epoch 79/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0215 - f1: 0.9786
Epoch 80/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9790
Epoch 81/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9788
Epoch 82/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9783
Epoch 83/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0211 - f1: 0.9788
Epoch 84/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9787
Epoch 85/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9788
Epoch 86/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9789
Epoch 87/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0214 - f1: 0.9787
Epoch 88/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0212 - f1: 0.9787
Epoch 89/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0214 - f1: 0.9786
Epoch 90/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9787
Epoch 91/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0211 - f1: 0.9789
Epoch 92/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0209 - f1: 0.9792
Epoch 93/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9788
Epoch 94/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0210 - f1: 0.9789
Epoch 95/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0209 - f1: 0.9790
Epoch 96/100
38/38 [==============================] - 1s 18ms/step - loss: 0.0214 - f1: 0.9787
Epoch 97/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0216 - f1: 0.9784
Epoch 98/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0214 - f1: 0.9785
Epoch 99/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0213 - f1: 0.9787
Epoch 100/100
38/38 [==============================] - 1s 17ms/step - loss: 0.0210 - f1: 0.9788
Compiled Transformer:  14:56
Now predicting on train set 
Accuracy: 0.9962718446601941
Precision: 0.9766218585622443
Recall: 0.9812096300645919
F1 score: 0.978910


Now predicting on test set 
Accuracy: 0.991784462969675
Precision: 0.946524064171123
Recall: 0.9619565217391305
F1 score: 0.954178


Now predicting on finaltest set 
Accuracy: 0.9914220128065724
Precision: 0.9477401129943502
Recall: 0.9517730496453901
F1 score: 0.949752


saving transformer model xss.  14:56




Process finished with exit code 0
