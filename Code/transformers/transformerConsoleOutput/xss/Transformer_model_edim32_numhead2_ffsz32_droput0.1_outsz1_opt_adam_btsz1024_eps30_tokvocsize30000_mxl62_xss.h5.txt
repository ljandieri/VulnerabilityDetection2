C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  13:38
total length of the sample set: 55179
cutoff 38625
cutoff2 46902
Creating training dataset... (xss)
Creating validation dataset...
Creating finaltest dataset...
Train length: 38625
Test length: 8277
Finaltesting length: 8277
time:  13:39
Maxlen has been calculated to be 62
numpy array done.  13:39
38625 samples in the training set.
8277 samples in the validation set.
8277 samples in the final test set.
percentage of vulnerable samples: 8.67%
absolute amount of vulnerable samples in test set: 795
Starting Transformer:  13:39
2022-03-15 13:39:17.776655: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 13:39:18.202022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/30
38/38 [==============================] - 3s 24ms/step - loss: 0.7479 - f1: 0.3588
Epoch 2/30
38/38 [==============================] - 1s 23ms/step - loss: 0.2343 - f1: 0.8060
Epoch 3/30
38/38 [==============================] - 1s 23ms/step - loss: 0.1231 - f1: 0.8834
Epoch 4/30
38/38 [==============================] - 1s 23ms/step - loss: 0.1052 - f1: 0.8984
Epoch 5/30
38/38 [==============================] - 1s 23ms/step - loss: 0.1046 - f1: 0.8968
Epoch 6/30
38/38 [==============================] - 1s 23ms/step - loss: 0.0999 - f1: 0.9009
Epoch 7/30
38/38 [==============================] - 1s 23ms/step - loss: 0.1000 - f1: 0.9004
Epoch 8/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0906 - f1: 0.9101
Epoch 9/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0965 - f1: 0.9035
Epoch 10/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0905 - f1: 0.9100
Epoch 11/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0834 - f1: 0.9173
Epoch 12/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0851 - f1: 0.9143
Epoch 13/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0979 - f1: 0.9025
Epoch 14/30
38/38 [==============================] - 1s 22ms/step - loss: 0.1024 - f1: 0.8979
Epoch 15/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0894 - f1: 0.9111
Epoch 16/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0914 - f1: 0.9088
Epoch 17/30
38/38 [==============================] - 1s 23ms/step - loss: 0.0807 - f1: 0.9201
Epoch 18/30
38/38 [==============================] - 1s 23ms/step - loss: 0.0805 - f1: 0.9201
Epoch 19/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0795 - f1: 0.9201
Epoch 20/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0873 - f1: 0.9130
Epoch 21/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0910 - f1: 0.9089
Epoch 22/30
38/38 [==============================] - 1s 23ms/step - loss: 0.0907 - f1: 0.9095
Epoch 23/30
38/38 [==============================] - 1s 23ms/step - loss: 0.0779 - f1: 0.9226
Epoch 24/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0805 - f1: 0.9193
Epoch 25/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0849 - f1: 0.9152
Epoch 26/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0835 - f1: 0.9166
Epoch 27/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0931 - f1: 0.9069
Epoch 28/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0801 - f1: 0.9204
Epoch 29/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0763 - f1: 0.9237
Epoch 30/30
38/38 [==============================] - 1s 22ms/step - loss: 0.0845 - f1: 0.9158
Compiled Transformer:  13:39
Now predicting on train set 
Accuracy: 0.9870032362459547
Precision: 0.9489281210592686
Recall: 0.8985074626865671
F1 score: 0.923030


Now predicting on test set 
Accuracy: 0.9819983085659055
Precision: 0.9306666666666666
Recall: 0.8779874213836478
F1 score: 0.903560


Now predicting on finaltest set 
Accuracy: 0.9813942249607346
Precision: 0.9321766561514195
Recall: 0.8418803418803419
F1 score: 0.884731


saving transformer model xss.  13:39




Process finished with exit code 0
