C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  14:30
total length of the sample set: 55179
cutoff 38625
cutoff2 46902
Creating training dataset... (xss)
Creating validation dataset...
Creating finaltest dataset...
Train length: 38625
Test length: 8277
Finaltesting length: 8277
time:  14:31
Maxlen has been calculated to be 62
numpy array done.  14:31
38625 samples in the training set.
8277 samples in the validation set.
8277 samples in the final test set.
percentage of vulnerable samples: 8.79%
absolute amount of vulnerable samples in test set: 744
Starting Transformer:  14:31
2022-03-15 14:31:23.004781: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 14:31:23.428949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
38/38 [==============================] - 3s 23ms/step - loss: 0.7174 - f1: 0.3912
Epoch 2/100
38/38 [==============================] - 1s 22ms/step - loss: 0.2018 - f1: 0.8206
Epoch 3/100
38/38 [==============================] - 1s 22ms/step - loss: 0.1324 - f1: 0.8712
Epoch 4/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0991 - f1: 0.9036
Epoch 5/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0922 - f1: 0.9094
Epoch 6/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0941 - f1: 0.9073
Epoch 7/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0866 - f1: 0.9145
Epoch 8/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0845 - f1: 0.9170
Epoch 9/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0867 - f1: 0.9134
Epoch 10/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0918 - f1: 0.9096
Epoch 11/100
38/38 [==============================] - 1s 22ms/step - loss: 0.1063 - f1: 0.8940
Epoch 12/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0993 - f1: 0.9017
Epoch 13/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0903 - f1: 0.9092
Epoch 14/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0874 - f1: 0.9133
Epoch 15/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0829 - f1: 0.9177
Epoch 16/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0778 - f1: 0.9222
Epoch 17/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0765 - f1: 0.9236
Epoch 18/100
38/38 [==============================] - 1s 24ms/step - loss: 0.0816 - f1: 0.9183
Epoch 19/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0852 - f1: 0.9159
Epoch 20/100
38/38 [==============================] - 1s 24ms/step - loss: 0.0907 - f1: 0.9096
Epoch 21/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0753 - f1: 0.9250
Epoch 22/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0757 - f1: 0.9248
Epoch 23/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0731 - f1: 0.9268
Epoch 24/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0835 - f1: 0.9169
Epoch 25/100
38/38 [==============================] - 1s 22ms/step - loss: 0.1065 - f1: 0.8935
Epoch 26/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0875 - f1: 0.9124
Epoch 27/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0800 - f1: 0.9208
Epoch 28/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0757 - f1: 0.9244
Epoch 29/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0751 - f1: 0.9246
Epoch 30/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0759 - f1: 0.9246
Epoch 31/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0750 - f1: 0.9252
Epoch 32/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0729 - f1: 0.9272
Epoch 33/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0726 - f1: 0.9272
Epoch 34/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0783 - f1: 0.9219
Epoch 35/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0780 - f1: 0.9218
Epoch 36/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0795 - f1: 0.9210
Epoch 37/100
38/38 [==============================] - 1s 25ms/step - loss: 0.0867 - f1: 0.9132
Epoch 38/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0835 - f1: 0.9169
Epoch 39/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0753 - f1: 0.9248
Epoch 40/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0728 - f1: 0.9274
Epoch 41/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0769 - f1: 0.9230
Epoch 42/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0755 - f1: 0.9247
Epoch 43/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0742 - f1: 0.9256
Epoch 44/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0740 - f1: 0.9262
Epoch 45/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0824 - f1: 0.9174
Epoch 46/100
38/38 [==============================] - 1s 25ms/step - loss: 0.0756 - f1: 0.9247
Epoch 47/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0753 - f1: 0.9246
Epoch 48/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0776 - f1: 0.9221
Epoch 49/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0736 - f1: 0.9261
Epoch 50/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0747 - f1: 0.9259
Epoch 51/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0783 - f1: 0.9219
Epoch 52/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0722 - f1: 0.9280
Epoch 53/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0707 - f1: 0.9292
Epoch 54/100
38/38 [==============================] - 1s 24ms/step - loss: 0.0726 - f1: 0.9278
Epoch 55/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0720 - f1: 0.9285
Epoch 56/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0772 - f1: 0.9231
Epoch 57/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0729 - f1: 0.9270
Epoch 58/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0705 - f1: 0.9295
Epoch 59/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0800 - f1: 0.9201
Epoch 60/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0715 - f1: 0.9286
Epoch 61/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0703 - f1: 0.9301
Epoch 62/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0675 - f1: 0.9327
Epoch 63/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0685 - f1: 0.9311
Epoch 64/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0683 - f1: 0.9319
Epoch 65/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0723 - f1: 0.9277
Epoch 66/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0733 - f1: 0.9266
Epoch 67/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0741 - f1: 0.9264
Epoch 68/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0773 - f1: 0.9228
Epoch 69/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0671 - f1: 0.9329
Epoch 70/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0687 - f1: 0.9315
Epoch 71/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0686 - f1: 0.9316
Epoch 72/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0663 - f1: 0.9341
Epoch 73/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0660 - f1: 0.9343
Epoch 74/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0664 - f1: 0.9337
Epoch 75/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0714 - f1: 0.9288
Epoch 76/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0666 - f1: 0.9335
Epoch 77/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0700 - f1: 0.9298
Epoch 78/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0682 - f1: 0.9321
Epoch 79/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0697 - f1: 0.9305
Epoch 80/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0682 - f1: 0.9319
Epoch 81/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0695 - f1: 0.9307
Epoch 82/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0694 - f1: 0.9303
Epoch 83/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0693 - f1: 0.9308
Epoch 84/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0709 - f1: 0.9293
Epoch 85/100
38/38 [==============================] - 1s 24ms/step - loss: 0.0678 - f1: 0.9319
Epoch 86/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0683 - f1: 0.9316
Epoch 87/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0767 - f1: 0.9234
Epoch 88/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0666 - f1: 0.9334
Epoch 89/100
38/38 [==============================] - 1s 24ms/step - loss: 0.0677 - f1: 0.9323
Epoch 90/100
38/38 [==============================] - 1s 25ms/step - loss: 0.0683 - f1: 0.9318
Epoch 91/100
38/38 [==============================] - 1s 25ms/step - loss: 0.0654 - f1: 0.9344
Epoch 92/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0647 - f1: 0.9351
Epoch 93/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0663 - f1: 0.9337
Epoch 94/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0626 - f1: 0.9375
Epoch 95/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0703 - f1: 0.9299
Epoch 96/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0665 - f1: 0.9338
Epoch 97/100
38/38 [==============================] - 1s 23ms/step - loss: 0.0661 - f1: 0.9342
Epoch 98/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0659 - f1: 0.9342
Epoch 99/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0644 - f1: 0.9358
Epoch 100/100
38/38 [==============================] - 1s 22ms/step - loss: 0.0716 - f1: 0.9285
Compiled Transformer:  14:32
Now predicting on train set 
Accuracy: 0.9884789644012945
Precision: 0.9478155339805825
Recall: 0.9196349720341478
F1 score: 0.933513


Now predicting on test set 
Accuracy: 0.9864685272441706
Precision: 0.9352617079889807
Recall: 0.9126344086021505
F1 score: 0.923810


Now predicting on finaltest set 
Accuracy: 0.9857436269179655
Precision: 0.9224137931034483
Recall: 0.9093484419263456
F1 score: 0.915835


saving transformer model xss.  14:32




Process finished with exit code 0
