C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  11:53
total length of the sample set: 125426
cutoff 87798
cutoff2 106612
Creating training dataset... (command_injection)
Creating validation dataset...
Creating finaltest dataset...
Train length: 87798
Test length: 18814
Finaltesting length: 18814
time:  11:55
Maxlen has been calculated to be 61
numpy array done.  11:55
87798 samples in the training set.
18814 samples in the validation set.
18814 samples in the final test set.
percentage of vulnerable samples: 12.5%
absolute amount of vulnerable samples in test set: 2323
Starting Transformer:  11:55
2022-03-16 11:55:22.519953: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-16 11:55:22.922598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
86/86 [==============================] - 4s 22ms/step - loss: 0.7781 - f1: 0.2223
Epoch 2/100
86/86 [==============================] - 2s 22ms/step - loss: 0.3425 - f1: 0.6955
Epoch 3/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0737 - f1: 0.9275
Epoch 4/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0729 - f1: 0.9280
Epoch 5/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0552 - f1: 0.9450
Epoch 6/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0704 - f1: 0.9297
Epoch 7/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0552 - f1: 0.9451
Epoch 8/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0540 - f1: 0.9462
Epoch 9/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0475 - f1: 0.9524
Epoch 10/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0489 - f1: 0.9513
Epoch 11/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0456 - f1: 0.9544
Epoch 12/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0462 - f1: 0.9539
Epoch 13/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0450 - f1: 0.9549
Epoch 14/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0414 - f1: 0.9588
Epoch 15/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0379 - f1: 0.9620
Epoch 16/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0415 - f1: 0.9585
Epoch 17/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0422 - f1: 0.9578
Epoch 18/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0380 - f1: 0.9619
Epoch 19/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0365 - f1: 0.9637
Epoch 20/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0372 - f1: 0.9628
Epoch 21/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0370 - f1: 0.9631
Epoch 22/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0397 - f1: 0.9602
Epoch 23/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0374 - f1: 0.9627
Epoch 24/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0371 - f1: 0.9630
Epoch 25/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0366 - f1: 0.9635
Epoch 26/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0377 - f1: 0.9624
Epoch 27/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0353 - f1: 0.9648
Epoch 28/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0361 - f1: 0.9639
Epoch 29/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0366 - f1: 0.9635
Epoch 30/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0353 - f1: 0.9647
Epoch 31/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0350 - f1: 0.9650
Epoch 32/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0378 - f1: 0.9622
Epoch 33/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0334 - f1: 0.9666
Epoch 34/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0316 - f1: 0.9683
Epoch 35/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0329 - f1: 0.9670
Epoch 36/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0323 - f1: 0.9677
Epoch 37/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0348 - f1: 0.9653
Epoch 38/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0325 - f1: 0.9675
Epoch 39/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0338 - f1: 0.9662
Epoch 40/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0319 - f1: 0.9682
Epoch 41/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0324 - f1: 0.9676
Epoch 42/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0367 - f1: 0.9633
Epoch 43/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0355 - f1: 0.9647
Epoch 44/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0330 - f1: 0.9669
Epoch 45/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0339 - f1: 0.9660
Epoch 46/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0332 - f1: 0.9669
Epoch 47/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0306 - f1: 0.9695
Epoch 48/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0300 - f1: 0.9700
Epoch 49/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0298 - f1: 0.9701
Epoch 50/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0285 - f1: 0.9715
Epoch 51/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0272 - f1: 0.9728
Epoch 52/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0290 - f1: 0.9710
Epoch 53/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0292 - f1: 0.9709
Epoch 54/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0296 - f1: 0.9704
Epoch 55/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0287 - f1: 0.9713
Epoch 56/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0285 - f1: 0.9714
Epoch 57/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0285 - f1: 0.9715
Epoch 58/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0284 - f1: 0.9717
Epoch 59/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0287 - f1: 0.9713
Epoch 60/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0311 - f1: 0.9689
Epoch 61/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0301 - f1: 0.9700
Epoch 62/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0324 - f1: 0.9677
Epoch 63/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0365 - f1: 0.9635
Epoch 64/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0300 - f1: 0.9700
Epoch 65/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0348 - f1: 0.9652
Epoch 66/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0344 - f1: 0.9657
Epoch 67/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0313 - f1: 0.9686
Epoch 68/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0305 - f1: 0.9695
Epoch 69/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0294 - f1: 0.9706
Epoch 70/100
86/86 [==============================] - 2s 23ms/step - loss: 0.0306 - f1: 0.9694
Epoch 71/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0300 - f1: 0.9699
Epoch 72/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0299 - f1: 0.9701
Epoch 73/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0284 - f1: 0.9716
Epoch 74/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0275 - f1: 0.9725
Epoch 75/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0265 - f1: 0.9735
Epoch 76/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0256 - f1: 0.9744
Epoch 77/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0258 - f1: 0.9743
Epoch 78/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0261 - f1: 0.9739
Epoch 79/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0261 - f1: 0.9738
Epoch 80/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0261 - f1: 0.9739
Epoch 81/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0261 - f1: 0.9739
Epoch 82/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9739
Epoch 83/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0261 - f1: 0.9739
Epoch 84/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9741
Epoch 85/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9740
Epoch 86/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0259 - f1: 0.9741
Epoch 87/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0262 - f1: 0.9738
Epoch 88/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9740
Epoch 89/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9740
Epoch 90/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9741
Epoch 91/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9740
Epoch 92/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9740
Epoch 93/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0259 - f1: 0.9740
Epoch 94/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0260 - f1: 0.9739
Epoch 95/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0254 - f1: 0.9747
Epoch 96/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0258 - f1: 0.9741
Epoch 97/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0267 - f1: 0.9733
Epoch 98/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0283 - f1: 0.9717
Epoch 99/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0323 - f1: 0.9674
Epoch 100/100
86/86 [==============================] - 2s 22ms/step - loss: 0.0279 - f1: 0.9721
Compiled Transformer:  11:58
Now predicting on train set 
Accuracy: 0.9932230802523976
Precision: 0.9761599119750596
Recall: 0.969492760222202
F1 score: 0.972815


Now predicting on test set 
Accuracy: 0.9887317954714574
Precision: 0.9655932951036612
Recall: 0.9423159707275075
F1 score: 0.953813


Now predicting on finaltest set 
Accuracy: 0.9890507069203784
Precision: 0.9637262984336357
Recall: 0.9519543973941368
F1 score: 0.957804


saving transformer model command_injection.  11:58




Process finished with exit code 0
