C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  12:12
total length of the sample set: 125426
cutoff 87798
cutoff2 106612
Creating training dataset... (command_injection)
Creating validation dataset...
Creating finaltest dataset...
Train length: 87798
Test length: 18814
Finaltesting length: 18814
time:  12:14
Maxlen has been calculated to be 53
numpy array done.  12:14
87798 samples in the training set.
18814 samples in the validation set.
18814 samples in the final test set.
percentage of vulnerable samples: 12.6%
absolute amount of vulnerable samples in test set: 2362
Starting Transformer:  12:14
2022-03-15 12:14:19.708049: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 12:14:20.164343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
86/86 [==============================] - 4s 21ms/step - loss: 0.5221 - f1: 0.5187
Epoch 2/100
86/86 [==============================] - 2s 21ms/step - loss: 0.1604 - f1: 0.8433
Epoch 3/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1277 - f1: 0.8735
Epoch 4/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1214 - f1: 0.8790
Epoch 5/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1138 - f1: 0.8868
Epoch 6/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1127 - f1: 0.8874
Epoch 7/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1087 - f1: 0.8914
Epoch 8/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1048 - f1: 0.8953
Epoch 9/100
86/86 [==============================] - 2s 21ms/step - loss: 0.1024 - f1: 0.8977
Epoch 10/100
86/86 [==============================] - 2s 21ms/step - loss: 0.1017 - f1: 0.8983
Epoch 11/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0937 - f1: 0.9061
Epoch 12/100
86/86 [==============================] - 2s 21ms/step - loss: 0.1011 - f1: 0.8989
Epoch 13/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1036 - f1: 0.8963
Epoch 14/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1000 - f1: 0.9002
Epoch 15/100
86/86 [==============================] - 2s 21ms/step - loss: 0.1028 - f1: 0.8974
Epoch 16/100
86/86 [==============================] - 2s 20ms/step - loss: 0.1071 - f1: 0.8929
Epoch 17/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0934 - f1: 0.9067
Epoch 18/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0955 - f1: 0.9046
Epoch 19/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0930 - f1: 0.9071
Epoch 20/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0885 - f1: 0.9112
Epoch 21/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0906 - f1: 0.9093
Epoch 22/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0939 - f1: 0.9061
Epoch 23/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0859 - f1: 0.9143
Epoch 24/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0917 - f1: 0.9083
Epoch 25/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0908 - f1: 0.9093
Epoch 26/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0897 - f1: 0.9104
Epoch 27/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0864 - f1: 0.9132
Epoch 28/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0833 - f1: 0.9166
Epoch 29/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0868 - f1: 0.9131
Epoch 30/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0858 - f1: 0.9144
Epoch 31/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0848 - f1: 0.9152
Epoch 32/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0842 - f1: 0.9160
Epoch 33/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0844 - f1: 0.9156
Epoch 34/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0849 - f1: 0.9151
Epoch 35/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0814 - f1: 0.9187
Epoch 36/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0813 - f1: 0.9188
Epoch 37/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0833 - f1: 0.9167
Epoch 38/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0830 - f1: 0.9167
Epoch 39/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0866 - f1: 0.9135
Epoch 40/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0816 - f1: 0.9186
Epoch 41/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0805 - f1: 0.9196
Epoch 42/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0800 - f1: 0.9200
Epoch 43/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0798 - f1: 0.9202
Epoch 44/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0781 - f1: 0.9220
Epoch 45/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0798 - f1: 0.9202
Epoch 46/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0908 - f1: 0.9094
Epoch 47/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0816 - f1: 0.9184
Epoch 48/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0814 - f1: 0.9187
Epoch 49/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0834 - f1: 0.9164
Epoch 50/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0816 - f1: 0.9186
Epoch 51/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0804 - f1: 0.9195
Epoch 52/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0791 - f1: 0.9209
Epoch 53/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0778 - f1: 0.9221
Epoch 54/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0783 - f1: 0.9216
Epoch 55/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0762 - f1: 0.9237
Epoch 56/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0740 - f1: 0.9260
Epoch 57/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0741 - f1: 0.9260
Epoch 58/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0782 - f1: 0.9218
Epoch 59/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0789 - f1: 0.9212
Epoch 60/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0743 - f1: 0.9257
Epoch 61/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0736 - f1: 0.9265
Epoch 62/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0733 - f1: 0.9267
Epoch 63/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0746 - f1: 0.9253
Epoch 64/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0782 - f1: 0.9218
Epoch 65/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0768 - f1: 0.9233
Epoch 66/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0778 - f1: 0.9223
Epoch 67/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0746 - f1: 0.9254
Epoch 68/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0749 - f1: 0.9252
Epoch 69/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0745 - f1: 0.9254
Epoch 70/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0775 - f1: 0.9225
Epoch 71/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0757 - f1: 0.9244
Epoch 72/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0755 - f1: 0.9245
Epoch 73/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0774 - f1: 0.9228
Epoch 74/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0795 - f1: 0.9204
Epoch 75/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0798 - f1: 0.9203
Epoch 76/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0795 - f1: 0.9205
Epoch 77/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0759 - f1: 0.9239
Epoch 78/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0743 - f1: 0.9257
Epoch 79/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0754 - f1: 0.9245
Epoch 80/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0793 - f1: 0.9205
Epoch 81/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0791 - f1: 0.9211
Epoch 82/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0750 - f1: 0.9247
Epoch 83/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0746 - f1: 0.9255
Epoch 84/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0735 - f1: 0.9264
Epoch 85/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0755 - f1: 0.9245
Epoch 86/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0733 - f1: 0.9268
Epoch 87/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0712 - f1: 0.9288
Epoch 88/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0721 - f1: 0.9279
Epoch 89/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0710 - f1: 0.9291
Epoch 90/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0726 - f1: 0.9275
Epoch 91/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0729 - f1: 0.9271
Epoch 92/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0762 - f1: 0.9238
Epoch 93/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0823 - f1: 0.9178
Epoch 94/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0740 - f1: 0.9259
Epoch 95/100
86/86 [==============================] - 2s 21ms/step - loss: 0.0719 - f1: 0.9280
Epoch 96/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0728 - f1: 0.9272
Epoch 97/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0714 - f1: 0.9286
Epoch 98/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0746 - f1: 0.9255
Epoch 99/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0704 - f1: 0.9297
Epoch 100/100
86/86 [==============================] - 2s 20ms/step - loss: 0.0727 - f1: 0.9275
Compiled Transformer:  12:17
Now predicting on train set 
Accuracy: 0.9821294334722886
Precision: 0.937465463252901
Recall: 0.9195952660583612
F1 score: 0.928444


Now predicting on test set 
Accuracy: 0.9798022749016689
Precision: 0.9242294520547946
Recall: 0.9140558848433531
F1 score: 0.919115


Now predicting on finaltest set 
Accuracy: 0.9782608695652174
Precision: 0.9217926186291739
Recall: 0.9008158007728639
F1 score: 0.911183


saving transformer model command_injection.  12:17




Process finished with exit code 0
