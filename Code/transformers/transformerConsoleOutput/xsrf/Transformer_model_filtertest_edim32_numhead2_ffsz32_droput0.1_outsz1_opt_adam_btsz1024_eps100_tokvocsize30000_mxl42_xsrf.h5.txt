C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  12:51
total length of the sample set: 182891
cutoff 128024
cutoff2 155457
Creating training dataset... (xsrf)
Creating validation dataset...
Creating finaltest dataset...
Train length: 128024
Test length: 27433
Finaltesting length: 27434
time:  12:54
Maxlen has been calculated to be 42
numpy array done.  12:54
128024 samples in the training set.
27433 samples in the validation set.
27434 samples in the final test set.
percentage of vulnerable samples: 13.1%
absolute amount of vulnerable samples in test set: 3665
Starting Transformer:  12:54
2022-03-16 12:54:17.901215: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-16 12:54:18.316279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
126/126 [==============================] - 4s 19ms/step - loss: 0.5632 - f1: 0.4547
Epoch 2/100
126/126 [==============================] - 2s 18ms/step - loss: 0.1030 - f1: 0.8923
Epoch 3/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0809 - f1: 0.9202
Epoch 4/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0720 - f1: 0.9285
Epoch 5/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0677 - f1: 0.9333
Epoch 6/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0700 - f1: 0.9308
Epoch 7/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0733 - f1: 0.9273
Epoch 8/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0650 - f1: 0.9356
Epoch 9/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0661 - f1: 0.9344
Epoch 10/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0609 - f1: 0.9396
Epoch 11/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0547 - f1: 0.9457
Epoch 12/100
126/126 [==============================] - 2s 20ms/step - loss: 0.0540 - f1: 0.9444
Epoch 13/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0533 - f1: 0.9474
Epoch 14/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0522 - f1: 0.9483
Epoch 15/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0533 - f1: 0.9472
Epoch 16/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0522 - f1: 0.9456
Epoch 17/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0500 - f1: 0.9504
Epoch 18/100
126/126 [==============================] - 2s 20ms/step - loss: 0.0492 - f1: 0.9495
Epoch 19/100
126/126 [==============================] - 3s 20ms/step - loss: 0.0501 - f1: 0.9503
Epoch 20/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0519 - f1: 0.9485
Epoch 21/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0483 - f1: 0.9521
Epoch 22/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0502 - f1: 0.9425
Epoch 23/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0483 - f1: 0.9520
Epoch 24/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0472 - f1: 0.9533
Epoch 25/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0559 - f1: 0.9444
Epoch 26/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0496 - f1: 0.9508
Epoch 27/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0477 - f1: 0.9512
Epoch 28/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0479 - f1: 0.9525
Epoch 29/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0477 - f1: 0.9527
Epoch 30/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0490 - f1: 0.9437
Epoch 31/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0474 - f1: 0.9529
Epoch 32/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0490 - f1: 0.9515
Epoch 33/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0484 - f1: 0.9509
Epoch 34/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0476 - f1: 0.9509
Epoch 35/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0472 - f1: 0.9532
Epoch 36/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0472 - f1: 0.9532
Epoch 37/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0459 - f1: 0.9467
Epoch 38/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0469 - f1: 0.9534
Epoch 39/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0503 - f1: 0.9500
Epoch 40/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0468 - f1: 0.9530
Epoch 41/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0454 - f1: 0.9550
Epoch 42/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0458 - f1: 0.9545
Epoch 43/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0452 - f1: 0.9552
Epoch 44/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0480 - f1: 0.9509
Epoch 45/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0459 - f1: 0.9545
Epoch 46/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0456 - f1: 0.9546
Epoch 47/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0461 - f1: 0.9542
Epoch 48/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0462 - f1: 0.9542
Epoch 49/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0476 - f1: 0.9527
Epoch 50/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0468 - f1: 0.9536
Epoch 51/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0480 - f1: 0.9508
Epoch 52/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0468 - f1: 0.9525
Epoch 53/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0452 - f1: 0.9551
Epoch 54/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0461 - f1: 0.9543
Epoch 55/100
126/126 [==============================] - 2s 20ms/step - loss: 0.0494 - f1: 0.9511
Epoch 56/100
126/126 [==============================] - 3s 20ms/step - loss: 0.0495 - f1: 0.9494
Epoch 57/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0477 - f1: 0.9527
Epoch 58/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0463 - f1: 0.9541
Epoch 59/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0454 - f1: 0.9550
Epoch 60/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0433 - f1: 0.9493
Epoch 61/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0447 - f1: 0.9557
Epoch 62/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0439 - f1: 0.9564
Epoch 63/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0427 - f1: 0.9577
Epoch 64/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0446 - f1: 0.9558
Epoch 65/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0428 - f1: 0.9560
Epoch 66/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0427 - f1: 0.9577
Epoch 67/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0463 - f1: 0.9541
Epoch 68/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0446 - f1: 0.9538
Epoch 69/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0435 - f1: 0.9557
Epoch 70/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0437 - f1: 0.9558
Epoch 71/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0430 - f1: 0.9574
Epoch 72/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0434 - f1: 0.9569
Epoch 73/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0430 - f1: 0.9573
Epoch 74/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0445 - f1: 0.9552
Epoch 75/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0414 - f1: 0.9581
Epoch 76/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0428 - f1: 0.9549
Epoch 77/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0438 - f1: 0.9565
Epoch 78/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0442 - f1: 0.9561
Epoch 79/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0451 - f1: 0.9553
Epoch 80/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0440 - f1: 0.9564
Epoch 81/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0441 - f1: 0.9554
Epoch 82/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0437 - f1: 0.9527
Epoch 83/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0441 - f1: 0.9563
Epoch 84/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0432 - f1: 0.9562
Epoch 85/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0408 - f1: 0.9595
Epoch 86/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0404 - f1: 0.9599
Epoch 87/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0408 - f1: 0.9596
Epoch 88/100
126/126 [==============================] - 2s 17ms/step - loss: 0.0418 - f1: 0.9585
Epoch 89/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0407 - f1: 0.9597
Epoch 90/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0389 - f1: 0.9605
Epoch 91/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0395 - f1: 0.9608
Epoch 92/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0393 - f1: 0.9533
Epoch 93/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0399 - f1: 0.9604
Epoch 94/100
126/126 [==============================] - 3s 20ms/step - loss: 0.0399 - f1: 0.9604
Epoch 95/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0392 - f1: 0.9602
Epoch 96/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0410 - f1: 0.9594
Epoch 97/100
126/126 [==============================] - 2s 18ms/step - loss: 0.0402 - f1: 0.9601
Epoch 98/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0447 - f1: 0.9556
Epoch 99/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0427 - f1: 0.9577
Epoch 100/100
126/126 [==============================] - 2s 20ms/step - loss: 0.0405 - f1: 0.9599
Compiled Transformer:  12:58
Now predicting on train set 
Accuracy: 0.9894472911329126
Precision: 0.962020008386749
Recall: 0.9572603719599427
F1 score: 0.959634


Now predicting on test set 
Accuracy: 0.9856377355739437
Precision: 0.9484507814642171
Recall: 0.9437926330150068
F1 score: 0.946116


Now predicting on finaltest set 
Accuracy: 0.9850550411897645
Precision: 0.9465992130410343
Recall: 0.9386845039018952
F1 score: 0.942625


saving transformer model xsrf.  12:58




Process finished with exit code 0
