C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  14:07
total length of the sample set: 182891
cutoff 128024
cutoff2 155457
Creating training dataset... (xsrf)
Creating validation dataset...
Creating finaltest dataset...
Train length: 128024
Test length: 27433
Finaltesting length: 27434
time:  14:09
Maxlen has been calculated to be 50
numpy array done.  14:09
128024 samples in the training set.
27433 samples in the validation set.
27434 samples in the final test set.
percentage of vulnerable samples: 13.17%
absolute amount of vulnerable samples in test set: 3623
Starting Transformer:  14:09
2022-03-15 14:09:38.493426: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 14:09:38.932187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
126/126 [==============================] - 4s 19ms/step - loss: 0.5045 - f1: 0.5177
Epoch 2/100
126/126 [==============================] - 2s 19ms/step - loss: 0.2186 - f1: 0.7825
Epoch 3/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1869 - f1: 0.8137
Epoch 4/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1717 - f1: 0.8274
Epoch 5/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1579 - f1: 0.8409
Epoch 6/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1498 - f1: 0.8508
Epoch 7/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1414 - f1: 0.8519
Epoch 8/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1538 - f1: 0.8441
Epoch 9/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1585 - f1: 0.8428
Epoch 10/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1491 - f1: 0.8504
Epoch 11/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1452 - f1: 0.8560
Epoch 12/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1355 - f1: 0.8645
Epoch 13/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1291 - f1: 0.8718
Epoch 14/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1402 - f1: 0.8594
Epoch 15/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1508 - f1: 0.8466
Epoch 16/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1364 - f1: 0.8647
Epoch 17/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1309 - f1: 0.8624
Epoch 18/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1266 - f1: 0.8739
Epoch 19/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1322 - f1: 0.8687
Epoch 20/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1313 - f1: 0.8646
Epoch 21/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1271 - f1: 0.8737
Epoch 22/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1250 - f1: 0.8760
Epoch 23/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1220 - f1: 0.8790
Epoch 24/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1251 - f1: 0.8760
Epoch 25/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1228 - f1: 0.8781
Epoch 26/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1207 - f1: 0.8725
Epoch 27/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1249 - f1: 0.8741
Epoch 28/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1265 - f1: 0.8744
Epoch 29/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1195 - f1: 0.8790
Epoch 30/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1201 - f1: 0.8793
Epoch 31/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1197 - f1: 0.8813
Epoch 32/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1221 - f1: 0.8774
Epoch 33/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1197 - f1: 0.8806
Epoch 34/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1157 - f1: 0.8834
Epoch 35/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1162 - f1: 0.8838
Epoch 36/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1126 - f1: 0.8883
Epoch 37/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1211 - f1: 0.8790
Epoch 38/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1178 - f1: 0.8831
Epoch 39/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1218 - f1: 0.8791
Epoch 40/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1120 - f1: 0.8862
Epoch 41/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1095 - f1: 0.8913
Epoch 42/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1084 - f1: 0.8925
Epoch 43/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1090 - f1: 0.8899
Epoch 44/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1102 - f1: 0.8907
Epoch 45/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1095 - f1: 0.8888
Epoch 46/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1137 - f1: 0.8860
Epoch 47/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1159 - f1: 0.8835
Epoch 48/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1073 - f1: 0.8934
Epoch 49/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1059 - f1: 0.8922
Epoch 50/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1076 - f1: 0.8907
Epoch 51/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1071 - f1: 0.8937
Epoch 52/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1057 - f1: 0.8952
Epoch 53/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1079 - f1: 0.8929
Epoch 54/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1089 - f1: 0.8910
Epoch 55/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1075 - f1: 0.8917
Epoch 56/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1066 - f1: 0.8941
Epoch 57/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1128 - f1: 0.8865
Epoch 58/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1107 - f1: 0.8886
Epoch 59/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1065 - f1: 0.8865
Epoch 60/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1040 - f1: 0.8968
Epoch 61/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1036 - f1: 0.8960
Epoch 62/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1054 - f1: 0.8955
Epoch 63/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1035 - f1: 0.8968
Epoch 64/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1034 - f1: 0.8975
Epoch 65/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1012 - f1: 0.8996
Epoch 66/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1027 - f1: 0.8949
Epoch 67/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1026 - f1: 0.8984
Epoch 68/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1042 - f1: 0.8950
Epoch 69/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1110 - f1: 0.8898
Epoch 70/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1039 - f1: 0.8943
Epoch 71/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1052 - f1: 0.8942
Epoch 72/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1060 - f1: 0.8872
Epoch 73/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1048 - f1: 0.8942
Epoch 74/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1035 - f1: 0.8973
Epoch 75/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1007 - f1: 0.8990
Epoch 76/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1025 - f1: 0.8969
Epoch 77/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1018 - f1: 0.8990
Epoch 78/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1052 - f1: 0.8949
Epoch 79/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1042 - f1: 0.8890
Epoch 80/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1037 - f1: 0.8971
Epoch 81/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1024 - f1: 0.8984
Epoch 82/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0992 - f1: 0.9017
Epoch 83/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1083 - f1: 0.8918
Epoch 84/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1038 - f1: 0.8962
Epoch 85/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1066 - f1: 0.8932
Epoch 86/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1020 - f1: 0.8911
Epoch 87/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1040 - f1: 0.8969
Epoch 88/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1088 - f1: 0.8921
Epoch 89/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1035 - f1: 0.8974
Epoch 90/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1047 - f1: 0.8954
Epoch 91/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1012 - f1: 0.8995
Epoch 92/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1072 - f1: 0.8936
Epoch 93/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1015 - f1: 0.8993
Epoch 94/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1013 - f1: 0.8994
Epoch 95/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1000 - f1: 0.8999
Epoch 96/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1009 - f1: 0.8999
Epoch 97/100
126/126 [==============================] - 2s 19ms/step - loss: 0.1014 - f1: 0.8993
Epoch 98/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0985 - f1: 0.8998
Epoch 99/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0954 - f1: 0.9054
Epoch 100/100
126/126 [==============================] - 2s 19ms/step - loss: 0.0983 - f1: 0.9008
Compiled Transformer:  14:13
Now predicting on train set 
Accuracy: 0.9754108604636631
Precision: 0.9219124976924497
Recall: 0.8885593974260126
F1 score: 0.904929


Now predicting on test set 
Accuracy: 0.9721503298946524
Precision: 0.9132697311361665
Recall: 0.8719293403256969
F1 score: 0.892121


Now predicting on finaltest set 
Accuracy: 0.9723700517605891
Precision: 0.9061498105508599
Recall: 0.8770098730606488
F1 score: 0.891342


saving transformer model xsrf.  14:13




Process finished with exit code 0
