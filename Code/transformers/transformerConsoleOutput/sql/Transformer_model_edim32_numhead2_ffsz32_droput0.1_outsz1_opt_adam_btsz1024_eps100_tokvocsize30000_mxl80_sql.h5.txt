C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  13:50
total length of the sample set: 284599
cutoff 199219
cutoff2 241909
Creating training dataset... (sql)
Creating validation dataset...
Creating finaltest dataset...
Train length: 199219
Test length: 42690
Finaltesting length: 42690
time:  13:55
Maxlen has been calculated to be 80
numpy array done.  13:55
199219 samples in the training set.
42690 samples in the validation set.
42690 samples in the final test set.
percentage of vulnerable samples: 18.91%
absolute amount of vulnerable samples in test set: 8256
Starting Transformer:  13:55
2022-03-15 13:55:26.922103: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 13:55:27.405653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
195/195 [==============================] - 8s 29ms/step - loss: 0.6828 - f1: 0.3174
Epoch 2/100
195/195 [==============================] - 6s 29ms/step - loss: 0.3649 - f1: 0.6417
Epoch 3/100
195/195 [==============================] - 5s 28ms/step - loss: 0.2206 - f1: 0.7799
Epoch 4/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1975 - f1: 0.8026
Epoch 5/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1854 - f1: 0.8148
Epoch 6/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1799 - f1: 0.8202
Epoch 7/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1686 - f1: 0.8313
Epoch 8/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1670 - f1: 0.8333
Epoch 9/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1583 - f1: 0.8419
Epoch 10/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1558 - f1: 0.8441
Epoch 11/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1565 - f1: 0.8435
Epoch 12/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1585 - f1: 0.8416
Epoch 13/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1544 - f1: 0.8456
Epoch 14/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1532 - f1: 0.8468
Epoch 15/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1491 - f1: 0.8510
Epoch 16/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1512 - f1: 0.8487
Epoch 17/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1489 - f1: 0.8511
Epoch 18/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1518 - f1: 0.8483
Epoch 19/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1474 - f1: 0.8527
Epoch 20/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1482 - f1: 0.8517
Epoch 21/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1464 - f1: 0.8537
Epoch 22/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1474 - f1: 0.8526
Epoch 23/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1512 - f1: 0.8489
Epoch 24/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1437 - f1: 0.8562
Epoch 25/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1403 - f1: 0.8598
Epoch 26/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1367 - f1: 0.8634
Epoch 27/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1371 - f1: 0.8629
Epoch 28/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1377 - f1: 0.8623
Epoch 29/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1419 - f1: 0.8580
Epoch 30/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1371 - f1: 0.8629
Epoch 31/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1329 - f1: 0.8671
Epoch 32/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1316 - f1: 0.8684
Epoch 33/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1323 - f1: 0.8677
Epoch 34/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1280 - f1: 0.8720
Epoch 35/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1285 - f1: 0.8716
Epoch 36/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1332 - f1: 0.8669
Epoch 37/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1341 - f1: 0.8659
Epoch 38/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1344 - f1: 0.8656
Epoch 39/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1308 - f1: 0.8692
Epoch 40/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1253 - f1: 0.8748
Epoch 41/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1260 - f1: 0.8740
Epoch 42/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1286 - f1: 0.8714
Epoch 43/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1319 - f1: 0.8681
Epoch 44/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1308 - f1: 0.8690
Epoch 45/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1303 - f1: 0.8698
Epoch 46/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1322 - f1: 0.8677
Epoch 47/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1320 - f1: 0.8680
Epoch 48/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1289 - f1: 0.8710
Epoch 49/100
195/195 [==============================] - 5s 28ms/step - loss: 0.1285 - f1: 0.8715
Epoch 50/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1264 - f1: 0.8735
Epoch 51/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1249 - f1: 0.8752
Epoch 52/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1234 - f1: 0.8767
Epoch 53/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1245 - f1: 0.8755
Epoch 54/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1239 - f1: 0.8761
Epoch 55/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1236 - f1: 0.8764
Epoch 56/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1259 - f1: 0.8739
Epoch 57/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1258 - f1: 0.8742
Epoch 58/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1230 - f1: 0.8769
Epoch 59/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1279 - f1: 0.8722
Epoch 60/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1218 - f1: 0.8783
Epoch 61/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1189 - f1: 0.8812
Epoch 62/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1217 - f1: 0.8783
Epoch 63/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1213 - f1: 0.8788
Epoch 64/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1212 - f1: 0.8788
Epoch 65/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1200 - f1: 0.8800
Epoch 66/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1207 - f1: 0.8793
Epoch 67/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1206 - f1: 0.8794
Epoch 68/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1210 - f1: 0.8790
Epoch 69/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1197 - f1: 0.8802
Epoch 70/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1183 - f1: 0.8817
Epoch 71/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1191 - f1: 0.8809
Epoch 72/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1214 - f1: 0.8785
Epoch 73/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1190 - f1: 0.8810
Epoch 74/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1184 - f1: 0.8816
Epoch 75/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1183 - f1: 0.8817
Epoch 76/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1191 - f1: 0.8809
Epoch 77/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1181 - f1: 0.8817
Epoch 78/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1189 - f1: 0.8812
Epoch 79/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1170 - f1: 0.8830
Epoch 80/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1186 - f1: 0.8813
Epoch 81/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1177 - f1: 0.8823
Epoch 82/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1238 - f1: 0.8762
Epoch 83/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1204 - f1: 0.8796
Epoch 84/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1216 - f1: 0.8784
Epoch 85/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1229 - f1: 0.8771
Epoch 86/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1217 - f1: 0.8783
Epoch 87/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1206 - f1: 0.8795
Epoch 88/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1217 - f1: 0.8783
Epoch 89/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1213 - f1: 0.8788
Epoch 90/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1170 - f1: 0.8830
Epoch 91/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1176 - f1: 0.8825
Epoch 92/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1182 - f1: 0.8818
Epoch 93/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1162 - f1: 0.8838
Epoch 94/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1199 - f1: 0.8801
Epoch 95/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1182 - f1: 0.8817
Epoch 96/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1178 - f1: 0.8822
Epoch 97/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1161 - f1: 0.8839
Epoch 98/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1189 - f1: 0.8810
Epoch 99/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1183 - f1: 0.8817
Epoch 100/100
195/195 [==============================] - 5s 27ms/step - loss: 0.1181 - f1: 0.8820
Compiled Transformer:  14:04
Now predicting on train set 
Accuracy: 0.9559580160526857
Precision: 0.8833324494882537
Recall: 0.8839418382509021
F1 score: 0.883637


Now predicting on test set 
Accuracy: 0.9483017100023424
Precision: 0.8700599535054447
Recall: 0.861312984496124
F1 score: 0.865664


Now predicting on finaltest set 
Accuracy: 0.9468962286249707
Precision: 0.8621238071935405
Recall: 0.8607548552583364
F1 score: 0.861439


saving transformer model sql.  14:04




Process finished with exit code 0
