C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  14:59
total length of the sample set: 284599
cutoff 199219
cutoff2 241909
Creating training dataset... (sql)
Creating validation dataset...
Creating finaltest dataset...
Train length: 199219
Test length: 42690
Finaltesting length: 42690
time:  15:03
Maxlen has been calculated to be 47
numpy array done.  15:03
199219 samples in the training set.
42690 samples in the validation set.
42690 samples in the final test set.
percentage of vulnerable samples: 18.96%
absolute amount of vulnerable samples in test set: 8213
Starting Transformer:  15:03
2022-03-15 15:03:57.368350: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 15:03:57.800650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/50
195/195 [==============================] - 6s 19ms/step - loss: 0.4715 - f1: 0.5380
Epoch 2/50
195/195 [==============================] - 4s 18ms/step - loss: 0.1366 - f1: 0.8645
Epoch 3/50
195/195 [==============================] - 4s 19ms/step - loss: 0.1131 - f1: 0.8871
Epoch 4/50
195/195 [==============================] - 4s 19ms/step - loss: 0.1019 - f1: 0.8979
Epoch 5/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0979 - f1: 0.9021
Epoch 6/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0967 - f1: 0.9034
Epoch 7/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0917 - f1: 0.9082
Epoch 8/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0876 - f1: 0.9125
Epoch 9/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0839 - f1: 0.9162
Epoch 10/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0825 - f1: 0.9175
Epoch 11/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0821 - f1: 0.9179
Epoch 12/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0808 - f1: 0.9192
Epoch 13/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0809 - f1: 0.9192
Epoch 14/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0801 - f1: 0.9200
Epoch 15/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0789 - f1: 0.9211
Epoch 16/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0764 - f1: 0.9237
Epoch 17/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0757 - f1: 0.9243
Epoch 18/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0762 - f1: 0.9238
Epoch 19/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0759 - f1: 0.9240
Epoch 20/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0764 - f1: 0.9235
Epoch 21/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0756 - f1: 0.9245
Epoch 22/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0751 - f1: 0.9249
Epoch 23/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0751 - f1: 0.9250
Epoch 24/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0740 - f1: 0.9260
Epoch 25/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0740 - f1: 0.9260
Epoch 26/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0738 - f1: 0.9261
Epoch 27/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0751 - f1: 0.9250
Epoch 28/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0756 - f1: 0.9243
Epoch 29/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0758 - f1: 0.9242
Epoch 30/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0749 - f1: 0.9252
Epoch 31/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0726 - f1: 0.9274
Epoch 32/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0716 - f1: 0.9283
Epoch 33/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0712 - f1: 0.9288
Epoch 34/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0710 - f1: 0.9289
Epoch 35/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0728 - f1: 0.9273
Epoch 36/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0716 - f1: 0.9284
Epoch 37/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0730 - f1: 0.9269
Epoch 38/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0714 - f1: 0.9285
Epoch 39/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0714 - f1: 0.9287
Epoch 40/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0716 - f1: 0.9284
Epoch 41/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0697 - f1: 0.9304
Epoch 42/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0705 - f1: 0.9295
Epoch 43/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0695 - f1: 0.9306
Epoch 44/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0690 - f1: 0.9310
Epoch 45/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0690 - f1: 0.9311
Epoch 46/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0702 - f1: 0.9298
Epoch 47/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0704 - f1: 0.9296
Epoch 48/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0695 - f1: 0.9306
Epoch 49/50
195/195 [==============================] - 4s 18ms/step - loss: 0.0696 - f1: 0.9304
Epoch 50/50
195/195 [==============================] - 4s 19ms/step - loss: 0.0681 - f1: 0.9318
Compiled Transformer:  15:07
Now predicting on train set 
Accuracy: 0.9744753261486103
Precision: 0.9401421724379342
Recall: 0.9242396166979908
F1 score: 0.932123


Now predicting on test set 
Accuracy: 0.9674396814242211
Precision: 0.9305818503092264
Recall: 0.8977231218799464
F1 score: 0.913857


Now predicting on finaltest set 
Accuracy: 0.9655422815647693
Precision: 0.9239766081871345
Recall: 0.8927650165827294
F1 score: 0.908103


saving transformer model sql.  15:07




Process finished with exit code 0