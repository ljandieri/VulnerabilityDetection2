C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  13:04
total length of the sample set: 96078
cutoff 67255
cutoff2 81666
Creating training dataset... (remote_code_execution)
Creating validation dataset...
Creating finaltest dataset...
Train length: 67255
Test length: 14411
Finaltesting length: 14412
time:  13:05
Maxlen has been calculated to be 42
numpy array done.  13:05
67255 samples in the training set.
14411 samples in the validation set.
14412 samples in the final test set.
percentage of vulnerable samples: 8.97%
absolute amount of vulnerable samples in test set: 1255
Starting Transformer:  13:05
2022-03-16 13:05:54.312149: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-16 13:05:54.751189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
66/66 [==============================] - 3s 20ms/step - loss: 0.5336 - f1: 0.5476
Epoch 2/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0561 - f1: 0.9487
Epoch 3/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0443 - f1: 0.9573
Epoch 4/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0366 - f1: 0.9643
Epoch 5/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0335 - f1: 0.9665
Epoch 6/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0285 - f1: 0.9724
Epoch 7/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0267 - f1: 0.9742
Epoch 8/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0308 - f1: 0.9694
Epoch 9/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0283 - f1: 0.9722
Epoch 10/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0300 - f1: 0.9703
Epoch 11/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0263 - f1: 0.9737
Epoch 12/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0256 - f1: 0.9747
Epoch 13/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0288 - f1: 0.9708
Epoch 14/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0285 - f1: 0.9717
Epoch 15/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0242 - f1: 0.9762
Epoch 16/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0269 - f1: 0.9733
Epoch 17/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0235 - f1: 0.9767
Epoch 18/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0208 - f1: 0.9793
Epoch 19/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0204 - f1: 0.9797
Epoch 20/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0198 - f1: 0.9802
Epoch 21/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0212 - f1: 0.9789
Epoch 22/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0220 - f1: 0.9780
Epoch 23/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0204 - f1: 0.9796
Epoch 24/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0211 - f1: 0.9789
Epoch 25/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0200 - f1: 0.9800
Epoch 26/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0229 - f1: 0.9772
Epoch 27/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0206 - f1: 0.9793
Epoch 28/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0190 - f1: 0.9811
Epoch 29/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0186 - f1: 0.9815
Epoch 30/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0185 - f1: 0.9816
Epoch 31/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0168 - f1: 0.9831
Epoch 32/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0161 - f1: 0.9839
Epoch 33/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0163 - f1: 0.9837
Epoch 34/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0190 - f1: 0.9811
Epoch 35/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0190 - f1: 0.9811
Epoch 36/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0182 - f1: 0.9817
Epoch 37/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0161 - f1: 0.9840
Epoch 38/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0150 - f1: 0.9851
Epoch 39/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0150 - f1: 0.9849
Epoch 40/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0151 - f1: 0.9849
Epoch 41/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0163 - f1: 0.9837
Epoch 42/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0152 - f1: 0.9848
Epoch 43/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0144 - f1: 0.9856
Epoch 44/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0150 - f1: 0.9850
Epoch 45/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0156 - f1: 0.9844
Epoch 46/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0168 - f1: 0.9833
Epoch 47/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0159 - f1: 0.9841
Epoch 48/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0158 - f1: 0.9843
Epoch 49/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0145 - f1: 0.9855
Epoch 50/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0154 - f1: 0.9847
Epoch 51/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0170 - f1: 0.9831
Epoch 52/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0187 - f1: 0.9812
Epoch 53/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0220 - f1: 0.9782
Epoch 54/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0181 - f1: 0.9819
Epoch 55/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0169 - f1: 0.9832
Epoch 56/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0175 - f1: 0.9826
Epoch 57/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0167 - f1: 0.9832
Epoch 58/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0173 - f1: 0.9827
Epoch 59/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0186 - f1: 0.9815
Epoch 60/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0165 - f1: 0.9836
Epoch 61/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0167 - f1: 0.9832
Epoch 62/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0166 - f1: 0.9833
Epoch 63/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0165 - f1: 0.9836
Epoch 64/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0177 - f1: 0.9822
Epoch 65/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0185 - f1: 0.9815
Epoch 66/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0182 - f1: 0.9820
Epoch 67/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0164 - f1: 0.9836
Epoch 68/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0155 - f1: 0.9845
Epoch 69/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0154 - f1: 0.9845
Epoch 70/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0151 - f1: 0.9850
Epoch 71/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0152 - f1: 0.9848
Epoch 72/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0147 - f1: 0.9853
Epoch 73/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0151 - f1: 0.9849
Epoch 74/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0154 - f1: 0.9847
Epoch 75/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0148 - f1: 0.9851
Epoch 76/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0144 - f1: 0.9856
Epoch 77/100
66/66 [==============================] - 1s 17ms/step - loss: 0.0145 - f1: 0.9855
Epoch 78/100
66/66 [==============================] - 1s 17ms/step - loss: 0.0145 - f1: 0.9856
Epoch 79/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0141 - f1: 0.9860
Epoch 80/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0142 - f1: 0.9858
Epoch 81/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0143 - f1: 0.9856
Epoch 82/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0142 - f1: 0.9857
Epoch 83/100
66/66 [==============================] - 1s 17ms/step - loss: 0.0146 - f1: 0.9854
Epoch 84/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0169 - f1: 0.9831
Epoch 85/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0171 - f1: 0.9830
Epoch 86/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0164 - f1: 0.9835
Epoch 87/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0158 - f1: 0.9842
Epoch 88/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0152 - f1: 0.9848
Epoch 89/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0207 - f1: 0.9794
Epoch 90/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0161 - f1: 0.9839
Epoch 91/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0150 - f1: 0.9851
Epoch 92/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0142 - f1: 0.9859
Epoch 93/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0134 - f1: 0.9866
Epoch 94/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0135 - f1: 0.9866
Epoch 95/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0133 - f1: 0.9867
Epoch 96/100
66/66 [==============================] - 1s 19ms/step - loss: 0.0135 - f1: 0.9865
Epoch 97/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0130 - f1: 0.9870
Epoch 98/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0131 - f1: 0.9870
Epoch 99/100
66/66 [==============================] - 1s 18ms/step - loss: 0.0132 - f1: 0.9868
Epoch 100/100
66/66 [==============================] - 1s 17ms/step - loss: 0.0133 - f1: 0.9867
Compiled Transformer:  13:08
Now predicting on train set 
Accuracy: 0.9976358635045721
Precision: 0.9843441001977588
Recall: 0.9893987079675336
F1 score: 0.986865


Now predicting on test set 
Accuracy: 0.9953507737145236
Precision: 0.9699367088607594
Recall: 0.9768924302788845
F1 score: 0.973402


Now predicting on finaltest set 
Accuracy: 0.9956980294199278
Precision: 0.9775367931835787
Recall: 0.9745173745173745
F1 score: 0.976025


saving transformer model remote_code_execution.  13:08




Process finished with exit code 0
