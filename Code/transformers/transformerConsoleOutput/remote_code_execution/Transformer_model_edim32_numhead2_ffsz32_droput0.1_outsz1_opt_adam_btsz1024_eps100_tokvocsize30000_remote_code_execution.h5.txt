C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  11:49
total length of the sample set: 96078
cutoff 67255
cutoff2 81666
Creating training dataset... (remote_code_execution)
Creating validation dataset...
Creating finaltest dataset...
Train length: 67255
Test length: 14411
Finaltesting length: 14412
time:  11:50
Maxlen has been calculated to be 56
numpy array done.  11:50
67255 samples in the training set.
14411 samples in the validation set.
14412 samples in the final test set.
percentage of vulnerable samples: 8.92%
absolute amount of vulnerable samples in test set: 1301
Starting Transformer:  11:50
2022-03-15 11:50:54.087126: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 11:50:54.533387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
66/66 [==============================] - 3s 21ms/step - loss: 0.5286 - f1: 0.5380
Epoch 2/100
66/66 [==============================] - 1s 21ms/step - loss: 0.1405 - f1: 0.8636
Epoch 3/100
66/66 [==============================] - 1s 21ms/step - loss: 0.1154 - f1: 0.8864
Epoch 4/100
66/66 [==============================] - 1s 21ms/step - loss: 0.1014 - f1: 0.9002
Epoch 5/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0943 - f1: 0.9071
Epoch 6/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0939 - f1: 0.9065
Epoch 7/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0915 - f1: 0.9091
Epoch 8/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0925 - f1: 0.9077
Epoch 9/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0856 - f1: 0.9141
Epoch 10/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0877 - f1: 0.9127
Epoch 11/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0814 - f1: 0.9188
Epoch 12/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0770 - f1: 0.9231
Epoch 13/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0801 - f1: 0.9202
Epoch 14/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0819 - f1: 0.9182
Epoch 15/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0847 - f1: 0.9156
Epoch 16/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0814 - f1: 0.9190
Epoch 17/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0743 - f1: 0.9261
Epoch 18/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0945 - f1: 0.9056
Epoch 19/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0771 - f1: 0.9233
Epoch 20/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0760 - f1: 0.9239
Epoch 21/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0721 - f1: 0.9279
Epoch 22/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0758 - f1: 0.9240
Epoch 23/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0733 - f1: 0.9269
Epoch 24/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0737 - f1: 0.9259
Epoch 25/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0749 - f1: 0.9244
Epoch 26/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0669 - f1: 0.9335
Epoch 27/100
66/66 [==============================] - 1s 22ms/step - loss: 0.0643 - f1: 0.9357
Epoch 28/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0696 - f1: 0.9302
Epoch 29/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0649 - f1: 0.9352
Epoch 30/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0685 - f1: 0.9316
Epoch 31/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0664 - f1: 0.9338
Epoch 32/100
66/66 [==============================] - 1s 22ms/step - loss: 0.0677 - f1: 0.9323
Epoch 33/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0644 - f1: 0.9359
Epoch 34/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0637 - f1: 0.9363
Epoch 35/100
66/66 [==============================] - 1s 22ms/step - loss: 0.0613 - f1: 0.9387
Epoch 36/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0634 - f1: 0.9368
Epoch 37/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0655 - f1: 0.9343
Epoch 38/100
66/66 [==============================] - 1s 22ms/step - loss: 0.0702 - f1: 0.9297
Epoch 39/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0665 - f1: 0.9335
Epoch 40/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0671 - f1: 0.9332
Epoch 41/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0677 - f1: 0.9322
Epoch 42/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0637 - f1: 0.9362
Epoch 43/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0633 - f1: 0.9366
Epoch 44/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0610 - f1: 0.9390
Epoch 45/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0649 - f1: 0.9350
Epoch 46/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0650 - f1: 0.9348
Epoch 47/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0671 - f1: 0.9328
Epoch 48/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0634 - f1: 0.9364
Epoch 49/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0629 - f1: 0.9373
Epoch 50/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0664 - f1: 0.9337
Epoch 51/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0654 - f1: 0.9346
Epoch 52/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0635 - f1: 0.9368
Epoch 53/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0655 - f1: 0.9347
Epoch 54/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0641 - f1: 0.9359
Epoch 55/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0604 - f1: 0.9393
Epoch 56/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0586 - f1: 0.9413
Epoch 57/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0605 - f1: 0.9395
Epoch 58/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0581 - f1: 0.9421
Epoch 59/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0611 - f1: 0.9383
Epoch 60/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0599 - f1: 0.9400
Epoch 61/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0602 - f1: 0.9396
Epoch 62/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0597 - f1: 0.9403
Epoch 63/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0582 - f1: 0.9418
Epoch 64/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0573 - f1: 0.9426
Epoch 65/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0614 - f1: 0.9389
Epoch 66/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0612 - f1: 0.9390
Epoch 67/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0597 - f1: 0.9402
Epoch 68/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0632 - f1: 0.9369
Epoch 69/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0642 - f1: 0.9358
Epoch 70/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0626 - f1: 0.9372
Epoch 71/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0625 - f1: 0.9374
Epoch 72/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0610 - f1: 0.9388
Epoch 73/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0648 - f1: 0.9350
Epoch 74/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0675 - f1: 0.9327
Epoch 75/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0652 - f1: 0.9346
Epoch 76/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0631 - f1: 0.9369
Epoch 77/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0675 - f1: 0.9325
Epoch 78/100
66/66 [==============================] - 1s 20ms/step - loss: 0.0725 - f1: 0.9272
Epoch 79/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0649 - f1: 0.9354
Epoch 80/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0640 - f1: 0.9357
Epoch 81/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0669 - f1: 0.9330
Epoch 82/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0622 - f1: 0.9379
Epoch 83/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0633 - f1: 0.9368
Epoch 84/100
66/66 [==============================] - 1s 22ms/step - loss: 0.0586 - f1: 0.9414
Epoch 85/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0609 - f1: 0.9392
Epoch 86/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0582 - f1: 0.9419
Epoch 87/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0594 - f1: 0.9407
Epoch 88/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0612 - f1: 0.9388
Epoch 89/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0612 - f1: 0.9386
Epoch 90/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0596 - f1: 0.9404
Epoch 91/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0637 - f1: 0.9363
Epoch 92/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0647 - f1: 0.9353
Epoch 93/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0601 - f1: 0.9398
Epoch 94/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0650 - f1: 0.9349
Epoch 95/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0572 - f1: 0.9429
Epoch 96/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0636 - f1: 0.9364
Epoch 97/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0642 - f1: 0.9357
Epoch 98/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0655 - f1: 0.9344
Epoch 99/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0604 - f1: 0.9398
Epoch 100/100
66/66 [==============================] - 1s 21ms/step - loss: 0.0562 - f1: 0.9439
Compiled Transformer:  11:53
Now predicting on train set 
Accuracy: 0.9901271280945655
Precision: 0.953757225433526
Recall: 0.9346884371876041
F1 score: 0.944127


Now predicting on test set 
Accuracy: 0.9868156269516342
Precision: 0.944755804643715
Recall: 0.9069946195234435
F1 score: 0.925490


Now predicting on finaltest set 
Accuracy: 0.988481820704968
Precision: 0.9500805152979066
Recall: 0.9190031152647975
F1 score: 0.934283


saving transformer model remote_code_execution.  11:53




Process finished with exit code 0
