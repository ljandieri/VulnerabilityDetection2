C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  12:59
total length of the sample set: 131203
cutoff 91842
cutoff2 111523
Creating training dataset... (path_disclosure)
Creating validation dataset...
Creating finaltest dataset...
Train length: 91842
Test length: 19681
Finaltesting length: 19680
time:  13:01
Maxlen has been calculated to be 42
numpy array done.  13:01
91842 samples in the training set.
19681 samples in the validation set.
19680 samples in the final test set.
percentage of vulnerable samples: 11.61%
absolute amount of vulnerable samples in test set: 2323
Starting Transformer:  13:01
2022-03-16 13:01:06.569777: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-16 13:01:06.978546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
90/90 [==============================] - 4s 19ms/step - loss: 0.5761 - f1: 0.4710
Epoch 2/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0718 - f1: 0.9304
Epoch 3/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0588 - f1: 0.9419
Epoch 4/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0541 - f1: 0.9468
Epoch 5/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0524 - f1: 0.9478
Epoch 6/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0458 - f1: 0.9544
Epoch 7/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0418 - f1: 0.9583
Epoch 8/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0404 - f1: 0.9596
Epoch 9/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0416 - f1: 0.9586
Epoch 10/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0420 - f1: 0.9581
Epoch 11/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0383 - f1: 0.9615
Epoch 12/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0384 - f1: 0.9617
Epoch 13/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0345 - f1: 0.9652
Epoch 14/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0338 - f1: 0.9662
Epoch 15/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0325 - f1: 0.9677
Epoch 16/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0305 - f1: 0.9696
Epoch 17/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0323 - f1: 0.9676
Epoch 18/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0310 - f1: 0.9690
Epoch 19/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0314 - f1: 0.9687
Epoch 20/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0314 - f1: 0.9687
Epoch 21/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0343 - f1: 0.9659
Epoch 22/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0318 - f1: 0.9683
Epoch 23/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0305 - f1: 0.9696
Epoch 24/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0287 - f1: 0.9713
Epoch 25/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0281 - f1: 0.9719
Epoch 26/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0282 - f1: 0.9718
Epoch 27/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0286 - f1: 0.9716
Epoch 28/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0279 - f1: 0.9721
Epoch 29/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0277 - f1: 0.9724
Epoch 30/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0276 - f1: 0.9724
Epoch 31/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0268 - f1: 0.9732
Epoch 32/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0271 - f1: 0.9729
Epoch 33/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0273 - f1: 0.9726
Epoch 34/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0282 - f1: 0.9719
Epoch 35/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0281 - f1: 0.9720
Epoch 36/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0267 - f1: 0.9733
Epoch 37/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0259 - f1: 0.9741
Epoch 38/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0265 - f1: 0.9734
Epoch 39/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0274 - f1: 0.9727
Epoch 40/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0260 - f1: 0.9740
Epoch 41/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0259 - f1: 0.9741
Epoch 42/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0254 - f1: 0.9747
Epoch 43/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0255 - f1: 0.9745
Epoch 44/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0252 - f1: 0.9748
Epoch 45/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0257 - f1: 0.9743
Epoch 46/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0258 - f1: 0.9742
Epoch 47/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0252 - f1: 0.9749
Epoch 48/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0269 - f1: 0.9731
Epoch 49/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0255 - f1: 0.9745
Epoch 50/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0252 - f1: 0.9747
Epoch 51/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0260 - f1: 0.9740
Epoch 52/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0253 - f1: 0.9747
Epoch 53/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0233 - f1: 0.9768
Epoch 54/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0242 - f1: 0.9759
Epoch 55/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0238 - f1: 0.9762
Epoch 56/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0236 - f1: 0.9764
Epoch 57/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0235 - f1: 0.9764
Epoch 58/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0234 - f1: 0.9767
Epoch 59/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0236 - f1: 0.9764
Epoch 60/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0226 - f1: 0.9774
Epoch 61/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0240 - f1: 0.9761
Epoch 62/100
90/90 [==============================] - 2s 21ms/step - loss: 0.0228 - f1: 0.9773
Epoch 63/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0225 - f1: 0.9775
Epoch 64/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0231 - f1: 0.9769
Epoch 65/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0227 - f1: 0.9774
Epoch 66/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0224 - f1: 0.9776
Epoch 67/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0222 - f1: 0.9778
Epoch 68/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0213 - f1: 0.9787
Epoch 69/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0212 - f1: 0.9788
Epoch 70/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0221 - f1: 0.9779
Epoch 71/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0220 - f1: 0.9779
Epoch 72/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0220 - f1: 0.9780
Epoch 73/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0218 - f1: 0.9783
Epoch 74/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0220 - f1: 0.9780
Epoch 75/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0215 - f1: 0.9785
Epoch 76/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0214 - f1: 0.9786
Epoch 77/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0215 - f1: 0.9785
Epoch 78/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0207 - f1: 0.9793
Epoch 79/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0221 - f1: 0.9779
Epoch 80/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0230 - f1: 0.9770
Epoch 81/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0224 - f1: 0.9777
Epoch 82/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0256 - f1: 0.9745
Epoch 83/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0243 - f1: 0.9756
Epoch 84/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0238 - f1: 0.9762
Epoch 85/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0240 - f1: 0.9760
Epoch 86/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0253 - f1: 0.9747
Epoch 87/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0215 - f1: 0.9786
Epoch 88/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0212 - f1: 0.9788
Epoch 89/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0218 - f1: 0.9783
Epoch 90/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0209 - f1: 0.9791
Epoch 91/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0207 - f1: 0.9794
Epoch 92/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0195 - f1: 0.9804
Epoch 93/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0187 - f1: 0.9813
Epoch 94/100
90/90 [==============================] - 2s 17ms/step - loss: 0.0186 - f1: 0.9815
Epoch 95/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0207 - f1: 0.9793
Epoch 96/100
90/90 [==============================] - 2s 20ms/step - loss: 0.0213 - f1: 0.9787
Epoch 97/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0219 - f1: 0.9781
Epoch 98/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0200 - f1: 0.9801
Epoch 99/100
90/90 [==============================] - 2s 18ms/step - loss: 0.0189 - f1: 0.9811
Epoch 100/100
90/90 [==============================] - 2s 19ms/step - loss: 0.0189 - f1: 0.9811
Compiled Transformer:  13:03
Now predicting on train set 
Accuracy: 0.9956991354717885
Precision: 0.9791899962672639
Recall: 0.9838724800750117
F1 score: 0.981526


Now predicting on test set 
Accuracy: 0.990193587724201
Precision: 0.9547395388556789
Recall: 0.9625484287559191
F1 score: 0.958628


Now predicting on finaltest set 
Accuracy: 0.9921239837398373
Precision: 0.9667104686815593
Recall: 0.9654418197725284
F1 score: 0.966076


saving transformer model path_disclosure.  13:04




Process finished with exit code 0
