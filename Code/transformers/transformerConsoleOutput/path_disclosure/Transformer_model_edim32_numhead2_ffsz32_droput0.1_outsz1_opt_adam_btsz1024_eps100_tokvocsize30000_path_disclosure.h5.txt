C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  12:04
total length of the sample set: 131203
cutoff 91842
cutoff2 111523
Creating training dataset... (path_disclosure)
Creating validation dataset...
Creating finaltest dataset...
Train length: 91842
Test length: 19681
Finaltesting length: 19680
time:  12:06
Maxlen has been calculated to be 64
numpy array done.  12:06
91842 samples in the training set.
19681 samples in the validation set.
19680 samples in the final test set.
percentage of vulnerable samples: 11.64%
absolute amount of vulnerable samples in test set: 2305
Starting Transformer:  12:06
2022-03-15 12:06:45.126412: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 12:06:45.566962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
90/90 [==============================] - 4s 23ms/step - loss: 0.5241 - f1: 0.5182
Epoch 2/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1608 - f1: 0.8424
Epoch 3/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1377 - f1: 0.8633
Epoch 4/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1383 - f1: 0.8625
Epoch 5/100
90/90 [==============================] - 2s 24ms/step - loss: 0.1287 - f1: 0.8715
Epoch 6/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1221 - f1: 0.8780
Epoch 7/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1221 - f1: 0.8778
Epoch 8/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1204 - f1: 0.8796
Epoch 9/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1229 - f1: 0.8771
Epoch 10/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1115 - f1: 0.8887
Epoch 11/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1092 - f1: 0.8914
Epoch 12/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1093 - f1: 0.8905
Epoch 13/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1069 - f1: 0.8934
Epoch 14/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1067 - f1: 0.8933
Epoch 15/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1191 - f1: 0.8810
Epoch 16/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1011 - f1: 0.8989
Epoch 17/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1059 - f1: 0.8942
Epoch 18/100
90/90 [==============================] - 2s 23ms/step - loss: 0.1094 - f1: 0.8910
Epoch 19/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1018 - f1: 0.8985
Epoch 20/100
90/90 [==============================] - 2s 22ms/step - loss: 0.1016 - f1: 0.8982
Epoch 21/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0993 - f1: 0.9011
Epoch 22/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0970 - f1: 0.9032
Epoch 23/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0963 - f1: 0.9036
Epoch 24/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0914 - f1: 0.9087
Epoch 25/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0902 - f1: 0.9098
Epoch 26/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0891 - f1: 0.9111
Epoch 27/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0876 - f1: 0.9126
Epoch 28/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0925 - f1: 0.9079
Epoch 29/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0861 - f1: 0.9139
Epoch 30/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0868 - f1: 0.9132
Epoch 31/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0886 - f1: 0.9114
Epoch 32/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0856 - f1: 0.9148
Epoch 33/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0979 - f1: 0.9023
Epoch 34/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0975 - f1: 0.9025
Epoch 35/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0857 - f1: 0.9146
Epoch 36/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0847 - f1: 0.9151
Epoch 37/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0851 - f1: 0.9151
Epoch 38/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0850 - f1: 0.9151
Epoch 39/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0817 - f1: 0.9184
Epoch 40/100
90/90 [==============================] - 2s 24ms/step - loss: 0.0795 - f1: 0.9204
Epoch 41/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0795 - f1: 0.9205
Epoch 42/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0781 - f1: 0.9220
Epoch 43/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0807 - f1: 0.9195
Epoch 44/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0781 - f1: 0.9221
Epoch 45/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0724 - f1: 0.9277
Epoch 46/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0734 - f1: 0.9265
Epoch 47/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0728 - f1: 0.9275
Epoch 48/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0710 - f1: 0.9293
Epoch 49/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0708 - f1: 0.9291
Epoch 50/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0741 - f1: 0.9261
Epoch 51/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0711 - f1: 0.9287
Epoch 52/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0719 - f1: 0.9281
Epoch 53/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0713 - f1: 0.9286
Epoch 54/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0793 - f1: 0.9208
Epoch 55/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0724 - f1: 0.9276
Epoch 56/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0763 - f1: 0.9236
Epoch 57/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0732 - f1: 0.9269
Epoch 58/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0718 - f1: 0.9285
Epoch 59/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0760 - f1: 0.9241
Epoch 60/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0695 - f1: 0.9306
Epoch 61/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0682 - f1: 0.9317
Epoch 62/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0678 - f1: 0.9322
Epoch 63/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0675 - f1: 0.9327
Epoch 64/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0668 - f1: 0.9332
Epoch 65/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0668 - f1: 0.9333
Epoch 66/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0677 - f1: 0.9323
Epoch 67/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0688 - f1: 0.9312
Epoch 68/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0730 - f1: 0.9270
Epoch 69/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0740 - f1: 0.9262
Epoch 70/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0701 - f1: 0.9301
Epoch 71/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0681 - f1: 0.9318
Epoch 72/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0666 - f1: 0.9333
Epoch 73/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0656 - f1: 0.9345
Epoch 74/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0658 - f1: 0.9342
Epoch 75/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0668 - f1: 0.9333
Epoch 76/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0648 - f1: 0.9351
Epoch 77/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0624 - f1: 0.9373
Epoch 78/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0636 - f1: 0.9365
Epoch 79/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0711 - f1: 0.9291
Epoch 80/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0681 - f1: 0.9320
Epoch 81/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0690 - f1: 0.9310
Epoch 82/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0686 - f1: 0.9316
Epoch 83/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0693 - f1: 0.9308
Epoch 84/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0677 - f1: 0.9323
Epoch 85/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0654 - f1: 0.9348
Epoch 86/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0642 - f1: 0.9357
Epoch 87/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0753 - f1: 0.9248
Epoch 88/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0686 - f1: 0.9314
Epoch 89/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0654 - f1: 0.9346
Epoch 90/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0643 - f1: 0.9358
Epoch 91/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0681 - f1: 0.9320
Epoch 92/100
90/90 [==============================] - 2s 23ms/step - loss: 0.0665 - f1: 0.9336
Epoch 93/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0638 - f1: 0.9362
Epoch 94/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0636 - f1: 0.9364
Epoch 95/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0655 - f1: 0.9345
Epoch 96/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0637 - f1: 0.9364
Epoch 97/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0626 - f1: 0.9374
Epoch 98/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0598 - f1: 0.9399
Epoch 99/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0615 - f1: 0.9384
Epoch 100/100
90/90 [==============================] - 2s 22ms/step - loss: 0.0608 - f1: 0.9392
Compiled Transformer:  12:10
Now predicting on train set 
Accuracy: 0.9858670325123582
Precision: 0.9448021208104526
Recall: 0.9331400785487189
F1 score: 0.938935


Now predicting on test set 
Accuracy: 0.9815558152532899
Precision: 0.9240174672489083
Recall: 0.9180043383947939
F1 score: 0.921001


Now predicting on finaltest set 
Accuracy: 0.9835873983739838
Precision: 0.9357142857142857
Recall: 0.9213186813186813
F1 score: 0.928461


saving transformer model path_disclosure.  12:10




Process finished with exit code 0
