C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  11:55
total length of the sample set: 84934
cutoff 59454
cutoff2 72194
Creating training dataset... (open_redirect)
Creating validation dataset...
Creating finaltest dataset...
Train length: 59454
Test length: 12740
Finaltesting length: 12740
time:  11:56
Maxlen has been calculated to be 50
numpy array done.  11:56
59454 samples in the training set.
12740 samples in the validation set.
12740 samples in the final test set.
percentage of vulnerable samples: 13.64%
absolute amount of vulnerable samples in test set: 1731
Starting Transformer:  11:56
2022-03-15 11:56:14.695287: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 11:56:15.131768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
59/59 [==============================] - 3s 20ms/step - loss: 0.7502 - f1: 0.2734
Epoch 2/100
59/59 [==============================] - 1s 20ms/step - loss: 0.2634 - f1: 0.7666
Epoch 3/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1740 - f1: 0.8267
Epoch 4/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1524 - f1: 0.8500
Epoch 5/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1353 - f1: 0.8666
Epoch 6/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1239 - f1: 0.8767
Epoch 7/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1277 - f1: 0.8709
Epoch 8/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1219 - f1: 0.8786
Epoch 9/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1217 - f1: 0.8803
Epoch 10/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1349 - f1: 0.8661
Epoch 11/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1283 - f1: 0.8729
Epoch 12/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1155 - f1: 0.8825
Epoch 13/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1211 - f1: 0.8801
Epoch 14/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1293 - f1: 0.8712
Epoch 15/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1322 - f1: 0.8692
Epoch 16/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1223 - f1: 0.8791
Epoch 17/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1202 - f1: 0.8805
Epoch 18/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1271 - f1: 0.8716
Epoch 19/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1202 - f1: 0.8788
Epoch 20/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1125 - f1: 0.8877
Epoch 21/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1114 - f1: 0.8865
Epoch 22/100
59/59 [==============================] - 1s 19ms/step - loss: 0.5459 - f1: 0.4644
Epoch 23/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1437 - f1: 0.8548
Epoch 24/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1196 - f1: 0.8791
Epoch 25/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1115 - f1: 0.8894
Epoch 26/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1095 - f1: 0.8896
Epoch 27/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0995 - f1: 0.9013
Epoch 28/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1031 - f1: 0.8978
Epoch 29/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1026 - f1: 0.8974
Epoch 30/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1011 - f1: 0.8962
Epoch 31/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1083 - f1: 0.8927
Epoch 32/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1060 - f1: 0.8934
Epoch 33/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1153 - f1: 0.8831
Epoch 34/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1097 - f1: 0.8911
Epoch 35/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1006 - f1: 0.8970
Epoch 36/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1020 - f1: 0.8997
Epoch 37/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1019 - f1: 0.8979
Epoch 38/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1000 - f1: 0.9002
Epoch 39/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0980 - f1: 0.9018
Epoch 40/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1046 - f1: 0.8959
Epoch 41/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1021 - f1: 0.8996
Epoch 42/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0992 - f1: 0.9024
Epoch 43/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0949 - f1: 0.9050
Epoch 44/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1049 - f1: 0.8969
Epoch 45/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1123 - f1: 0.8881
Epoch 46/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0979 - f1: 0.9028
Epoch 47/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0981 - f1: 0.9016
Epoch 48/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0981 - f1: 0.9004
Epoch 49/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0947 - f1: 0.9034
Epoch 50/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0966 - f1: 0.9050
Epoch 51/100
59/59 [==============================] - 1s 20ms/step - loss: 0.1007 - f1: 0.9000
Epoch 52/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0982 - f1: 0.9024
Epoch 53/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0974 - f1: 0.9036
Epoch 54/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0938 - f1: 0.9060
Epoch 55/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0925 - f1: 0.9070
Epoch 56/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0891 - f1: 0.9114
Epoch 57/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0990 - f1: 0.9006
Epoch 58/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0945 - f1: 0.9061
Epoch 59/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0940 - f1: 0.9042
Epoch 60/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0936 - f1: 0.9070
Epoch 61/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0916 - f1: 0.9044
Epoch 62/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0899 - f1: 0.9103
Epoch 63/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0916 - f1: 0.9100
Epoch 64/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0888 - f1: 0.9115
Epoch 65/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0883 - f1: 0.9078
Epoch 66/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0928 - f1: 0.9067
Epoch 67/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0872 - f1: 0.9120
Epoch 68/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0854 - f1: 0.9132
Epoch 69/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0850 - f1: 0.9147
Epoch 70/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0837 - f1: 0.9167
Epoch 71/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0822 - f1: 0.9163
Epoch 72/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0809 - f1: 0.9185
Epoch 73/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0797 - f1: 0.9204
Epoch 74/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0792 - f1: 0.9221
Epoch 75/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0798 - f1: 0.9203
Epoch 76/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0787 - f1: 0.9189
Epoch 77/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0820 - f1: 0.9186
Epoch 78/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0805 - f1: 0.9201
Epoch 79/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0800 - f1: 0.9205
Epoch 80/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0803 - f1: 0.9202
Epoch 81/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0785 - f1: 0.9228
Epoch 82/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0783 - f1: 0.9209
Epoch 83/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0792 - f1: 0.9220
Epoch 84/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0780 - f1: 0.9195
Epoch 85/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0767 - f1: 0.9244
Epoch 86/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0764 - f1: 0.9240
Epoch 87/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0810 - f1: 0.9195
Epoch 88/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0875 - f1: 0.9094
Epoch 89/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0812 - f1: 0.9179
Epoch 90/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0790 - f1: 0.9224
Epoch 91/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0758 - f1: 0.9223
Epoch 92/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0772 - f1: 0.9187
Epoch 93/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0812 - f1: 0.9191
Epoch 94/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0860 - f1: 0.9144
Epoch 95/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0938 - f1: 0.9067
Epoch 96/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0962 - f1: 0.9044
Epoch 97/100
59/59 [==============================] - 1s 21ms/step - loss: 0.0835 - f1: 0.9174
Epoch 98/100
59/59 [==============================] - 1s 22ms/step - loss: 0.0787 - f1: 0.9219
Epoch 99/100
59/59 [==============================] - 1s 21ms/step - loss: 0.0795 - f1: 0.9207
Epoch 100/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0771 - f1: 0.9242
Compiled Transformer:  11:58
Now predicting on train set 
Accuracy: 0.9795135735190231
Precision: 0.9319634131061271
Recall: 0.9168001972143474
F1 score: 0.924320


Now predicting on test set 
Accuracy: 0.9733124018838305
Precision: 0.9074399531341535
Recall: 0.8948584633160023
F1 score: 0.901105


Now predicting on finaltest set 
Accuracy: 0.9711930926216641
Precision: 0.9088785046728972
Recall: 0.8805885681946802
F1 score: 0.894510


saving transformer model open_redirect.  11:58




Process finished with exit code 0
