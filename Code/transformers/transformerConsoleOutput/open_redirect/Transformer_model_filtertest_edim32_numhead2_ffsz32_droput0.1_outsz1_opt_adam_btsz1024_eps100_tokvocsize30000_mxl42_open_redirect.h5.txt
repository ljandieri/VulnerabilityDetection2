C:\Python39\python.exe D:/VulnerabilityDetection3/Code/transformer_makemodel4.py
finished loading.  12:45
total length of the sample set: 84934
cutoff 59454
cutoff2 72194
Creating training dataset... (open_redirect)
Creating validation dataset...
Creating finaltest dataset...
Train length: 59454
Test length: 12740
Finaltesting length: 12740
time:  12:46
Maxlen has been calculated to be 42
numpy array done.  12:46
59454 samples in the training set.
12740 samples in the validation set.
12740 samples in the final test set.
percentage of vulnerable samples: 13.68%
absolute amount of vulnerable samples in test set: 1731
Starting Transformer:  12:46
2022-03-16 12:46:56.883172: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-16 12:46:57.333909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Epoch 1/100
59/59 [==============================] - 3s 19ms/step - loss: 0.7507 - f1: 0.2677
Epoch 2/100
59/59 [==============================] - 1s 19ms/step - loss: 0.1837 - f1: 0.8590
Epoch 3/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0681 - f1: 0.9349
Epoch 4/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0651 - f1: 0.9372
Epoch 5/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0594 - f1: 0.9415
Epoch 6/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0577 - f1: 0.9437
Epoch 7/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0507 - f1: 0.9487
Epoch 8/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0495 - f1: 0.9520
Epoch 9/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0487 - f1: 0.9522
Epoch 10/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0461 - f1: 0.9547
Epoch 11/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0483 - f1: 0.9528
Epoch 12/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0499 - f1: 0.9501
Epoch 13/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0488 - f1: 0.9522
Epoch 14/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0466 - f1: 0.9543
Epoch 15/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0481 - f1: 0.9528
Epoch 16/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0477 - f1: 0.9511
Epoch 17/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0508 - f1: 0.9490
Epoch 18/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0487 - f1: 0.9514
Epoch 19/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0496 - f1: 0.9503
Epoch 20/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0509 - f1: 0.9478
Epoch 21/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0493 - f1: 0.9499
Epoch 22/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0468 - f1: 0.9534
Epoch 23/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0477 - f1: 0.9531
Epoch 24/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0471 - f1: 0.9535
Epoch 25/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0451 - f1: 0.9550
Epoch 26/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0441 - f1: 0.9546
Epoch 27/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0437 - f1: 0.9571
Epoch 28/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0426 - f1: 0.9582
Epoch 29/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0415 - f1: 0.9586
Epoch 30/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0423 - f1: 0.9583
Epoch 31/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0459 - f1: 0.9527
Epoch 32/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0425 - f1: 0.9580
Epoch 33/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0412 - f1: 0.9595
Epoch 34/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0419 - f1: 0.9588
Epoch 35/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0411 - f1: 0.9596
Epoch 36/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0414 - f1: 0.9593
Epoch 37/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0424 - f1: 0.9574
Epoch 38/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0434 - f1: 0.9571
Epoch 39/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0418 - f1: 0.9588
Epoch 40/100
59/59 [==============================] - 1s 20ms/step - loss: 0.0414 - f1: 0.9584
Epoch 41/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0414 - f1: 0.9583
Epoch 42/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0408 - f1: 0.9594
Epoch 43/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0408 - f1: 0.9598
Epoch 44/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0405 - f1: 0.9592
Epoch 45/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0398 - f1: 0.9590
Epoch 46/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0399 - f1: 0.9597
Epoch 47/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0407 - f1: 0.9600
Epoch 48/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0421 - f1: 0.9587
Epoch 49/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0391 - f1: 0.9601
Epoch 50/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0397 - f1: 0.9609
Epoch 51/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0389 - f1: 0.9617
Epoch 52/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0392 - f1: 0.9614
Epoch 53/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0394 - f1: 0.9602
Epoch 54/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0394 - f1: 0.9612
Epoch 55/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0384 - f1: 0.9622
Epoch 56/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0400 - f1: 0.9600
Epoch 57/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0384 - f1: 0.9605
Epoch 58/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0385 - f1: 0.9603
Epoch 59/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0403 - f1: 0.9595
Epoch 60/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0391 - f1: 0.9607
Epoch 61/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0377 - f1: 0.9630
Epoch 62/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0375 - f1: 0.9631
Epoch 63/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0391 - f1: 0.9603
Epoch 64/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0379 - f1: 0.9627
Epoch 65/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0386 - f1: 0.9620
Epoch 66/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0398 - f1: 0.9610
Epoch 67/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0376 - f1: 0.9615
Epoch 68/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0370 - f1: 0.9628
Epoch 69/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0388 - f1: 0.9601
Epoch 70/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0369 - f1: 0.9628
Epoch 71/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0357 - f1: 0.9640
Epoch 72/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0360 - f1: 0.9646
Epoch 73/100
59/59 [==============================] - 1s 19ms/step - loss: 0.0384 - f1: 0.9622
Epoch 74/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0360 - f1: 0.9645
Epoch 75/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0374 - f1: 0.9605
Epoch 76/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0373 - f1: 0.9634
Epoch 77/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0371 - f1: 0.9617
Epoch 78/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0361 - f1: 0.9646
Epoch 79/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0358 - f1: 0.9648
Epoch 80/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0359 - f1: 0.9646
Epoch 81/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0363 - f1: 0.9643
Epoch 82/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0362 - f1: 0.9628
Epoch 83/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0355 - f1: 0.9650
Epoch 84/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0360 - f1: 0.9646
Epoch 85/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0361 - f1: 0.9645
Epoch 86/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0357 - f1: 0.9649
Epoch 87/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0369 - f1: 0.9637
Epoch 88/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0369 - f1: 0.9637
Epoch 89/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0386 - f1: 0.9609
Epoch 90/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0384 - f1: 0.9609
Epoch 91/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0385 - f1: 0.9612
Epoch 92/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0381 - f1: 0.9625
Epoch 93/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0380 - f1: 0.9600
Epoch 94/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0385 - f1: 0.9621
Epoch 95/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0376 - f1: 0.9622
Epoch 96/100
59/59 [==============================] - 1s 18ms/step - loss: 0.0370 - f1: 0.9624
Epoch 97/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0371 - f1: 0.9635
Epoch 98/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0375 - f1: 0.9625
Epoch 99/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0371 - f1: 0.9612
Epoch 100/100
59/59 [==============================] - 1s 17ms/step - loss: 0.0369 - f1: 0.9637
Compiled Transformer:  12:48
Now predicting on train set 
Accuracy: 0.989706327580987
Precision: 0.9605875152998776
Recall: 0.9643647087736544
F1 score: 0.962472


Now predicting on test set 
Accuracy: 0.980690737833595
Precision: 0.9354838709677419
Recall: 0.9214326978625073
F1 score: 0.928405


Now predicting on finaltest set 
Accuracy: 0.9797488226059654
Precision: 0.9264367816091954
Recall: 0.9253731343283582
F1 score: 0.925905


saving transformer model open_redirect.  12:48




Process finished with exit code 0
