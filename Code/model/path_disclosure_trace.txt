C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  03:14
cutoff 14405
cutoff2 17492
Creating training dataset... (path_disclosure)
Creating validation dataset...
Creating finaltest dataset...
Train length: 14405
Test length: 3087
Finaltesting length: 3087
time:  03:14
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  03:14
14405 samples in the training set.
3087 samples in the validation set.
3087 samples in the final test set.
percentage of vulnerable samples: 16.3%
absolute amount of vulnerable samples in test set: 542
Starting LSTM:  03:14
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-04 03:15:07.792645: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-04 03:15:08.616570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  03:15
2021-12-04 03:15:21.864366: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 2304800000 exceeds 10% of free system memory.
Epoch 1/100
113/113 [==============================] - 111s 949ms/step - loss: 0.6363 - f1: 0.3666
Epoch 2/100
113/113 [==============================] - 107s 947ms/step - loss: 0.4345 - f1: 0.5703
Epoch 3/100
113/113 [==============================] - 104s 924ms/step - loss: 0.3015 - f1: 0.7090
Epoch 4/100
113/113 [==============================] - 105s 930ms/step - loss: 0.2791 - f1: 0.7281
Epoch 5/100
113/113 [==============================] - 105s 933ms/step - loss: 0.2209 - f1: 0.7839
Epoch 6/100
113/113 [==============================] - 105s 929ms/step - loss: 0.2045 - f1: 0.8005
Epoch 7/100
113/113 [==============================] - 106s 938ms/step - loss: 0.1739 - f1: 0.8309
Epoch 8/100
113/113 [==============================] - 104s 918ms/step - loss: 0.1575 - f1: 0.8474
Epoch 9/100
113/113 [==============================] - 105s 927ms/step - loss: 0.1305 - f1: 0.8735
Epoch 10/100
113/113 [==============================] - 106s 938ms/step - loss: 0.1291 - f1: 0.8741
Epoch 11/100
113/113 [==============================] - 106s 934ms/step - loss: 0.1228 - f1: 0.8806
Epoch 12/100
113/113 [==============================] - 106s 934ms/step - loss: 0.1097 - f1: 0.8940
Epoch 13/100
113/113 [==============================] - 104s 918ms/step - loss: 0.1771 - f1: 0.8289
Epoch 14/100
113/113 [==============================] - 104s 917ms/step - loss: 0.1399 - f1: 0.8690
Epoch 15/100
113/113 [==============================] - 104s 923ms/step - loss: 0.1179 - f1: 0.8888
Epoch 16/100
113/113 [==============================] - 104s 917ms/step - loss: 0.1114 - f1: 0.8945
Epoch 17/100
113/113 [==============================] - 105s 928ms/step - loss: 0.1026 - f1: 0.9004
Epoch 18/100
113/113 [==============================] - 105s 928ms/step - loss: 0.1028 - f1: 0.9013
Epoch 19/100
113/113 [==============================] - 105s 928ms/step - loss: 0.0875 - f1: 0.9169
Epoch 20/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0866 - f1: 0.9165
Epoch 21/100
113/113 [==============================] - 103s 909ms/step - loss: 0.0850 - f1: 0.9160
Epoch 22/100
113/113 [==============================] - 102s 905ms/step - loss: 0.0862 - f1: 0.9160
Epoch 23/100
113/113 [==============================] - 104s 921ms/step - loss: 0.0902 - f1: 0.9105
Epoch 24/100
113/113 [==============================] - 104s 916ms/step - loss: 0.0801 - f1: 0.9219
Epoch 25/100
113/113 [==============================] - 104s 916ms/step - loss: 0.0799 - f1: 0.9226
Epoch 26/100
113/113 [==============================] - 102s 903ms/step - loss: 0.0809 - f1: 0.9202
Epoch 27/100
113/113 [==============================] - 105s 924ms/step - loss: 0.0862 - f1: 0.9164
Epoch 28/100
113/113 [==============================] - 109s 966ms/step - loss: 0.0891 - f1: 0.9138
Epoch 29/100
113/113 [==============================] - 103s 912ms/step - loss: 0.0818 - f1: 0.9218
Epoch 30/100
113/113 [==============================] - 104s 916ms/step - loss: 0.0827 - f1: 0.9194
Epoch 31/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0759 - f1: 0.9264
Epoch 32/100
113/113 [==============================] - 104s 924ms/step - loss: 0.0747 - f1: 0.9259
Epoch 33/100
113/113 [==============================] - 104s 920ms/step - loss: 0.0729 - f1: 0.9290
Epoch 34/100
113/113 [==============================] - 104s 921ms/step - loss: 0.0761 - f1: 0.9246
Epoch 35/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0703 - f1: 0.9313
Epoch 36/100
113/113 [==============================] - 104s 917ms/step - loss: 0.0743 - f1: 0.9254
Epoch 37/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0773 - f1: 0.9238
Epoch 38/100
113/113 [==============================] - 102s 906ms/step - loss: 0.0711 - f1: 0.9302
Epoch 39/100
113/113 [==============================] - 104s 922ms/step - loss: 0.0720 - f1: 0.9287
Epoch 40/100
113/113 [==============================] - 105s 927ms/step - loss: 0.0714 - f1: 0.9302
Epoch 41/100
113/113 [==============================] - 103s 912ms/step - loss: 0.0692 - f1: 0.9315
Epoch 42/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0724 - f1: 0.9283
Epoch 43/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0834 - f1: 0.9180
Epoch 44/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0720 - f1: 0.9278
Epoch 45/100
113/113 [==============================] - 103s 909ms/step - loss: 0.0747 - f1: 0.9279
Epoch 46/100
113/113 [==============================] - 104s 919ms/step - loss: 0.0730 - f1: 0.9288
Epoch 47/100
113/113 [==============================] - 104s 916ms/step - loss: 0.0668 - f1: 0.9343
Epoch 48/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0635 - f1: 0.9388
Epoch 49/100
113/113 [==============================] - 104s 921ms/step - loss: 0.0629 - f1: 0.9382
Epoch 50/100
113/113 [==============================] - 105s 928ms/step - loss: 0.0662 - f1: 0.9343
Epoch 51/100
113/113 [==============================] - 102s 907ms/step - loss: 0.0599 - f1: 0.9405
Epoch 52/100
113/113 [==============================] - 105s 926ms/step - loss: 0.0580 - f1: 0.9425
Epoch 53/100
113/113 [==============================] - 104s 920ms/step - loss: 0.0585 - f1: 0.9430
Epoch 54/100
113/113 [==============================] - 104s 917ms/step - loss: 0.0611 - f1: 0.9399
Epoch 55/100
113/113 [==============================] - 104s 925ms/step - loss: 0.0601 - f1: 0.9420
Epoch 56/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0560 - f1: 0.9447
Epoch 57/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0524 - f1: 0.9491
Epoch 58/100
113/113 [==============================] - 104s 923ms/step - loss: 0.0540 - f1: 0.9463
Epoch 59/100
113/113 [==============================] - 104s 919ms/step - loss: 0.0551 - f1: 0.9470
Epoch 60/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0514 - f1: 0.9496
Epoch 61/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0498 - f1: 0.9503
Epoch 62/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0614 - f1: 0.9411
Epoch 63/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0473 - f1: 0.9549
Epoch 64/100
113/113 [==============================] - 104s 923ms/step - loss: 0.0489 - f1: 0.9517
Epoch 65/100
113/113 [==============================] - 103s 911ms/step - loss: 0.0542 - f1: 0.9459
Epoch 66/100
113/113 [==============================] - 102s 907ms/step - loss: 0.0444 - f1: 0.9565
Epoch 67/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0432 - f1: 0.9578
Epoch 68/100
113/113 [==============================] - 103s 916ms/step - loss: 0.0440 - f1: 0.9565
Epoch 69/100
113/113 [==============================] - 104s 917ms/step - loss: 0.0461 - f1: 0.9552
Epoch 70/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0445 - f1: 0.9565
Epoch 71/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0439 - f1: 0.9573
Epoch 72/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0434 - f1: 0.9576
Epoch 73/100
113/113 [==============================] - 104s 917ms/step - loss: 0.0492 - f1: 0.9518
Epoch 74/100
113/113 [==============================] - 103s 911ms/step - loss: 0.0475 - f1: 0.9534
Epoch 75/100
113/113 [==============================] - 104s 924ms/step - loss: 0.0467 - f1: 0.9543
Epoch 76/100
113/113 [==============================] - 104s 920ms/step - loss: 0.0455 - f1: 0.9553
Epoch 77/100
113/113 [==============================] - 103s 914ms/step - loss: 0.0443 - f1: 0.9561
Epoch 78/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0433 - f1: 0.9566
Epoch 79/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0440 - f1: 0.9565
Epoch 80/100
113/113 [==============================] - 104s 916ms/step - loss: 0.0407 - f1: 0.9613
Epoch 81/100
113/113 [==============================] - 106s 934ms/step - loss: 0.0432 - f1: 0.9576
Epoch 82/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0426 - f1: 0.9580
Epoch 83/100
113/113 [==============================] - 103s 911ms/step - loss: 0.0478 - f1: 0.9531
Epoch 84/100
113/113 [==============================] - 102s 904ms/step - loss: 0.0430 - f1: 0.9576
Epoch 85/100
113/113 [==============================] - 104s 920ms/step - loss: 0.0424 - f1: 0.9579
Epoch 86/100
113/113 [==============================] - 102s 906ms/step - loss: 0.0432 - f1: 0.9575
Epoch 87/100
113/113 [==============================] - 103s 909ms/step - loss: 0.0408 - f1: 0.9607
Epoch 88/100
113/113 [==============================] - 105s 926ms/step - loss: 0.0420 - f1: 0.9591
Epoch 89/100
113/113 [==============================] - 104s 919ms/step - loss: 0.0459 - f1: 0.9551
Epoch 90/100
113/113 [==============================] - 104s 923ms/step - loss: 0.0444 - f1: 0.9552
Epoch 91/100
113/113 [==============================] - 103s 909ms/step - loss: 0.0503 - f1: 0.9505
Epoch 92/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0404 - f1: 0.9610
Epoch 93/100
113/113 [==============================] - 104s 918ms/step - loss: 0.0420 - f1: 0.9589
Epoch 94/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0417 - f1: 0.9585
Epoch 95/100
113/113 [==============================] - 103s 908ms/step - loss: 0.0449 - f1: 0.9575
Epoch 96/100
113/113 [==============================] - 103s 916ms/step - loss: 0.0395 - f1: 0.9617
Epoch 97/100
113/113 [==============================] - 103s 910ms/step - loss: 0.0406 - f1: 0.9601
Epoch 98/100
113/113 [==============================] - 103s 913ms/step - loss: 0.0382 - f1: 0.9629
Epoch 99/100
113/113 [==============================] - 103s 916ms/step - loss: 0.0403 - f1: 0.9602
Epoch 100/100
113/113 [==============================] - 103s 906ms/step - loss: 0.0385 - f1: 0.9617
Now predicting on train set (0.2 dropout)
Accuracy: 0.9892398472752516
Precision: 0.9936993699369937
Recall: 0.9399744572158365
F1 score: 0.966091


Now predicting on test set (0.2 dropout)
Accuracy: 0.9786200194363459
Precision: 0.9779116465863453
Recall: 0.8985239852398524
F1 score: 0.936538


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9841269841269841
Precision: 0.972457627118644
Recall: 0.9272727272727272
F1 score: 0.949328


saving LSTM model path_disclosure.  06:10




Process finished with exit code 0
