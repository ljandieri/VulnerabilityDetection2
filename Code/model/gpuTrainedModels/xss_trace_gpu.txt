C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  22:48
cutoff 757
cutoff2 920
Creating training dataset... (xss)
Creating validation dataset...
Creating finaltest dataset...
Train length: 757
Test length: 163
Finaltesting length: 162
time:  22:48
numpy array done.  22:48
757 samples in the training set.
163 samples in the validation set.
162 samples in the final test set.
percentage of vulnerable samples: 19.41%
absolute amount of vulnerable samples in test set: 25
Starting LSTM:  22:48
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
2021-12-03 22:48:11.227184: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 22:48:11.655378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  22:48
Epoch 1/100
2021-12-03 22:48:14.198923: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
6/6 [==============================] - 3s 25ms/step - loss: 0.6928 - f1: 0.3086
Epoch 2/100
6/6 [==============================] - 0s 25ms/step - loss: 0.6631 - f1: 0.3335
Epoch 3/100
6/6 [==============================] - 0s 23ms/step - loss: 0.6590 - f1: 0.3345
Epoch 4/100
6/6 [==============================] - 0s 23ms/step - loss: 0.6467 - f1: 0.3381
Epoch 5/100
6/6 [==============================] - 0s 22ms/step - loss: 0.6095 - f1: 0.4350
Epoch 6/100
6/6 [==============================] - 0s 22ms/step - loss: 0.5149 - f1: 0.5648
Epoch 7/100
6/6 [==============================] - 0s 22ms/step - loss: 0.3538 - f1: 0.7299
Epoch 8/100
6/6 [==============================] - 0s 21ms/step - loss: 0.2490 - f1: 0.7588
Epoch 9/100
6/6 [==============================] - 0s 21ms/step - loss: 0.1755 - f1: 0.8608
Epoch 10/100
6/6 [==============================] - 0s 21ms/step - loss: 0.1305 - f1: 0.9035
Epoch 11/100
6/6 [==============================] - 0s 24ms/step - loss: 0.1032 - f1: 0.9132
Epoch 12/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0945 - f1: 0.9132
Epoch 13/100
6/6 [==============================] - 0s 21ms/step - loss: 0.1204 - f1: 0.8805
Epoch 14/100
6/6 [==============================] - 0s 22ms/step - loss: 0.1102 - f1: 0.8881
Epoch 15/100
6/6 [==============================] - 0s 21ms/step - loss: 0.1518 - f1: 0.8549
Epoch 16/100
6/6 [==============================] - 0s 22ms/step - loss: 0.1208 - f1: 0.8976
Epoch 17/100
6/6 [==============================] - 0s 22ms/step - loss: 0.1099 - f1: 0.9001
Epoch 18/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0870 - f1: 0.9281
Epoch 19/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0862 - f1: 0.9210
Epoch 20/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0858 - f1: 0.9256
Epoch 21/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0759 - f1: 0.9276
Epoch 22/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0837 - f1: 0.9282
Epoch 23/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0693 - f1: 0.9331
Epoch 24/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0711 - f1: 0.9377
Epoch 25/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0932 - f1: 0.9191
Epoch 26/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0848 - f1: 0.9191
Epoch 27/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0818 - f1: 0.9239
Epoch 28/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0727 - f1: 0.9269
Epoch 29/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0757 - f1: 0.9317
Epoch 30/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0734 - f1: 0.9299
Epoch 31/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0721 - f1: 0.9313
Epoch 32/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0711 - f1: 0.9355
Epoch 33/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0699 - f1: 0.9358
Epoch 34/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0719 - f1: 0.9304
Epoch 35/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0680 - f1: 0.9351
Epoch 36/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0715 - f1: 0.9363
Epoch 37/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0678 - f1: 0.9368
Epoch 38/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0707 - f1: 0.9279
Epoch 39/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0642 - f1: 0.9419
Epoch 40/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0696 - f1: 0.9366
Epoch 41/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0631 - f1: 0.9407
Epoch 42/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0687 - f1: 0.9285
Epoch 43/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0634 - f1: 0.9413
Epoch 44/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0625 - f1: 0.9416
Epoch 45/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0540 - f1: 0.9485
Epoch 46/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0718 - f1: 0.9341
Epoch 47/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0562 - f1: 0.9530
Epoch 48/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0645 - f1: 0.9361
Epoch 49/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0553 - f1: 0.9508
Epoch 50/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0610 - f1: 0.9444
Epoch 51/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0568 - f1: 0.9487
Epoch 52/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0598 - f1: 0.9463
Epoch 53/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0511 - f1: 0.9502
Epoch 54/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0665 - f1: 0.9365
Epoch 55/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0891 - f1: 0.9117
Epoch 56/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0734 - f1: 0.9333
Epoch 57/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0777 - f1: 0.9240
Epoch 58/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0693 - f1: 0.9331
Epoch 59/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0604 - f1: 0.9418
Epoch 60/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0582 - f1: 0.9455
Epoch 61/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0540 - f1: 0.9470
Epoch 62/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0526 - f1: 0.9487
Epoch 63/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0474 - f1: 0.9538
Epoch 64/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0597 - f1: 0.9443
Epoch 65/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0483 - f1: 0.9527
Epoch 66/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0557 - f1: 0.9445
Epoch 67/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0590 - f1: 0.9435
Epoch 68/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0623 - f1: 0.9412
Epoch 69/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0601 - f1: 0.9436
Epoch 70/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0572 - f1: 0.9432
Epoch 71/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0518 - f1: 0.9503
Epoch 72/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0661 - f1: 0.9420
Epoch 73/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0607 - f1: 0.9471
Epoch 74/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0579 - f1: 0.9468
Epoch 75/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0724 - f1: 0.9347
Epoch 76/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0669 - f1: 0.9337
Epoch 77/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0534 - f1: 0.9495
Epoch 78/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0616 - f1: 0.9371
Epoch 79/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0484 - f1: 0.9532
Epoch 80/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0553 - f1: 0.9477
Epoch 81/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0492 - f1: 0.9538
Epoch 82/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0433 - f1: 0.9590
Epoch 83/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0464 - f1: 0.9543
Epoch 84/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0478 - f1: 0.9522
Epoch 85/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0441 - f1: 0.9576
Epoch 86/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0447 - f1: 0.9555
Epoch 87/100
6/6 [==============================] - 0s 23ms/step - loss: 0.0435 - f1: 0.9576
Epoch 88/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0432 - f1: 0.9576
Epoch 89/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0445 - f1: 0.9561
Epoch 90/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0445 - f1: 0.9561
Epoch 91/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0442 - f1: 0.9572
Epoch 92/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0445 - f1: 0.9581
Epoch 93/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0447 - f1: 0.9556
Epoch 94/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0428 - f1: 0.9588
Epoch 95/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0437 - f1: 0.9581
Epoch 96/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0448 - f1: 0.9556
Epoch 97/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0454 - f1: 0.9553
Epoch 98/100
6/6 [==============================] - 0s 22ms/step - loss: 0.0475 - f1: 0.9524
Epoch 99/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0428 - f1: 0.9587
Epoch 100/100
6/6 [==============================] - 0s 21ms/step - loss: 0.0428 - f1: 0.9578
Now predicting on train set (0.2 dropout)
Accuracy: 0.9841479524438573
Precision: 1.0
Recall: 0.9183673469387755
F1 score: 0.957447


Now predicting on test set (0.2 dropout)
Accuracy: 0.9570552147239264
Precision: 1.0
Recall: 0.72
F1 score: 0.837209


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9444444444444444
Precision: 0.9545454545454546
Recall: 0.7241379310344828
F1 score: 0.823529


saving LSTM model xss.  22:48




Process finished with exit code 0
