C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  23:22
cutoff 12773
cutoff2 15510
Creating training dataset... (command_injection)
Creating validation dataset...
Creating finaltest dataset...
Train length: 12773
Test length: 2737
Finaltesting length: 2737
time:  23:22
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  23:22
12773 samples in the training set.
2737 samples in the validation set.
2737 samples in the final test set.
percentage of vulnerable samples: 11.81%
absolute amount of vulnerable samples in test set: 331
Starting LSTM:  23:22
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-03 23:22:54.326257: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 23:22:55.290600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  23:22
2021-12-03 23:23:04.613119: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 2043680000 exceeds 10% of free system memory.
Epoch 1/100
2021-12-03 23:23:09.918318: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
100/100 [==============================] - 7s 22ms/step - loss: 0.7351 - f1: 0.2717
Epoch 2/100
100/100 [==============================] - 2s 22ms/step - loss: 0.5934 - f1: 0.4064
Epoch 3/100
100/100 [==============================] - 2s 22ms/step - loss: 0.5113 - f1: 0.4882
Epoch 4/100
100/100 [==============================] - 2s 22ms/step - loss: 0.4602 - f1: 0.5403
Epoch 5/100
100/100 [==============================] - 2s 22ms/step - loss: 0.6343 - f1: 0.3653
Epoch 6/100
100/100 [==============================] - 2s 22ms/step - loss: 0.4684 - f1: 0.5359
Epoch 7/100
100/100 [==============================] - 2s 22ms/step - loss: 0.4294 - f1: 0.5750
Epoch 8/100
100/100 [==============================] - 2s 22ms/step - loss: 0.4184 - f1: 0.5805
Epoch 9/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3971 - f1: 0.6014
Epoch 10/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3835 - f1: 0.6173
Epoch 11/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3972 - f1: 0.6041
Epoch 12/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3822 - f1: 0.6170
Epoch 13/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3656 - f1: 0.6353
Epoch 14/100
100/100 [==============================] - 2s 22ms/step - loss: 0.4188 - f1: 0.5776
Epoch 15/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3973 - f1: 0.6023
Epoch 16/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3802 - f1: 0.6203
Epoch 17/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3487 - f1: 0.6509
Epoch 18/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3392 - f1: 0.6609
Epoch 19/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3245 - f1: 0.6773
Epoch 20/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3158 - f1: 0.6875
Epoch 21/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3059 - f1: 0.6937
Epoch 22/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2998 - f1: 0.7028
Epoch 23/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3022 - f1: 0.6993
Epoch 24/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3198 - f1: 0.6807
Epoch 25/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3005 - f1: 0.6978
Epoch 26/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2972 - f1: 0.7030
Epoch 27/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2918 - f1: 0.7112
Epoch 28/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2882 - f1: 0.7114
Epoch 29/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2977 - f1: 0.7020
Epoch 30/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2870 - f1: 0.7123
Epoch 31/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2857 - f1: 0.7136
Epoch 32/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2806 - f1: 0.7199
Epoch 33/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2695 - f1: 0.7331
Epoch 34/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2636 - f1: 0.7391
Epoch 35/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2589 - f1: 0.7416
Epoch 36/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2489 - f1: 0.7543
Epoch 37/100
100/100 [==============================] - 2s 22ms/step - loss: 0.3873 - f1: 0.6108
Epoch 38/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2515 - f1: 0.7494
Epoch 39/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2395 - f1: 0.7640
Epoch 40/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2431 - f1: 0.7594
Epoch 41/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2658 - f1: 0.7367
Epoch 42/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2608 - f1: 0.7398
Epoch 43/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2437 - f1: 0.7580
Epoch 44/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2357 - f1: 0.7680
Epoch 45/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2382 - f1: 0.7617
Epoch 46/100
100/100 [==============================] - 2s 23ms/step - loss: 0.2297 - f1: 0.7715
Epoch 47/100
100/100 [==============================] - 2s 23ms/step - loss: 0.2514 - f1: 0.7503
Epoch 48/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2627 - f1: 0.7385
Epoch 49/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2282 - f1: 0.7732
Epoch 50/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2241 - f1: 0.7782
Epoch 51/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2351 - f1: 0.7674
Epoch 52/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2234 - f1: 0.7789
Epoch 53/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2055 - f1: 0.7972
Epoch 54/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2057 - f1: 0.7944
Epoch 55/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2045 - f1: 0.7981
Epoch 56/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2023 - f1: 0.7994
Epoch 57/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2087 - f1: 0.7910
Epoch 58/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2026 - f1: 0.7987
Epoch 59/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2102 - f1: 0.7881
Epoch 60/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2165 - f1: 0.7847
Epoch 61/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2165 - f1: 0.7835
Epoch 62/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2110 - f1: 0.7886
Epoch 63/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1993 - f1: 0.8025
Epoch 64/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1992 - f1: 0.8006
Epoch 65/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1968 - f1: 0.8046
Epoch 66/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1973 - f1: 0.8021
Epoch 67/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1984 - f1: 0.8040
Epoch 68/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1989 - f1: 0.8045
Epoch 69/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1926 - f1: 0.8081
Epoch 70/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1938 - f1: 0.8073
Epoch 71/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1927 - f1: 0.8075
Epoch 72/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2185 - f1: 0.7805
Epoch 73/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2084 - f1: 0.7931
Epoch 74/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2216 - f1: 0.7822
Epoch 75/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2236 - f1: 0.7750
Epoch 76/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1954 - f1: 0.8046
Epoch 77/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1938 - f1: 0.8058
Epoch 78/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1861 - f1: 0.8144
Epoch 79/100
100/100 [==============================] - 2s 23ms/step - loss: 0.1869 - f1: 0.8129
Epoch 80/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1834 - f1: 0.8168
Epoch 81/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1797 - f1: 0.8206
Epoch 82/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1796 - f1: 0.8213
Epoch 83/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1821 - f1: 0.8162
Epoch 84/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1768 - f1: 0.8240
Epoch 85/100
100/100 [==============================] - 2s 23ms/step - loss: 0.1747 - f1: 0.8277
Epoch 86/100
100/100 [==============================] - 2s 24ms/step - loss: 0.1744 - f1: 0.8274
Epoch 87/100
100/100 [==============================] - 2s 23ms/step - loss: 0.1783 - f1: 0.8221
Epoch 88/100
100/100 [==============================] - 2s 24ms/step - loss: 0.1790 - f1: 0.8227
Epoch 89/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1901 - f1: 0.8124
Epoch 90/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2010 - f1: 0.8002
Epoch 91/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1909 - f1: 0.8086
Epoch 92/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1834 - f1: 0.8169
Epoch 93/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1848 - f1: 0.8125
Epoch 94/100
100/100 [==============================] - 2s 23ms/step - loss: 0.1816 - f1: 0.8173
Epoch 95/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1843 - f1: 0.8159
Epoch 96/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1814 - f1: 0.8205
Epoch 97/100
100/100 [==============================] - 2s 22ms/step - loss: 0.2142 - f1: 0.7837
Epoch 98/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1797 - f1: 0.8213
Epoch 99/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1762 - f1: 0.8247
Epoch 100/100
100/100 [==============================] - 2s 22ms/step - loss: 0.1765 - f1: 0.8242
Now predicting on train set (0.2 dropout)
Accuracy: 0.9657089172473186
Precision: 0.9429280397022333
Recall: 0.7554671968190855
F1 score: 0.838852


Now predicting on test set (0.2 dropout)
Accuracy: 0.9535988308366825
Precision: 0.9180327868852459
Recall: 0.676737160120846
F1 score: 0.779130


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9605407380343441
Precision: 0.9341085271317829
Recall: 0.7259036144578314
F1 score: 0.816949


saving LSTM model command_injection.  23:26



