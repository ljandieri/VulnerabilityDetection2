C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  22:31
cutoff 7090
cutoff2 8610
Creating training dataset... (xsfr)
Creating validation dataset...
Creating finaltest dataset...
Train length: 7090
Test length: 1520
Finaltesting length: 1519
time:  22:31
numpy array done.  22:31
7090 samples in the training set.
1520 samples in the validation set.
1519 samples in the final test set.
percentage of vulnerable samples: 8.16%
absolute amount of vulnerable samples in test set: 130
Starting LSTM:  22:31
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:242: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:248: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:250: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
2021-12-03 22:31:32.803028: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 22:31:33.433303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  22:31
2021-12-03 22:31:34.628521: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 1134400000 exceeds 10% of free system memory.
Epoch 1/100
2021-12-03 22:31:38.558349: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
56/56 [==============================] - 6s 22ms/step - loss: 0.6873 - f1: 0.3461
Epoch 2/100
56/56 [==============================] - 1s 22ms/step - loss: 0.3801 - f1: 0.6294
Epoch 3/100
56/56 [==============================] - 1s 22ms/step - loss: 0.2487 - f1: 0.7671
Epoch 4/100
56/56 [==============================] - 1s 22ms/step - loss: 0.2169 - f1: 0.7964
Epoch 5/100
56/56 [==============================] - 1s 22ms/step - loss: 0.2013 - f1: 0.8027
Epoch 6/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1525 - f1: 0.8546
Epoch 7/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1343 - f1: 0.8720
Epoch 8/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1460 - f1: 0.8627
Epoch 9/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1425 - f1: 0.8649
Epoch 10/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1212 - f1: 0.8889
Epoch 11/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1275 - f1: 0.8757
Epoch 12/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1270 - f1: 0.8766
Epoch 13/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1232 - f1: 0.8807
Epoch 14/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1126 - f1: 0.8888
Epoch 15/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1130 - f1: 0.8832
Epoch 16/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1106 - f1: 0.8894
Epoch 17/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0997 - f1: 0.9040
Epoch 18/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1229 - f1: 0.8725
Epoch 19/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1031 - f1: 0.9061
Epoch 20/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1024 - f1: 0.9013
Epoch 21/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1126 - f1: 0.8800
Epoch 22/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1622 - f1: 0.8404
Epoch 23/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0947 - f1: 0.9084
Epoch 24/100
56/56 [==============================] - 1s 23ms/step - loss: 0.0897 - f1: 0.9114
Epoch 25/100
56/56 [==============================] - 1s 22ms/step - loss: 0.1066 - f1: 0.8969
Epoch 26/100
56/56 [==============================] - 1s 23ms/step - loss: 0.1008 - f1: 0.9053
Epoch 27/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0872 - f1: 0.9172
Epoch 28/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0797 - f1: 0.9095
Epoch 29/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0731 - f1: 0.9263
Epoch 30/100
56/56 [==============================] - 1s 23ms/step - loss: 0.0709 - f1: 0.9307
Epoch 31/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0690 - f1: 0.9292
Epoch 32/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0733 - f1: 0.9257
Epoch 33/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0736 - f1: 0.9280
Epoch 34/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0753 - f1: 0.9273
Epoch 35/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0799 - f1: 0.9186
Epoch 36/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0834 - f1: 0.9149
Epoch 37/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0659 - f1: 0.9228
Epoch 38/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0588 - f1: 0.9433
Epoch 39/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0624 - f1: 0.9339
Epoch 40/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0744 - f1: 0.9236
Epoch 41/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0666 - f1: 0.9369
Epoch 42/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0583 - f1: 0.9445
Epoch 43/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0609 - f1: 0.9400
Epoch 44/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0617 - f1: 0.9394
Epoch 45/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0676 - f1: 0.9357
Epoch 46/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0662 - f1: 0.9358
Epoch 47/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0778 - f1: 0.9209
Epoch 48/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0728 - f1: 0.9291
Epoch 49/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0750 - f1: 0.9271
Epoch 50/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0674 - f1: 0.9349
Epoch 51/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0644 - f1: 0.9362
Epoch 52/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0589 - f1: 0.9418
Epoch 53/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0633 - f1: 0.9379
Epoch 54/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0554 - f1: 0.9454
Epoch 55/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0533 - f1: 0.9491
Epoch 56/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0552 - f1: 0.9451
Epoch 57/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0536 - f1: 0.9475
Epoch 58/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0555 - f1: 0.9448
Epoch 59/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0538 - f1: 0.9472
Epoch 60/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0540 - f1: 0.9467
Epoch 61/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0566 - f1: 0.9423
Epoch 62/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0550 - f1: 0.9447
Epoch 63/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0563 - f1: 0.9447
Epoch 64/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0561 - f1: 0.9411
Epoch 65/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0550 - f1: 0.9432
Epoch 66/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0550 - f1: 0.9438
Epoch 67/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0588 - f1: 0.9375
Epoch 68/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0526 - f1: 0.9495
Epoch 69/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0541 - f1: 0.9467
Epoch 70/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0551 - f1: 0.9438
Epoch 71/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0567 - f1: 0.9414
Epoch 72/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0541 - f1: 0.9461
Epoch 73/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0517 - f1: 0.9497
Epoch 74/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0565 - f1: 0.9428
Epoch 75/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0568 - f1: 0.9373
Epoch 76/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0678 - f1: 0.9288
Epoch 77/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0531 - f1: 0.9483
Epoch 78/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0525 - f1: 0.9482
Epoch 79/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0568 - f1: 0.9405
Epoch 80/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0546 - f1: 0.9448
Epoch 81/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0525 - f1: 0.9481
Epoch 82/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0796 - f1: 0.9203
Epoch 83/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0634 - f1: 0.9355
Epoch 84/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0525 - f1: 0.9510
Epoch 85/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0537 - f1: 0.9462
Epoch 86/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0579 - f1: 0.9438
Epoch 87/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0530 - f1: 0.9473
Epoch 88/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0571 - f1: 0.9366
Epoch 89/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0620 - f1: 0.9368
Epoch 90/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0573 - f1: 0.9412
Epoch 91/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0513 - f1: 0.9504
Epoch 92/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0564 - f1: 0.9425
Epoch 93/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0484 - f1: 0.9529
Epoch 94/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0433 - f1: 0.9585
Epoch 95/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0421 - f1: 0.9596
Epoch 96/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0471 - f1: 0.9506
Epoch 97/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0470 - f1: 0.9514
Epoch 98/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0536 - f1: 0.9484
Epoch 99/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0488 - f1: 0.9518
Epoch 100/100
56/56 [==============================] - 1s 22ms/step - loss: 0.0446 - f1: 0.9554
Now predicting on train set (0.2 dropout)
Accuracy: 0.9923836389280677
Precision: 0.9943502824858758
Recall: 0.9119170984455959
F1 score: 0.951351


Now predicting on test set (0.2 dropout)
Accuracy: 0.9901315789473685
Precision: 0.9752066115702479
Recall: 0.9076923076923077
F1 score: 0.940239


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.989466754443713
Precision: 1.0
Recall: 0.8545454545454545
F1 score: 0.921569


saving LSTM model xsfr.  22:33




Process finished with exit code 0
