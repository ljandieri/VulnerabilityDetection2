C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  00:26
cutoff 12773
cutoff2 15510
Creating training dataset... (command_injection)
Creating validation dataset...
Creating finaltest dataset...
Train length: 12773
Test length: 2737
Finaltesting length: 2737
time:  00:26
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  00:26
12773 samples in the training set.
2737 samples in the validation set.
2737 samples in the final test set.
percentage of vulnerable samples: 11.9%
absolute amount of vulnerable samples in test set: 317
Starting LSTM:  00:26
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-04 00:27:04.733525: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-04 00:27:05.964028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  00:27
2021-12-04 00:27:16.685828: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 2043680000 exceeds 10% of free system memory.
Epoch 1/100
100/100 [==============================] - 95s 919ms/step - loss: 0.7684 - f1: 0.2297
Epoch 2/100
100/100 [==============================] - 92s 925ms/step - loss: 0.5484 - f1: 0.4672
Epoch 3/100
100/100 [==============================] - 93s 933ms/step - loss: 0.4193 - f1: 0.5928
Epoch 4/100
100/100 [==============================] - 94s 937ms/step - loss: 0.3658 - f1: 0.6371
Epoch 5/100
100/100 [==============================] - 92s 917ms/step - loss: 0.3211 - f1: 0.6837
Epoch 6/100
100/100 [==============================] - 93s 934ms/step - loss: 0.3163 - f1: 0.6898
Epoch 7/100
100/100 [==============================] - 93s 934ms/step - loss: 0.3008 - f1: 0.7100
Epoch 8/100
100/100 [==============================] - 91s 909ms/step - loss: 0.3021 - f1: 0.7021
Epoch 9/100
100/100 [==============================] - 92s 923ms/step - loss: 0.2793 - f1: 0.7232
Epoch 10/100
100/100 [==============================] - 91s 905ms/step - loss: 0.2470 - f1: 0.7540
Epoch 11/100
100/100 [==============================] - 91s 915ms/step - loss: 0.2400 - f1: 0.7605
Epoch 12/100
100/100 [==============================] - 91s 908ms/step - loss: 0.2280 - f1: 0.7746
Epoch 13/100
100/100 [==============================] - 94s 936ms/step - loss: 0.2122 - f1: 0.7902
Epoch 14/100
100/100 [==============================] - 96s 958ms/step - loss: 0.1990 - f1: 0.8046
Epoch 15/100
100/100 [==============================] - 97s 971ms/step - loss: 0.1952 - f1: 0.8082
Epoch 16/100
100/100 [==============================] - 95s 950ms/step - loss: 0.1985 - f1: 0.8011
Epoch 17/100
100/100 [==============================] - 98s 979ms/step - loss: 0.1949 - f1: 0.8055
Epoch 18/100
100/100 [==============================] - 98s 979ms/step - loss: 0.2056 - f1: 0.7965
Epoch 19/100
100/100 [==============================] - 94s 942ms/step - loss: 0.1915 - f1: 0.8077
Epoch 20/100
100/100 [==============================] - 93s 932ms/step - loss: 0.1887 - f1: 0.8143
Epoch 21/100
100/100 [==============================] - 94s 941ms/step - loss: 0.1789 - f1: 0.8238
Epoch 22/100
100/100 [==============================] - 97s 971ms/step - loss: 0.1844 - f1: 0.8145
Epoch 23/100
100/100 [==============================] - 101s 1s/step - loss: 0.2040 - f1: 0.7996
Epoch 24/100
100/100 [==============================] - 98s 980ms/step - loss: 0.1998 - f1: 0.8048
Epoch 25/100
100/100 [==============================] - 93s 933ms/step - loss: 0.1800 - f1: 0.8232
Epoch 26/100
100/100 [==============================] - 93s 932ms/step - loss: 0.1715 - f1: 0.8301
Epoch 27/100
100/100 [==============================] - 92s 924ms/step - loss: 0.1715 - f1: 0.8271
Epoch 28/100
100/100 [==============================] - 94s 937ms/step - loss: 0.1730 - f1: 0.8278
Epoch 29/100
100/100 [==============================] - 93s 928ms/step - loss: 0.1697 - f1: 0.8300
Epoch 30/100
100/100 [==============================] - 93s 934ms/step - loss: 0.1578 - f1: 0.8435
Epoch 31/100
100/100 [==============================] - 93s 931ms/step - loss: 0.1506 - f1: 0.8498
Epoch 32/100
100/100 [==============================] - 94s 938ms/step - loss: 0.1502 - f1: 0.8494
Epoch 33/100
100/100 [==============================] - 96s 962ms/step - loss: 0.1562 - f1: 0.8454
Epoch 34/100
100/100 [==============================] - 101s 1s/step - loss: 0.1550 - f1: 0.8459
Epoch 35/100
100/100 [==============================] - 97s 974ms/step - loss: 0.1543 - f1: 0.8469
Epoch 36/100
100/100 [==============================] - 96s 963ms/step - loss: 0.1476 - f1: 0.8532
Epoch 37/100
100/100 [==============================] - 95s 944ms/step - loss: 0.1416 - f1: 0.8591
Epoch 38/100
100/100 [==============================] - 94s 939ms/step - loss: 0.1427 - f1: 0.8589
Epoch 39/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1381 - f1: 0.8630
Epoch 40/100
100/100 [==============================] - 94s 940ms/step - loss: 0.1420 - f1: 0.8584
Epoch 41/100
100/100 [==============================] - 92s 923ms/step - loss: 0.1522 - f1: 0.8472
Epoch 42/100
100/100 [==============================] - 98s 977ms/step - loss: 0.1431 - f1: 0.8580
Epoch 43/100
100/100 [==============================] - 95s 947ms/step - loss: 0.1457 - f1: 0.8532
Epoch 44/100
100/100 [==============================] - 94s 942ms/step - loss: 0.1411 - f1: 0.8613
Epoch 45/100
100/100 [==============================] - 93s 934ms/step - loss: 0.1385 - f1: 0.8619
Epoch 46/100
100/100 [==============================] - 94s 943ms/step - loss: 0.1394 - f1: 0.8635
Epoch 47/100
100/100 [==============================] - 97s 969ms/step - loss: 0.1392 - f1: 0.8626
Epoch 48/100
100/100 [==============================] - 97s 971ms/step - loss: 0.1333 - f1: 0.8670
Epoch 49/100
100/100 [==============================] - 93s 933ms/step - loss: 0.1381 - f1: 0.8628
Epoch 50/100
100/100 [==============================] - 96s 963ms/step - loss: 0.1337 - f1: 0.8676
Epoch 51/100
100/100 [==============================] - 95s 945ms/step - loss: 0.1354 - f1: 0.8650
Epoch 52/100
100/100 [==============================] - 98s 983ms/step - loss: 0.1478 - f1: 0.8538
Epoch 53/100
100/100 [==============================] - 97s 966ms/step - loss: 0.1401 - f1: 0.8601
Epoch 54/100
100/100 [==============================] - 92s 925ms/step - loss: 0.1414 - f1: 0.8614
Epoch 55/100
100/100 [==============================] - 92s 922ms/step - loss: 0.1342 - f1: 0.8678
Epoch 56/100
100/100 [==============================] - 93s 930ms/step - loss: 0.1283 - f1: 0.8739
Epoch 57/100
100/100 [==============================] - 94s 936ms/step - loss: 0.1283 - f1: 0.8734
Epoch 58/100
100/100 [==============================] - 93s 931ms/step - loss: 0.1201 - f1: 0.8827
Epoch 59/100
100/100 [==============================] - 92s 919ms/step - loss: 0.1388 - f1: 0.8622
Epoch 60/100
100/100 [==============================] - 93s 927ms/step - loss: 0.1376 - f1: 0.8624
Epoch 61/100
100/100 [==============================] - 94s 933ms/step - loss: 0.1265 - f1: 0.8753
Epoch 62/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1243 - f1: 0.8765
Epoch 63/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1213 - f1: 0.8795
Epoch 64/100
100/100 [==============================] - 91s 914ms/step - loss: 0.1345 - f1: 0.8659
Epoch 65/100
100/100 [==============================] - 93s 932ms/step - loss: 0.1242 - f1: 0.8764
Epoch 66/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1224 - f1: 0.8768
Epoch 67/100
100/100 [==============================] - 92s 925ms/step - loss: 0.1293 - f1: 0.8709
Epoch 68/100
100/100 [==============================] - 92s 919ms/step - loss: 0.1281 - f1: 0.8709
Epoch 69/100
100/100 [==============================] - 93s 928ms/step - loss: 0.1350 - f1: 0.8647
Epoch 70/100
100/100 [==============================] - 93s 930ms/step - loss: 0.1358 - f1: 0.8642
Epoch 71/100
100/100 [==============================] - 94s 942ms/step - loss: 0.1263 - f1: 0.8740
Epoch 72/100
100/100 [==============================] - 93s 935ms/step - loss: 0.1316 - f1: 0.8681
Epoch 73/100
100/100 [==============================] - 95s 951ms/step - loss: 0.1236 - f1: 0.8783
Epoch 74/100
100/100 [==============================] - 94s 942ms/step - loss: 0.1193 - f1: 0.8826
Epoch 75/100
100/100 [==============================] - 93s 930ms/step - loss: 0.1192 - f1: 0.8816
Epoch 76/100
100/100 [==============================] - 94s 941ms/step - loss: 0.1156 - f1: 0.8858
Epoch 77/100
100/100 [==============================] - 93s 931ms/step - loss: 0.1193 - f1: 0.8817
Epoch 78/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1167 - f1: 0.8833
Epoch 79/100
100/100 [==============================] - 94s 933ms/step - loss: 0.1279 - f1: 0.8725
Epoch 80/100
100/100 [==============================] - 94s 938ms/step - loss: 0.1211 - f1: 0.8796
Epoch 81/100
100/100 [==============================] - 94s 938ms/step - loss: 0.1242 - f1: 0.8752
Epoch 82/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1268 - f1: 0.8751
Epoch 83/100
100/100 [==============================] - 94s 943ms/step - loss: 0.1219 - f1: 0.8774
Epoch 84/100
100/100 [==============================] - 94s 938ms/step - loss: 0.1236 - f1: 0.8753
Epoch 85/100
100/100 [==============================] - 95s 948ms/step - loss: 0.1193 - f1: 0.8824
Epoch 86/100
100/100 [==============================] - 93s 926ms/step - loss: 0.1207 - f1: 0.8787
Epoch 87/100
100/100 [==============================] - 93s 933ms/step - loss: 0.1240 - f1: 0.8758
Epoch 88/100
100/100 [==============================] - 94s 936ms/step - loss: 0.1102 - f1: 0.8913
Epoch 89/100
100/100 [==============================] - 93s 927ms/step - loss: 0.1077 - f1: 0.8932
Epoch 90/100
100/100 [==============================] - 92s 923ms/step - loss: 0.1060 - f1: 0.8956
Epoch 91/100
100/100 [==============================] - 92s 920ms/step - loss: 0.1059 - f1: 0.8954
Epoch 92/100
100/100 [==============================] - 92s 922ms/step - loss: 0.1124 - f1: 0.8860
Epoch 93/100
100/100 [==============================] - 93s 929ms/step - loss: 0.1081 - f1: 0.8918
Epoch 94/100
100/100 [==============================] - 92s 915ms/step - loss: 0.1049 - f1: 0.8954
Epoch 95/100
100/100 [==============================] - 92s 916ms/step - loss: 0.1071 - f1: 0.8920
Epoch 96/100
100/100 [==============================] - 92s 920ms/step - loss: 0.1014 - f1: 0.8986
Epoch 97/100
100/100 [==============================] - 92s 922ms/step - loss: 0.1088 - f1: 0.8910
Epoch 98/100
100/100 [==============================] - 92s 920ms/step - loss: 0.1168 - f1: 0.8829
Epoch 99/100
100/100 [==============================] - 92s 919ms/step - loss: 0.1068 - f1: 0.8936
Epoch 100/100
100/100 [==============================] - 93s 925ms/step - loss: 0.1059 - f1: 0.8950
Now predicting on train set (0.2 dropout)
Accuracy: 0.9784702106004854
Precision: 0.9691265060240963
Recall: 0.8461538461538461
F1 score: 0.903475


Now predicting on test set (0.2 dropout)
Accuracy: 0.9820971867007673
Precision: 0.958904109589041
Recall: 0.8832807570977917
F1 score: 0.919540


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9740591888929485
Precision: 0.9427609427609428
Recall: 0.8383233532934131
F1 score: 0.887480


saving LSTM model command_injection.  03:05




Process finished with exit code 0
