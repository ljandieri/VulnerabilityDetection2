C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  12:04
cutoff 5175
cutoff2 6284
Creating training dataset... (open_redirect)
Creating validation dataset...
Creating finaltest dataset...
Train length: 5175
Test length: 1109
Finaltesting length: 1109
time:  12:05
numpy array done.  12:05
5175 samples in the training set.
1109 samples in the validation set.
1109 samples in the final test set.
percentage of vulnerable samples: 16.75%
absolute amount of vulnerable samples in test set: 203
Starting LSTM:  12:05
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:244: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:250: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:252: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
2021-12-04 12:05:07.423313: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-04 12:05:07.842368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  12:05
2021-12-04 12:05:08.946022: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 828000000 exceeds 10% of free system memory.
Epoch 1/100
41/41 [==============================] - 45s 1s/step - loss: 0.6844 - f1: 0.3203
Epoch 2/100
41/41 [==============================] - 41s 1s/step - loss: 0.4513 - f1: 0.5638
Epoch 3/100
41/41 [==============================] - 39s 949ms/step - loss: 0.4444 - f1: 0.5620
Epoch 4/100
41/41 [==============================] - 42s 1s/step - loss: 0.3592 - f1: 0.6528
Epoch 5/100
41/41 [==============================] - 43s 1s/step - loss: 0.2797 - f1: 0.7348
Epoch 6/100
41/41 [==============================] - 42s 1s/step - loss: 0.2440 - f1: 0.7684
Epoch 7/100
41/41 [==============================] - 43s 1s/step - loss: 0.2171 - f1: 0.7856
Epoch 8/100
41/41 [==============================] - 40s 984ms/step - loss: 0.2172 - f1: 0.7877
Epoch 9/100
41/41 [==============================] - 40s 982ms/step - loss: 0.1889 - f1: 0.8178
Epoch 10/100
41/41 [==============================] - 41s 997ms/step - loss: 0.1669 - f1: 0.8340
Epoch 11/100
41/41 [==============================] - 41s 994ms/step - loss: 0.1583 - f1: 0.8486
Epoch 12/100
41/41 [==============================] - 43s 1s/step - loss: 0.1694 - f1: 0.8377
Epoch 13/100
41/41 [==============================] - 42s 1s/step - loss: 0.1358 - f1: 0.8697
Epoch 14/100
41/41 [==============================] - 43s 1s/step - loss: 0.1232 - f1: 0.8809
Epoch 15/100
41/41 [==============================] - 43s 1s/step - loss: 0.1277 - f1: 0.8779
Epoch 16/100
41/41 [==============================] - 45s 1s/step - loss: 0.1027 - f1: 0.9037
Epoch 17/100
41/41 [==============================] - 45s 1s/step - loss: 0.0933 - f1: 0.9117
Epoch 18/100
41/41 [==============================] - 42s 1s/step - loss: 0.1017 - f1: 0.9023
Epoch 19/100
41/41 [==============================] - 42s 1s/step - loss: 0.1005 - f1: 0.9031
Epoch 20/100
41/41 [==============================] - 44s 1s/step - loss: 0.0839 - f1: 0.9206
Epoch 21/100
41/41 [==============================] - 43s 1s/step - loss: 0.1272 - f1: 0.8763
Epoch 22/100
41/41 [==============================] - 43s 1s/step - loss: 0.0731 - f1: 0.9297
Epoch 23/100
41/41 [==============================] - 43s 1s/step - loss: 0.0792 - f1: 0.9232
Epoch 24/100
41/41 [==============================] - 43s 1s/step - loss: 0.0743 - f1: 0.9301
Epoch 25/100
41/41 [==============================] - 43s 1s/step - loss: 0.0722 - f1: 0.9308
Epoch 26/100
41/41 [==============================] - 42s 1s/step - loss: 0.0879 - f1: 0.9157
Epoch 27/100
41/41 [==============================] - 43s 1s/step - loss: 0.0688 - f1: 0.9350
Epoch 28/100
41/41 [==============================] - 43s 1s/step - loss: 0.0648 - f1: 0.9368
Epoch 29/100
41/41 [==============================] - 43s 1s/step - loss: 0.0686 - f1: 0.9336
Epoch 30/100
41/41 [==============================] - 43s 1s/step - loss: 0.0677 - f1: 0.9333
Epoch 31/100
41/41 [==============================] - 42s 1s/step - loss: 0.0657 - f1: 0.9376
Epoch 32/100
41/41 [==============================] - 41s 1s/step - loss: 0.0683 - f1: 0.9321
Epoch 33/100
41/41 [==============================] - 44s 1s/step - loss: 0.0650 - f1: 0.9356
Epoch 34/100
41/41 [==============================] - 43s 1s/step - loss: 0.0659 - f1: 0.9366
Epoch 35/100
41/41 [==============================] - 43s 1s/step - loss: 0.0673 - f1: 0.9343
Epoch 36/100
41/41 [==============================] - 41s 994ms/step - loss: 0.0621 - f1: 0.9384
Epoch 37/100
41/41 [==============================] - 46s 1s/step - loss: 0.0614 - f1: 0.9403
Epoch 38/100
41/41 [==============================] - 43s 1s/step - loss: 0.0594 - f1: 0.9446
Epoch 39/100
41/41 [==============================] - 42s 1s/step - loss: 0.0651 - f1: 0.9338
Epoch 40/100
41/41 [==============================] - 41s 994ms/step - loss: 0.0596 - f1: 0.9430
Epoch 41/100
41/41 [==============================] - 40s 982ms/step - loss: 0.0591 - f1: 0.9407
Epoch 42/100
41/41 [==============================] - 40s 977ms/step - loss: 0.0661 - f1: 0.9285
Epoch 43/100
41/41 [==============================] - 40s 984ms/step - loss: 0.0613 - f1: 0.9412
Epoch 44/100
41/41 [==============================] - 41s 999ms/step - loss: 0.0591 - f1: 0.9420
Epoch 45/100
41/41 [==============================] - 41s 991ms/step - loss: 0.0555 - f1: 0.9466
Epoch 46/100
41/41 [==============================] - 39s 960ms/step - loss: 0.0551 - f1: 0.9471
Epoch 47/100
41/41 [==============================] - 39s 955ms/step - loss: 0.0544 - f1: 0.9478
Epoch 48/100
41/41 [==============================] - 39s 964ms/step - loss: 0.0529 - f1: 0.9470
Epoch 49/100
41/41 [==============================] - 42s 1s/step - loss: 0.0524 - f1: 0.9491
Epoch 50/100
41/41 [==============================] - 42s 1s/step - loss: 0.0536 - f1: 0.9470
Epoch 51/100
41/41 [==============================] - 42s 1s/step - loss: 0.0662 - f1: 0.9333
Epoch 52/100
41/41 [==============================] - 40s 980ms/step - loss: 0.0590 - f1: 0.9395
Epoch 53/100
41/41 [==============================] - 41s 1000ms/step - loss: 0.0577 - f1: 0.9434
Epoch 54/100
41/41 [==============================] - 41s 993ms/step - loss: 0.0546 - f1: 0.9480
Epoch 55/100
41/41 [==============================] - 39s 955ms/step - loss: 0.0542 - f1: 0.9465
Epoch 56/100
41/41 [==============================] - 39s 963ms/step - loss: 0.0535 - f1: 0.9474
Epoch 57/100
41/41 [==============================] - 39s 938ms/step - loss: 0.0535 - f1: 0.9487
Epoch 58/100
41/41 [==============================] - 39s 959ms/step - loss: 0.0553 - f1: 0.9450
Epoch 59/100
41/41 [==============================] - 41s 1s/step - loss: 0.0520 - f1: 0.9493
Epoch 60/100
41/41 [==============================] - 40s 983ms/step - loss: 0.0521 - f1: 0.9485
Epoch 61/100
41/41 [==============================] - 40s 985ms/step - loss: 0.0508 - f1: 0.9494
Epoch 62/100
41/41 [==============================] - 40s 974ms/step - loss: 0.0542 - f1: 0.9465
Epoch 63/100
41/41 [==============================] - 40s 983ms/step - loss: 0.0532 - f1: 0.9488
Epoch 64/100
41/41 [==============================] - 39s 960ms/step - loss: 0.0525 - f1: 0.9474
Epoch 65/100
41/41 [==============================] - 39s 942ms/step - loss: 0.0543 - f1: 0.9463
Epoch 66/100
41/41 [==============================] - 39s 947ms/step - loss: 0.0564 - f1: 0.9445
Epoch 67/100
41/41 [==============================] - 40s 979ms/step - loss: 0.0560 - f1: 0.9455
Epoch 68/100
41/41 [==============================] - 40s 968ms/step - loss: 0.0581 - f1: 0.9419
Epoch 69/100
41/41 [==============================] - 41s 1s/step - loss: 0.0536 - f1: 0.9480
Epoch 70/100
41/41 [==============================] - 41s 1s/step - loss: 0.0542 - f1: 0.9478
Epoch 71/100
41/41 [==============================] - 39s 943ms/step - loss: 0.0545 - f1: 0.9463
Epoch 72/100
41/41 [==============================] - 42s 1s/step - loss: 0.0536 - f1: 0.9495
Epoch 73/100
41/41 [==============================] - 42s 1s/step - loss: 0.0499 - f1: 0.9510
Epoch 74/100
41/41 [==============================] - 40s 988ms/step - loss: 0.0502 - f1: 0.9503
Epoch 75/100
41/41 [==============================] - 39s 956ms/step - loss: 0.0545 - f1: 0.9483
Epoch 76/100
41/41 [==============================] - 41s 997ms/step - loss: 0.0519 - f1: 0.9470
Epoch 77/100
41/41 [==============================] - 40s 977ms/step - loss: 0.0574 - f1: 0.9435
Epoch 78/100
41/41 [==============================] - 40s 982ms/step - loss: 0.0561 - f1: 0.9451
Epoch 79/100
41/41 [==============================] - 41s 1s/step - loss: 0.0481 - f1: 0.9536
Epoch 80/100
41/41 [==============================] - 38s 934ms/step - loss: 0.0468 - f1: 0.9532
Epoch 81/100
41/41 [==============================] - 39s 945ms/step - loss: 0.0465 - f1: 0.9555
Epoch 82/100
41/41 [==============================] - 40s 977ms/step - loss: 0.0446 - f1: 0.9557
Epoch 83/100
41/41 [==============================] - 41s 1s/step - loss: 0.0514 - f1: 0.9481
Epoch 84/100
41/41 [==============================] - 39s 944ms/step - loss: 0.0478 - f1: 0.9529
Epoch 85/100
41/41 [==============================] - 39s 944ms/step - loss: 0.0424 - f1: 0.9591
Epoch 86/100
41/41 [==============================] - 39s 940ms/step - loss: 0.0543 - f1: 0.9466
Epoch 87/100
41/41 [==============================] - 39s 951ms/step - loss: 0.0421 - f1: 0.9594
Epoch 88/100
41/41 [==============================] - 40s 971ms/step - loss: 0.0435 - f1: 0.9577
Epoch 89/100
41/41 [==============================] - 40s 972ms/step - loss: 0.0472 - f1: 0.9521
Epoch 90/100
41/41 [==============================] - 39s 950ms/step - loss: 0.0445 - f1: 0.9567
Epoch 91/100
41/41 [==============================] - 40s 969ms/step - loss: 0.0445 - f1: 0.9568
Epoch 92/100
41/41 [==============================] - 40s 984ms/step - loss: 0.0450 - f1: 0.9563
Epoch 93/100
41/41 [==============================] - 40s 964ms/step - loss: 0.0752 - f1: 0.9269
Epoch 94/100
41/41 [==============================] - 40s 979ms/step - loss: 0.0650 - f1: 0.9366
Epoch 95/100
41/41 [==============================] - 41s 1s/step - loss: 0.0563 - f1: 0.9424
Epoch 96/100
41/41 [==============================] - 41s 997ms/step - loss: 0.0497 - f1: 0.9514
Epoch 97/100
41/41 [==============================] - 41s 1s/step - loss: 0.0498 - f1: 0.9516
Epoch 98/100
41/41 [==============================] - 41s 1s/step - loss: 0.0470 - f1: 0.9535
Epoch 99/100
41/41 [==============================] - 40s 971ms/step - loss: 0.0447 - f1: 0.9554
Epoch 100/100
41/41 [==============================] - 40s 983ms/step - loss: 0.0459 - f1: 0.9549
Now predicting on train set (0.2 dropout)
Accuracy: 0.9857004830917875
Precision: 0.9637426900584796
Recall: 0.9504036908881199
F1 score: 0.957027


Now predicting on test set (0.2 dropout)
Accuracy: 0.9711451758340848
Precision: 0.9253731343283582
Recall: 0.916256157635468
F1 score: 0.920792


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9720468890892696
Precision: 0.9215686274509803
Recall: 0.88125
F1 score: 0.900958


saving LSTM model open_redirect.  13:14




Process finished with exit code 0
