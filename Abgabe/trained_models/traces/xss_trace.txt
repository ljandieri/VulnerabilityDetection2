C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  00:13
cutoff 757
cutoff2 920
Creating training dataset... (xss)
Creating validation dataset...
Creating finaltest dataset...
Train length: 757
Test length: 163
Finaltesting length: 162
time:  00:13
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  00:13
757 samples in the training set.
163 samples in the validation set.
162 samples in the final test set.
percentage of vulnerable samples: 18.09%
absolute amount of vulnerable samples in test set: 31
Starting LSTM:  00:13
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-04 00:13:05.454951: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-04 00:13:06.185110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  00:13
Epoch 1/100
6/6 [==============================] - 9s 978ms/step - loss: 0.6980 - f1: 0.3148
Epoch 2/100
6/6 [==============================] - 6s 951ms/step - loss: 0.6655 - f1: 0.3167
Epoch 3/100
6/6 [==============================] - 6s 1s/step - loss: 0.6139 - f1: 0.4427
Epoch 4/100
6/6 [==============================] - 6s 921ms/step - loss: 0.5062 - f1: 0.5542
Epoch 5/100
6/6 [==============================] - 6s 962ms/step - loss: 0.3550 - f1: 0.6897
Epoch 6/100
6/6 [==============================] - 6s 1s/step - loss: 0.2428 - f1: 0.7821
Epoch 7/100
6/6 [==============================] - 6s 981ms/step - loss: 0.2162 - f1: 0.8039
Epoch 8/100
6/6 [==============================] - 6s 939ms/step - loss: 0.1938 - f1: 0.8186
Epoch 9/100
6/6 [==============================] - 6s 1s/step - loss: 0.1859 - f1: 0.8238
Epoch 10/100
6/6 [==============================] - 6s 930ms/step - loss: 0.1618 - f1: 0.8564
Epoch 11/100
6/6 [==============================] - 6s 964ms/step - loss: 0.1433 - f1: 0.8739
Epoch 12/100
6/6 [==============================] - 6s 1s/step - loss: 0.1163 - f1: 0.8903
Epoch 13/100
6/6 [==============================] - 6s 914ms/step - loss: 0.1528 - f1: 0.8526
Epoch 14/100
6/6 [==============================] - 6s 922ms/step - loss: 0.1119 - f1: 0.8971
Epoch 15/100
6/6 [==============================] - 6s 958ms/step - loss: 0.1222 - f1: 0.8873
Epoch 16/100
6/6 [==============================] - 5s 886ms/step - loss: 0.1258 - f1: 0.8788
Epoch 17/100
6/6 [==============================] - 6s 899ms/step - loss: 0.1294 - f1: 0.8710
Epoch 18/100
6/6 [==============================] - 6s 933ms/step - loss: 0.1355 - f1: 0.8677
Epoch 19/100
6/6 [==============================] - 6s 932ms/step - loss: 0.1451 - f1: 0.8634
Epoch 20/100
6/6 [==============================] - 6s 928ms/step - loss: 0.1292 - f1: 0.8674
Epoch 21/100
6/6 [==============================] - 6s 930ms/step - loss: 0.1343 - f1: 0.8775
Epoch 22/100
6/6 [==============================] - 6s 948ms/step - loss: 0.0925 - f1: 0.9091
Epoch 23/100
6/6 [==============================] - 6s 969ms/step - loss: 0.0898 - f1: 0.9077
Epoch 24/100
6/6 [==============================] - 6s 996ms/step - loss: 0.0780 - f1: 0.9268
Epoch 25/100
6/6 [==============================] - 6s 952ms/step - loss: 0.0859 - f1: 0.9172
Epoch 26/100
6/6 [==============================] - 5s 880ms/step - loss: 0.0814 - f1: 0.9204
Epoch 27/100
6/6 [==============================] - 6s 986ms/step - loss: 0.0741 - f1: 0.9275
Epoch 28/100
6/6 [==============================] - 5s 879ms/step - loss: 0.0786 - f1: 0.9220
Epoch 29/100
6/6 [==============================] - 5s 883ms/step - loss: 0.0762 - f1: 0.9240
Epoch 30/100
6/6 [==============================] - 5s 878ms/step - loss: 0.0797 - f1: 0.9137
Epoch 31/100
6/6 [==============================] - 5s 915ms/step - loss: 0.0718 - f1: 0.9277
Epoch 32/100
6/6 [==============================] - 6s 985ms/step - loss: 0.0758 - f1: 0.9261
Epoch 33/100
6/6 [==============================] - 6s 1s/step - loss: 0.0697 - f1: 0.9331
Epoch 34/100
6/6 [==============================] - 6s 952ms/step - loss: 0.0780 - f1: 0.9291
Epoch 35/100
6/6 [==============================] - 6s 961ms/step - loss: 0.0767 - f1: 0.9249
Epoch 36/100
6/6 [==============================] - 5s 914ms/step - loss: 0.0720 - f1: 0.9299
Epoch 37/100
6/6 [==============================] - 6s 958ms/step - loss: 0.0787 - f1: 0.9210
Epoch 38/100
6/6 [==============================] - 5s 901ms/step - loss: 0.0795 - f1: 0.9183
Epoch 39/100
6/6 [==============================] - 6s 957ms/step - loss: 0.0908 - f1: 0.9105
Epoch 40/100
6/6 [==============================] - 6s 917ms/step - loss: 0.0980 - f1: 0.9034
Epoch 41/100
6/6 [==============================] - 6s 900ms/step - loss: 0.0926 - f1: 0.9068
Epoch 42/100
6/6 [==============================] - 6s 930ms/step - loss: 0.1039 - f1: 0.8974
Epoch 43/100
6/6 [==============================] - 6s 943ms/step - loss: 0.0928 - f1: 0.9097
Epoch 44/100
6/6 [==============================] - 6s 947ms/step - loss: 0.0931 - f1: 0.9092
Epoch 45/100
6/6 [==============================] - 6s 934ms/step - loss: 0.0874 - f1: 0.9144
Epoch 46/100
6/6 [==============================] - 6s 993ms/step - loss: 0.0822 - f1: 0.9172
Epoch 47/100
6/6 [==============================] - 6s 907ms/step - loss: 0.0688 - f1: 0.9337
Epoch 48/100
6/6 [==============================] - 5s 887ms/step - loss: 0.0713 - f1: 0.9313
Epoch 49/100
6/6 [==============================] - 6s 944ms/step - loss: 0.0978 - f1: 0.9014
Epoch 50/100
6/6 [==============================] - 6s 955ms/step - loss: 0.0941 - f1: 0.9113
Epoch 51/100
6/6 [==============================] - 6s 950ms/step - loss: 0.0895 - f1: 0.9119
Epoch 52/100
6/6 [==============================] - 6s 956ms/step - loss: 0.0862 - f1: 0.9148
Epoch 53/100
6/6 [==============================] - 5s 881ms/step - loss: 0.0773 - f1: 0.9291
Epoch 54/100
6/6 [==============================] - 5s 902ms/step - loss: 0.0720 - f1: 0.9276
Epoch 55/100
6/6 [==============================] - 6s 927ms/step - loss: 0.0785 - f1: 0.9131
Epoch 56/100
6/6 [==============================] - 5s 897ms/step - loss: 0.0897 - f1: 0.9098
Epoch 57/100
6/6 [==============================] - 5s 883ms/step - loss: 0.0998 - f1: 0.9045
Epoch 58/100
6/6 [==============================] - 5s 920ms/step - loss: 0.0896 - f1: 0.9103
Epoch 59/100
6/6 [==============================] - 5s 880ms/step - loss: 0.0728 - f1: 0.9254
Epoch 60/100
6/6 [==============================] - 5s 915ms/step - loss: 0.0659 - f1: 0.9339
Epoch 61/100
6/6 [==============================] - 6s 940ms/step - loss: 0.0666 - f1: 0.9323
Epoch 62/100
6/6 [==============================] - 6s 946ms/step - loss: 0.0665 - f1: 0.9362
Epoch 63/100
6/6 [==============================] - 6s 971ms/step - loss: 0.0688 - f1: 0.9287
Epoch 64/100
6/6 [==============================] - 6s 894ms/step - loss: 0.0789 - f1: 0.9234
Epoch 65/100
6/6 [==============================] - 6s 954ms/step - loss: 0.0770 - f1: 0.9204
Epoch 66/100
6/6 [==============================] - 6s 914ms/step - loss: 0.0618 - f1: 0.9420
Epoch 67/100
6/6 [==============================] - 5s 886ms/step - loss: 0.0597 - f1: 0.9396
Epoch 68/100
6/6 [==============================] - 6s 1s/step - loss: 0.0567 - f1: 0.9471
Epoch 69/100
6/6 [==============================] - 6s 1s/step - loss: 0.0516 - f1: 0.9520
Epoch 70/100
6/6 [==============================] - 5s 919ms/step - loss: 0.0462 - f1: 0.9593
Epoch 71/100
6/6 [==============================] - 6s 971ms/step - loss: 0.0660 - f1: 0.9361
Epoch 72/100
6/6 [==============================] - 6s 957ms/step - loss: 0.0841 - f1: 0.9112
Epoch 73/100
6/6 [==============================] - 6s 923ms/step - loss: 0.0862 - f1: 0.9137
Epoch 74/100
6/6 [==============================] - 6s 957ms/step - loss: 0.0726 - f1: 0.9246
Epoch 75/100
6/6 [==============================] - 5s 889ms/step - loss: 0.0912 - f1: 0.9076
Epoch 76/100
6/6 [==============================] - 6s 1s/step - loss: 0.0842 - f1: 0.9199
Epoch 77/100
6/6 [==============================] - 6s 973ms/step - loss: 0.0625 - f1: 0.9386
Epoch 78/100
6/6 [==============================] - 6s 975ms/step - loss: 0.0473 - f1: 0.9572
Epoch 79/100
6/6 [==============================] - 6s 982ms/step - loss: 0.0517 - f1: 0.9501
Epoch 80/100
6/6 [==============================] - 7s 1s/step - loss: 0.0489 - f1: 0.9499
Epoch 81/100
6/6 [==============================] - 6s 975ms/step - loss: 0.0465 - f1: 0.9529
Epoch 82/100
6/6 [==============================] - 6s 979ms/step - loss: 0.0349 - f1: 0.9686
Epoch 83/100
6/6 [==============================] - 6s 969ms/step - loss: 0.0424 - f1: 0.9568
Epoch 84/100
6/6 [==============================] - 6s 1s/step - loss: 0.0639 - f1: 0.9360
Epoch 85/100
6/6 [==============================] - 6s 1s/step - loss: 0.0672 - f1: 0.9330
Epoch 86/100
6/6 [==============================] - 6s 1s/step - loss: 0.0645 - f1: 0.9327
Epoch 87/100
6/6 [==============================] - 6s 993ms/step - loss: 0.0566 - f1: 0.9475
Epoch 88/100
6/6 [==============================] - 6s 961ms/step - loss: 0.0649 - f1: 0.9380
Epoch 89/100
6/6 [==============================] - 6s 992ms/step - loss: 0.0645 - f1: 0.9337
Epoch 90/100
6/6 [==============================] - 6s 973ms/step - loss: 0.0679 - f1: 0.9338
Epoch 91/100
6/6 [==============================] - 6s 946ms/step - loss: 0.0555 - f1: 0.9517
Epoch 92/100
6/6 [==============================] - 6s 1s/step - loss: 0.0587 - f1: 0.9369
Epoch 93/100
6/6 [==============================] - 6s 1s/step - loss: 0.0542 - f1: 0.9450
Epoch 94/100
6/6 [==============================] - 6s 949ms/step - loss: 0.0473 - f1: 0.9544
Epoch 95/100
6/6 [==============================] - 5s 901ms/step - loss: 0.0396 - f1: 0.9636
Epoch 96/100
6/6 [==============================] - 6s 944ms/step - loss: 0.0425 - f1: 0.9622
Epoch 97/100
6/6 [==============================] - 6s 940ms/step - loss: 0.0472 - f1: 0.9593
Epoch 98/100
6/6 [==============================] - 5s 899ms/step - loss: 0.0399 - f1: 0.9612
Epoch 99/100
6/6 [==============================] - 6s 926ms/step - loss: 0.0402 - f1: 0.9635
Epoch 100/100
6/6 [==============================] - 5s 893ms/step - loss: 0.0513 - f1: 0.9558
Now predicting on train set (0.2 dropout)
Accuracy: 0.9828269484808454
Precision: 0.9492753623188406
Recall: 0.9562043795620438
F1 score: 0.952727


Now predicting on test set (0.2 dropout)
Accuracy: 0.9570552147239264
Precision: 0.875
Recall: 0.9032258064516129
F1 score: 0.888889


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9567901234567902
Precision: 0.9333333333333333
Recall: 0.8484848484848485
F1 score: 0.888889


saving LSTM model xss.  00:22




Process finished with exit code 0
