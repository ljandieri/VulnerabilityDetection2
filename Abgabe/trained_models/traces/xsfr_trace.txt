finished loading.  20:18
cutoff 7090
cutoff2 8610
Creating training dataset... (xsfr)
Creating validation dataset...
Creating finaltest dataset...
Train length: 7090
Test length: 1520
Finaltesting length: 1519
time:  20:18
numpy array done.  20:18
7090 samples in the training set.
1520 samples in the validation set.
1519 samples in the final test set.
percentage of vulnerable samples: 8.22%
absolute amount of vulnerable samples in test set: 133
Starting LSTM:  20:18
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:242: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:248: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:250: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
2021-12-03 20:18:23.214296: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 20:18:23.963336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  20:18
2021-12-03 20:18:25.292322: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 1134400000 exceeds 10% of free system memory.
Epoch 1/100
56/56 [==============================] - 54s 916ms/step - loss: 0.6642 - f1: 0.3585
Epoch 2/100
56/56 [==============================] - 53s 939ms/step - loss: 0.4116 - f1: 0.6058
Epoch 3/100
56/56 [==============================] - 53s 937ms/step - loss: 0.3004 - f1: 0.7094
Epoch 4/100
56/56 [==============================] - 53s 941ms/step - loss: 0.2993 - f1: 0.7103
Epoch 5/100
56/56 [==============================] - 53s 939ms/step - loss: 0.2857 - f1: 0.7208
Epoch 6/100
56/56 [==============================] - 52s 933ms/step - loss: 0.2070 - f1: 0.8022
Epoch 7/100
56/56 [==============================] - 52s 934ms/step - loss: 0.1828 - f1: 0.8257
Epoch 8/100
56/56 [==============================] - 52s 927ms/step - loss: 0.1763 - f1: 0.8263
Epoch 9/100
56/56 [==============================] - 52s 927ms/step - loss: 0.1687 - f1: 0.8356
Epoch 10/100
56/56 [==============================] - 53s 946ms/step - loss: 0.2430 - f1: 0.7547
Epoch 11/100
56/56 [==============================] - 52s 921ms/step - loss: 0.1513 - f1: 0.8513
Epoch 12/100
56/56 [==============================] - 51s 919ms/step - loss: 0.1379 - f1: 0.8674
Epoch 13/100
56/56 [==============================] - 52s 928ms/step - loss: 0.1347 - f1: 0.8702
Epoch 14/100
56/56 [==============================] - 52s 920ms/step - loss: 0.1424 - f1: 0.8578
Epoch 15/100
56/56 [==============================] - 52s 931ms/step - loss: 0.1189 - f1: 0.8879
Epoch 16/100
56/56 [==============================] - 53s 943ms/step - loss: 0.1195 - f1: 0.8809
Epoch 17/100
56/56 [==============================] - 52s 930ms/step - loss: 0.1231 - f1: 0.8772
Epoch 18/100
56/56 [==============================] - 52s 922ms/step - loss: 0.1287 - f1: 0.8700
Epoch 19/100
56/56 [==============================] - 53s 945ms/step - loss: 0.1158 - f1: 0.8900
Epoch 20/100
56/56 [==============================] - 53s 944ms/step - loss: 0.1152 - f1: 0.8871
Epoch 21/100
56/56 [==============================] - 52s 925ms/step - loss: 0.1252 - f1: 0.8768
Epoch 22/100
56/56 [==============================] - 51s 919ms/step - loss: 0.1062 - f1: 0.8993
Epoch 23/100
56/56 [==============================] - 52s 920ms/step - loss: 0.1069 - f1: 0.8940
Epoch 24/100
56/56 [==============================] - 52s 925ms/step - loss: 0.1043 - f1: 0.9011
Epoch 25/100
56/56 [==============================] - 52s 931ms/step - loss: 0.1024 - f1: 0.9002
Epoch 26/100
56/56 [==============================] - 51s 913ms/step - loss: 0.0998 - f1: 0.9012
Epoch 27/100
56/56 [==============================] - 51s 915ms/step - loss: 0.0932 - f1: 0.9083
Epoch 28/100
56/56 [==============================] - 52s 937ms/step - loss: 0.0858 - f1: 0.9187
Epoch 29/100
56/56 [==============================] - 52s 923ms/step - loss: 0.0901 - f1: 0.9075
Epoch 30/100
56/56 [==============================] - 51s 915ms/step - loss: 0.0823 - f1: 0.9168
Epoch 31/100
56/56 [==============================] - 51s 915ms/step - loss: 0.0864 - f1: 0.9097
Epoch 32/100
56/56 [==============================] - 53s 947ms/step - loss: 0.0939 - f1: 0.9078
Epoch 33/100
56/56 [==============================] - 51s 909ms/step - loss: 0.0816 - f1: 0.9207
Epoch 34/100
56/56 [==============================] - 52s 923ms/step - loss: 0.0782 - f1: 0.9254
Epoch 35/100
56/56 [==============================] - 51s 910ms/step - loss: 0.0769 - f1: 0.9241
Epoch 36/100
56/56 [==============================] - 51s 907ms/step - loss: 0.0808 - f1: 0.9194
Epoch 37/100
56/56 [==============================] - 52s 925ms/step - loss: 0.0812 - f1: 0.9174
Epoch 38/100
56/56 [==============================] - 52s 928ms/step - loss: 0.0879 - f1: 0.9102
Epoch 39/100
56/56 [==============================] - 51s 914ms/step - loss: 0.0784 - f1: 0.9227
Epoch 40/100
56/56 [==============================] - 52s 933ms/step - loss: 0.0748 - f1: 0.9263
Epoch 41/100
56/56 [==============================] - 52s 925ms/step - loss: 0.0861 - f1: 0.9133
Epoch 42/100
56/56 [==============================] - 57s 1s/step - loss: 0.0783 - f1: 0.9178
Epoch 43/100
56/56 [==============================] - 55s 977ms/step - loss: 0.0732 - f1: 0.9297
Epoch 44/100
56/56 [==============================] - 53s 942ms/step - loss: 0.0750 - f1: 0.9246
Epoch 45/100
56/56 [==============================] - 53s 944ms/step - loss: 0.0737 - f1: 0.9283
Epoch 46/100
56/56 [==============================] - 51s 919ms/step - loss: 0.0759 - f1: 0.9259
Epoch 47/100
56/56 [==============================] - 52s 924ms/step - loss: 0.0744 - f1: 0.9280
Epoch 48/100
56/56 [==============================] - 53s 946ms/step - loss: 0.0925 - f1: 0.9080
Epoch 49/100
56/56 [==============================] - 54s 955ms/step - loss: 0.0801 - f1: 0.9198
Epoch 50/100
56/56 [==============================] - 55s 988ms/step - loss: 0.0775 - f1: 0.9238
Epoch 51/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0710 - f1: 0.9301
Epoch 52/100
56/56 [==============================] - 54s 961ms/step - loss: 0.0725 - f1: 0.9287
Epoch 53/100
56/56 [==============================] - 54s 956ms/step - loss: 0.0806 - f1: 0.9220
Epoch 54/100
56/56 [==============================] - 52s 928ms/step - loss: 0.0812 - f1: 0.9223
Epoch 55/100
56/56 [==============================] - 53s 952ms/step - loss: 0.0749 - f1: 0.9283
Epoch 56/100
56/56 [==============================] - 53s 935ms/step - loss: 0.0827 - f1: 0.9145
Epoch 57/100
56/56 [==============================] - 52s 928ms/step - loss: 0.1655 - f1: 0.8348
Epoch 58/100
56/56 [==============================] - 51s 915ms/step - loss: 0.0847 - f1: 0.9175
Epoch 59/100
56/56 [==============================] - 51s 911ms/step - loss: 0.0699 - f1: 0.9298
Epoch 60/100
56/56 [==============================] - 51s 914ms/step - loss: 0.0660 - f1: 0.9310
Epoch 61/100
56/56 [==============================] - 51s 902ms/step - loss: 0.0638 - f1: 0.9361
Epoch 62/100
56/56 [==============================] - 52s 924ms/step - loss: 0.0620 - f1: 0.9392
Epoch 63/100
56/56 [==============================] - 52s 923ms/step - loss: 0.0620 - f1: 0.9397
Epoch 64/100
56/56 [==============================] - 51s 919ms/step - loss: 0.0685 - f1: 0.9320
Epoch 65/100
56/56 [==============================] - 51s 919ms/step - loss: 0.0650 - f1: 0.9380
Epoch 66/100
56/56 [==============================] - 52s 917ms/step - loss: 0.0605 - f1: 0.9372
Epoch 67/100
56/56 [==============================] - 52s 920ms/step - loss: 0.0650 - f1: 0.9320
Epoch 68/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0645 - f1: 0.9357
Epoch 69/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0620 - f1: 0.9391
Epoch 70/100
56/56 [==============================] - 54s 955ms/step - loss: 0.0620 - f1: 0.9368
Epoch 71/100
56/56 [==============================] - 54s 958ms/step - loss: 0.0606 - f1: 0.9390
Epoch 72/100
56/56 [==============================] - 53s 935ms/step - loss: 0.0585 - f1: 0.9438
Epoch 73/100
56/56 [==============================] - 51s 910ms/step - loss: 0.0586 - f1: 0.9416
Epoch 74/100
56/56 [==============================] - 51s 915ms/step - loss: 0.0633 - f1: 0.9351
Epoch 75/100
56/56 [==============================] - 51s 910ms/step - loss: 0.0735 - f1: 0.9281
Epoch 76/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0578 - f1: 0.9420
Epoch 77/100
56/56 [==============================] - 52s 922ms/step - loss: 0.0534 - f1: 0.9480
Epoch 78/100
56/56 [==============================] - 52s 925ms/step - loss: 0.0504 - f1: 0.9530
Epoch 79/100
56/56 [==============================] - 52s 917ms/step - loss: 0.0535 - f1: 0.9488
Epoch 80/100
56/56 [==============================] - 52s 932ms/step - loss: 0.0580 - f1: 0.9459
Epoch 81/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0566 - f1: 0.9442
Epoch 82/100
56/56 [==============================] - 53s 939ms/step - loss: 0.0570 - f1: 0.9465
Epoch 83/100
56/56 [==============================] - 53s 956ms/step - loss: 0.0567 - f1: 0.9451
Epoch 84/100
56/56 [==============================] - 51s 917ms/step - loss: 0.0533 - f1: 0.9492
Epoch 85/100
56/56 [==============================] - 52s 935ms/step - loss: 0.0508 - f1: 0.9501
Epoch 86/100
56/56 [==============================] - 52s 935ms/step - loss: 0.0508 - f1: 0.9507
Epoch 87/100
56/56 [==============================] - 54s 963ms/step - loss: 0.0543 - f1: 0.9440
Epoch 88/100
56/56 [==============================] - 52s 926ms/step - loss: 0.0523 - f1: 0.9481
Epoch 89/100
56/56 [==============================] - 51s 919ms/step - loss: 0.0499 - f1: 0.9510
Epoch 90/100
56/56 [==============================] - 52s 936ms/step - loss: 0.0518 - f1: 0.9490
Epoch 91/100
56/56 [==============================] - 52s 923ms/step - loss: 0.0523 - f1: 0.9449
Epoch 92/100
56/56 [==============================] - 52s 929ms/step - loss: 0.0519 - f1: 0.9478
Epoch 93/100
56/56 [==============================] - 51s 917ms/step - loss: 0.0529 - f1: 0.9484
Epoch 94/100
56/56 [==============================] - 50s 899ms/step - loss: 0.0510 - f1: 0.9505
Epoch 95/100
56/56 [==============================] - 51s 910ms/step - loss: 0.0526 - f1: 0.9466
Epoch 96/100
56/56 [==============================] - 52s 919ms/step - loss: 0.0503 - f1: 0.9482
Epoch 97/100
56/56 [==============================] - 51s 909ms/step - loss: 0.0497 - f1: 0.9515
Epoch 98/100
56/56 [==============================] - 51s 912ms/step - loss: 0.0485 - f1: 0.9530
Epoch 99/100
56/56 [==============================] - 51s 920ms/step - loss: 0.0503 - f1: 0.9490
Epoch 100/100
56/56 [==============================] - 51s 920ms/step - loss: 0.0520 - f1: 0.9474
Now predicting on train set (0.2 dropout)
Accuracy: 0.992524682651622
Precision: 0.9871323529411765
Recall: 0.9210977701543739
F1 score: 0.952972


Now predicting on test set (0.2 dropout)
Accuracy: 0.9881578947368421
Precision: 0.9752066115702479
Recall: 0.8872180451127819
F1 score: 0.929134


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.989466754443713
Precision: 0.9887640449438202
Recall: 0.8543689320388349
F1 score: 0.916667


saving LSTM model xsfr.  21:46