C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  08:14
cutoff 4975
cutoff2 6041
Creating training dataset... (remote_code_execution)
Creating validation dataset...
Creating finaltest dataset...
Train length: 4975
Test length: 1066
Finaltesting length: 1066
time:  08:14
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  08:14
4975 samples in the training set.
1066 samples in the validation set.
1066 samples in the final test set.
percentage of vulnerable samples: 9.38%
absolute amount of vulnerable samples in test set: 106
Starting LSTM:  08:14
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-04 08:14:28.532547: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-04 08:14:29.271350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Compiled LSTM:  08:14
2021-12-04 08:14:30.123011: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 796000000 exceeds 10% of free system memory.
Epoch 1/100
39/39 [==============================] - 39s 921ms/step - loss: 0.7413 - f1: 0.2850
Epoch 2/100
39/39 [==============================] - 36s 932ms/step - loss: 0.4432 - f1: 0.5811
Epoch 3/100
39/39 [==============================] - 36s 917ms/step - loss: 0.3152 - f1: 0.6923
Epoch 4/100
39/39 [==============================] - 37s 943ms/step - loss: 0.2309 - f1: 0.7807
Epoch 5/100
39/39 [==============================] - 36s 924ms/step - loss: 0.2065 - f1: 0.8019
Epoch 6/100
39/39 [==============================] - 36s 932ms/step - loss: 0.2126 - f1: 0.7872
Epoch 7/100
39/39 [==============================] - 37s 947ms/step - loss: 0.1574 - f1: 0.8475
Epoch 8/100
39/39 [==============================] - 36s 919ms/step - loss: 0.1573 - f1: 0.8409
Epoch 9/100
39/39 [==============================] - 36s 934ms/step - loss: 0.2482 - f1: 0.7558
Epoch 10/100
39/39 [==============================] - 36s 930ms/step - loss: 0.1398 - f1: 0.8623
Epoch 11/100
39/39 [==============================] - 36s 928ms/step - loss: 0.1290 - f1: 0.8741
Epoch 12/100
39/39 [==============================] - 36s 918ms/step - loss: 0.1383 - f1: 0.8606
Epoch 13/100
39/39 [==============================] - 37s 942ms/step - loss: 0.1335 - f1: 0.8627
Epoch 14/100
39/39 [==============================] - 36s 926ms/step - loss: 0.1355 - f1: 0.8641
Epoch 15/100
39/39 [==============================] - 36s 932ms/step - loss: 0.1506 - f1: 0.8505
Epoch 16/100
39/39 [==============================] - 36s 914ms/step - loss: 0.1526 - f1: 0.8523
Epoch 17/100
39/39 [==============================] - 36s 919ms/step - loss: 0.1335 - f1: 0.8699
Epoch 18/100
39/39 [==============================] - 37s 937ms/step - loss: 0.1229 - f1: 0.8792
Epoch 19/100
39/39 [==============================] - 36s 922ms/step - loss: 0.1138 - f1: 0.8854
Epoch 20/100
39/39 [==============================] - 36s 930ms/step - loss: 0.1092 - f1: 0.8907
Epoch 21/100
39/39 [==============================] - 36s 915ms/step - loss: 0.1137 - f1: 0.8864
Epoch 22/100
39/39 [==============================] - 36s 911ms/step - loss: 0.1500 - f1: 0.8496
Epoch 23/100
39/39 [==============================] - 36s 916ms/step - loss: 0.1122 - f1: 0.8881
Epoch 24/100
39/39 [==============================] - 36s 913ms/step - loss: 0.1150 - f1: 0.8842
Epoch 25/100
39/39 [==============================] - 36s 933ms/step - loss: 0.1070 - f1: 0.8903
Epoch 26/100
39/39 [==============================] - 36s 916ms/step - loss: 0.1044 - f1: 0.8937
Epoch 27/100
39/39 [==============================] - 36s 927ms/step - loss: 0.1135 - f1: 0.8904
Epoch 28/100
39/39 [==============================] - 35s 909ms/step - loss: 0.1234 - f1: 0.8761
Epoch 29/100
39/39 [==============================] - 36s 928ms/step - loss: 0.1000 - f1: 0.8993
Epoch 30/100
39/39 [==============================] - 37s 963ms/step - loss: 0.0921 - f1: 0.9081
Epoch 31/100
39/39 [==============================] - 36s 927ms/step - loss: 0.1026 - f1: 0.8964
Epoch 32/100
39/39 [==============================] - 36s 917ms/step - loss: 0.1127 - f1: 0.8879
Epoch 33/100
39/39 [==============================] - 36s 926ms/step - loss: 0.0968 - f1: 0.9060
Epoch 34/100
39/39 [==============================] - 36s 936ms/step - loss: 0.1026 - f1: 0.8984
Epoch 35/100
39/39 [==============================] - 35s 906ms/step - loss: 0.1041 - f1: 0.8931
Epoch 36/100
39/39 [==============================] - 36s 936ms/step - loss: 0.1100 - f1: 0.8875
Epoch 37/100
39/39 [==============================] - 35s 908ms/step - loss: 0.0954 - f1: 0.9048
Epoch 38/100
39/39 [==============================] - 36s 917ms/step - loss: 0.1461 - f1: 0.8570
Epoch 39/100
39/39 [==============================] - 35s 907ms/step - loss: 0.1031 - f1: 0.9010
Epoch 40/100
39/39 [==============================] - 36s 918ms/step - loss: 0.0921 - f1: 0.9101
Epoch 41/100
39/39 [==============================] - 36s 933ms/step - loss: 0.0967 - f1: 0.9030
Epoch 42/100
39/39 [==============================] - 37s 943ms/step - loss: 0.1032 - f1: 0.9002
Epoch 43/100
39/39 [==============================] - 36s 923ms/step - loss: 0.0937 - f1: 0.9060
Epoch 44/100
39/39 [==============================] - 36s 923ms/step - loss: 0.1141 - f1: 0.8853
Epoch 45/100
39/39 [==============================] - 36s 930ms/step - loss: 0.0877 - f1: 0.9156
Epoch 46/100
39/39 [==============================] - 35s 906ms/step - loss: 0.0876 - f1: 0.9122
Epoch 47/100
39/39 [==============================] - 36s 915ms/step - loss: 0.0845 - f1: 0.9161
Epoch 48/100
39/39 [==============================] - 36s 920ms/step - loss: 0.0834 - f1: 0.9181
Epoch 49/100
39/39 [==============================] - 36s 913ms/step - loss: 0.0881 - f1: 0.9088
Epoch 50/100
39/39 [==============================] - 36s 922ms/step - loss: 0.1094 - f1: 0.8892
Epoch 51/100
39/39 [==============================] - 35s 903ms/step - loss: 0.0854 - f1: 0.9165
Epoch 52/100
39/39 [==============================] - 35s 910ms/step - loss: 0.0916 - f1: 0.9068
Epoch 53/100
39/39 [==============================] - 35s 908ms/step - loss: 0.0889 - f1: 0.9141
Epoch 54/100
39/39 [==============================] - 35s 908ms/step - loss: 0.0857 - f1: 0.9184
Epoch 55/100
39/39 [==============================] - 36s 927ms/step - loss: 0.1565 - f1: 0.8418
Epoch 56/100
39/39 [==============================] - 35s 907ms/step - loss: 0.1408 - f1: 0.8615
Epoch 57/100
39/39 [==============================] - 36s 923ms/step - loss: 0.1135 - f1: 0.8883
Epoch 58/100
39/39 [==============================] - 36s 919ms/step - loss: 0.1049 - f1: 0.8934
Epoch 59/100
39/39 [==============================] - 35s 910ms/step - loss: 0.0958 - f1: 0.9053
Epoch 60/100
39/39 [==============================] - 37s 939ms/step - loss: 0.0930 - f1: 0.9053
Epoch 61/100
39/39 [==============================] - 36s 920ms/step - loss: 0.0937 - f1: 0.9049
Epoch 62/100
39/39 [==============================] - 35s 896ms/step - loss: 0.0912 - f1: 0.9082
Epoch 63/100
39/39 [==============================] - 36s 913ms/step - loss: 0.0879 - f1: 0.9131
Epoch 64/100
39/39 [==============================] - 36s 931ms/step - loss: 0.0900 - f1: 0.9089
Epoch 65/100
39/39 [==============================] - 36s 929ms/step - loss: 0.0806 - f1: 0.9200
Epoch 66/100
39/39 [==============================] - 36s 919ms/step - loss: 0.0850 - f1: 0.9182
Epoch 67/100
39/39 [==============================] - 36s 911ms/step - loss: 0.0816 - f1: 0.9197
Epoch 68/100
39/39 [==============================] - 36s 916ms/step - loss: 0.0759 - f1: 0.9254
Epoch 69/100
39/39 [==============================] - 36s 916ms/step - loss: 0.0751 - f1: 0.9253
Epoch 70/100
39/39 [==============================] - 36s 911ms/step - loss: 0.0762 - f1: 0.9242
Epoch 71/100
39/39 [==============================] - 37s 934ms/step - loss: 0.0778 - f1: 0.9206
Epoch 72/100
39/39 [==============================] - 35s 904ms/step - loss: 0.0817 - f1: 0.9143
Epoch 73/100
39/39 [==============================] - 36s 918ms/step - loss: 0.0862 - f1: 0.9109
Epoch 74/100
39/39 [==============================] - 36s 923ms/step - loss: 0.0825 - f1: 0.9190
Epoch 75/100
39/39 [==============================] - 36s 912ms/step - loss: 0.0849 - f1: 0.9155
Epoch 76/100
39/39 [==============================] - 35s 898ms/step - loss: 0.0903 - f1: 0.9117
Epoch 77/100
39/39 [==============================] - 36s 914ms/step - loss: 0.0951 - f1: 0.9060
Epoch 78/100
39/39 [==============================] - 36s 926ms/step - loss: 0.0916 - f1: 0.9059
Epoch 79/100
39/39 [==============================] - 36s 925ms/step - loss: 0.0781 - f1: 0.9190
Epoch 80/100
39/39 [==============================] - 35s 903ms/step - loss: 0.0737 - f1: 0.9274
Epoch 81/100
39/39 [==============================] - 35s 910ms/step - loss: 0.0734 - f1: 0.9278
Epoch 82/100
39/39 [==============================] - 35s 897ms/step - loss: 0.0913 - f1: 0.9087
Epoch 83/100
39/39 [==============================] - 35s 905ms/step - loss: 0.0737 - f1: 0.9256
Epoch 84/100
39/39 [==============================] - 36s 932ms/step - loss: 0.0761 - f1: 0.9217
Epoch 85/100
39/39 [==============================] - 36s 915ms/step - loss: 0.0703 - f1: 0.9310
Epoch 86/100
39/39 [==============================] - 36s 917ms/step - loss: 0.0754 - f1: 0.9245
Epoch 87/100
39/39 [==============================] - 35s 902ms/step - loss: 0.0745 - f1: 0.9233
Epoch 88/100
39/39 [==============================] - 35s 902ms/step - loss: 0.0727 - f1: 0.9265
Epoch 89/100
39/39 [==============================] - 36s 913ms/step - loss: 0.0703 - f1: 0.9303
Epoch 90/100
39/39 [==============================] - 36s 920ms/step - loss: 0.0989 - f1: 0.9020
Epoch 91/100
39/39 [==============================] - 37s 944ms/step - loss: 0.0778 - f1: 0.9212
Epoch 92/100
39/39 [==============================] - 36s 925ms/step - loss: 0.0715 - f1: 0.9291
Epoch 93/100
39/39 [==============================] - 36s 920ms/step - loss: 0.0680 - f1: 0.9332
Epoch 94/100
39/39 [==============================] - 35s 902ms/step - loss: 0.0705 - f1: 0.9290
Epoch 95/100
39/39 [==============================] - 36s 922ms/step - loss: 0.0708 - f1: 0.9292
Epoch 96/100
39/39 [==============================] - 35s 903ms/step - loss: 0.0680 - f1: 0.9328
Epoch 97/100
39/39 [==============================] - 36s 929ms/step - loss: 0.0690 - f1: 0.9311
Epoch 98/100
39/39 [==============================] - 35s 897ms/step - loss: 0.0665 - f1: 0.9356
Epoch 99/100
39/39 [==============================] - 36s 922ms/step - loss: 0.0699 - f1: 0.9304
Epoch 100/100
39/39 [==============================] - 35s 894ms/step - loss: 0.0689 - f1: 0.9315
Now predicting on train set (0.2 dropout)
Accuracy: 0.9879396984924623
Precision: 0.9699769053117783
Recall: 0.8993576017130621
F1 score: 0.933333


Now predicting on test set (0.2 dropout)
Accuracy: 0.9878048780487805
Precision: 0.9514563106796117
Recall: 0.9245283018867925
F1 score: 0.937799


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9831144465290806
Precision: 0.9565217391304348
Recall: 0.8627450980392157
F1 score: 0.907216


saving LSTM model remote_code_execution.  09:14




Process finished with exit code 0
