C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  22:59
cutoff 5175
cutoff2 6284
Creating training dataset... (open_redirect)
Creating validation dataset...
Creating finaltest dataset...
Train length: 5175
Test length: 1109
Finaltesting length: 1109
time:  22:59
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  22:59
5175 samples in the training set.
1109 samples in the validation set.
1109 samples in the final test set.
percentage of vulnerable samples: 16.27%
absolute amount of vulnerable samples in test set: 191
Starting LSTM:  22:59
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-03 22:59:58.370391: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 22:59:59.117055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  22:59
2021-12-03 23:00:00.001702: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 828000000 exceeds 10% of free system memory.
Epoch 1/100
2021-12-03 23:00:02.732856: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
41/41 [==============================] - 5s 23ms/step - loss: 0.6500 - f1: 0.3718
Epoch 2/100
41/41 [==============================] - 1s 22ms/step - loss: 0.4999 - f1: 0.5125
Epoch 3/100
41/41 [==============================] - 1s 22ms/step - loss: 0.3732 - f1: 0.6415
Epoch 4/100
41/41 [==============================] - 1s 22ms/step - loss: 0.2769 - f1: 0.7351
Epoch 5/100
41/41 [==============================] - 1s 22ms/step - loss: 0.2371 - f1: 0.7675
Epoch 6/100
41/41 [==============================] - 1s 22ms/step - loss: 0.2229 - f1: 0.7828
Epoch 7/100
41/41 [==============================] - 1s 22ms/step - loss: 0.2173 - f1: 0.7878
Epoch 8/100
41/41 [==============================] - 1s 21ms/step - loss: 0.1803 - f1: 0.8261
Epoch 9/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1712 - f1: 0.8373
Epoch 10/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1468 - f1: 0.8589
Epoch 11/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1570 - f1: 0.8476
Epoch 12/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1418 - f1: 0.8579
Epoch 13/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1213 - f1: 0.8858
Epoch 14/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1125 - f1: 0.8950
Epoch 15/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1142 - f1: 0.8910
Epoch 16/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1110 - f1: 0.8927
Epoch 17/100
41/41 [==============================] - 1s 21ms/step - loss: 0.1037 - f1: 0.8993
Epoch 18/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0930 - f1: 0.9120
Epoch 19/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1067 - f1: 0.8955
Epoch 20/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0992 - f1: 0.9061
Epoch 21/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0970 - f1: 0.9073
Epoch 22/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0924 - f1: 0.9117
Epoch 23/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0876 - f1: 0.9147
Epoch 24/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0804 - f1: 0.9224
Epoch 25/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0800 - f1: 0.9243
Epoch 26/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0840 - f1: 0.9183
Epoch 27/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0823 - f1: 0.9217
Epoch 28/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0788 - f1: 0.9238
Epoch 29/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0740 - f1: 0.9290
Epoch 30/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0771 - f1: 0.9246
Epoch 31/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0747 - f1: 0.9307
Epoch 32/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0693 - f1: 0.9342
Epoch 33/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0702 - f1: 0.9324
Epoch 34/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0704 - f1: 0.9301
Epoch 35/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0755 - f1: 0.9276
Epoch 36/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0632 - f1: 0.9389
Epoch 37/100
41/41 [==============================] - 1s 21ms/step - loss: 0.0620 - f1: 0.9382
Epoch 38/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0590 - f1: 0.9402
Epoch 39/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0603 - f1: 0.9382
Epoch 40/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0596 - f1: 0.9399
Epoch 41/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0577 - f1: 0.9435
Epoch 42/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0602 - f1: 0.9416
Epoch 43/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0613 - f1: 0.9388
Epoch 44/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0588 - f1: 0.9437
Epoch 45/100
41/41 [==============================] - 1s 21ms/step - loss: 0.0604 - f1: 0.9399
Epoch 46/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0650 - f1: 0.9366
Epoch 47/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0655 - f1: 0.9356
Epoch 48/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0595 - f1: 0.9427
Epoch 49/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0609 - f1: 0.9390
Epoch 50/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0560 - f1: 0.9460
Epoch 51/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0587 - f1: 0.9427
Epoch 52/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0575 - f1: 0.9427
Epoch 53/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0576 - f1: 0.9429
Epoch 54/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0549 - f1: 0.9467
Epoch 55/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0565 - f1: 0.9424
Epoch 56/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0549 - f1: 0.9459
Epoch 57/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0558 - f1: 0.9440
Epoch 58/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0566 - f1: 0.9439
Epoch 59/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0545 - f1: 0.9458
Epoch 60/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0619 - f1: 0.9394
Epoch 61/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0565 - f1: 0.9450
Epoch 62/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0528 - f1: 0.9486
Epoch 63/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0526 - f1: 0.9483
Epoch 64/100
41/41 [==============================] - 1s 21ms/step - loss: 0.0528 - f1: 0.9472
Epoch 65/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0531 - f1: 0.9480
Epoch 66/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0520 - f1: 0.9494
Epoch 67/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0517 - f1: 0.9492
Epoch 68/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0540 - f1: 0.9475
Epoch 69/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0549 - f1: 0.9470
Epoch 70/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0553 - f1: 0.9441
Epoch 71/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0566 - f1: 0.9439
Epoch 72/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0528 - f1: 0.9488
Epoch 73/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0588 - f1: 0.9412
Epoch 74/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0522 - f1: 0.9480
Epoch 75/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0565 - f1: 0.9439
Epoch 76/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0535 - f1: 0.9475
Epoch 77/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0557 - f1: 0.9458
Epoch 78/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0528 - f1: 0.9494
Epoch 79/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0562 - f1: 0.9451
Epoch 80/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0582 - f1: 0.9404
Epoch 81/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0568 - f1: 0.9439
Epoch 82/100
41/41 [==============================] - 1s 21ms/step - loss: 0.0587 - f1: 0.9435
Epoch 83/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0567 - f1: 0.9426
Epoch 84/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0608 - f1: 0.9438
Epoch 85/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0566 - f1: 0.9456
Epoch 86/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0497 - f1: 0.9522
Epoch 87/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0467 - f1: 0.9551
Epoch 88/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0476 - f1: 0.9542
Epoch 89/100
41/41 [==============================] - 1s 22ms/step - loss: 0.0453 - f1: 0.9561
Epoch 90/100
41/41 [==============================] - 1s 22ms/step - loss: 0.1140 - f1: 0.8745
Epoch 91/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7178 - f1: 0.2791
Epoch 92/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7176 - f1: 0.2783
Epoch 93/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7177 - f1: 0.2814
Epoch 94/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7160 - f1: 0.2806
Epoch 95/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7165 - f1: 0.2794
Epoch 96/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7158 - f1: 0.2799
Epoch 97/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7154 - f1: 0.2811
Epoch 98/100
41/41 [==============================] - 1s 22ms/step - loss: 0.7134 - f1: 0.2834
Epoch 99/100
41/41 [==============================] - 1s 22ms/step - loss: 0.4351 - f1: 0.5704
Epoch 100/100
41/41 [==============================] - 1s 21ms/step - loss: 0.0852 - f1: 0.9202
Now predicting on train set (0.2 dropout)
Accuracy: 0.9841545893719806
Precision: 0.9679802955665024
Recall: 0.9334916864608076
F1 score: 0.950423


Now predicting on test set (0.2 dropout)
Accuracy: 0.9738503155996393
Precision: 0.9354838709677419
Recall: 0.9109947643979057
F1 score: 0.923077


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9747520288548241
Precision: 0.9333333333333333
Recall: 0.9238578680203046
F1 score: 0.928571


saving LSTM model open_redirect.  23:01




Process finished with exit code 0
