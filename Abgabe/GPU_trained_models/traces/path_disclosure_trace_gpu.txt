C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  23:11
cutoff 14405
cutoff2 17492
Creating training dataset... (path_disclosure)
Creating validation dataset...
Creating finaltest dataset...
Train length: 14405
Test length: 3087
Finaltesting length: 3087
time:  23:12
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  23:12
14405 samples in the training set.
3087 samples in the validation set.
3087 samples in the final test set.
percentage of vulnerable samples: 16.68%
absolute amount of vulnerable samples in test set: 469
Starting LSTM:  23:12
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-03 23:12:19.228237: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 23:12:20.103017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  23:12
2021-12-03 23:12:31.554916: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 2304800000 exceeds 10% of free system memory.
Epoch 1/100
2021-12-03 23:12:35.987472: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
113/113 [==============================] - 7s 23ms/step - loss: 0.6539 - f1: 0.3500
Epoch 2/100
113/113 [==============================] - 3s 23ms/step - loss: 0.4704 - f1: 0.5368
Epoch 3/100
113/113 [==============================] - 3s 23ms/step - loss: 0.3344 - f1: 0.6723
Epoch 4/100
113/113 [==============================] - 3s 22ms/step - loss: 0.2953 - f1: 0.7066
Epoch 5/100
113/113 [==============================] - 3s 23ms/step - loss: 0.2491 - f1: 0.7535
Epoch 6/100
113/113 [==============================] - 3s 23ms/step - loss: 0.2244 - f1: 0.7784
Epoch 7/100
113/113 [==============================] - 3s 23ms/step - loss: 0.2009 - f1: 0.8048
Epoch 8/100
113/113 [==============================] - 3s 23ms/step - loss: 0.1900 - f1: 0.8120
Epoch 9/100
113/113 [==============================] - 3s 23ms/step - loss: 0.1660 - f1: 0.8358
Epoch 10/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1521 - f1: 0.8510
Epoch 11/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1445 - f1: 0.8563
Epoch 12/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1383 - f1: 0.8640
Epoch 13/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1376 - f1: 0.8630
Epoch 14/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1232 - f1: 0.8790
Epoch 15/100
113/113 [==============================] - 3s 22ms/step - loss: 0.1316 - f1: 0.8728
Epoch 16/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1182 - f1: 0.8851
Epoch 17/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1153 - f1: 0.8866
Epoch 18/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1115 - f1: 0.8912
Epoch 19/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1205 - f1: 0.8806
Epoch 20/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1134 - f1: 0.8890
Epoch 21/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1011 - f1: 0.9009
Epoch 22/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1093 - f1: 0.8922
Epoch 23/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1082 - f1: 0.8936
Epoch 24/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1075 - f1: 0.8925
Epoch 25/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1008 - f1: 0.9010
Epoch 26/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1044 - f1: 0.8965
Epoch 27/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0985 - f1: 0.9032
Epoch 28/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1036 - f1: 0.8987
Epoch 29/100
113/113 [==============================] - 2s 22ms/step - loss: 0.1079 - f1: 0.8954
Epoch 30/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0967 - f1: 0.9037
Epoch 31/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0898 - f1: 0.9118
Epoch 32/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0870 - f1: 0.9140
Epoch 33/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0826 - f1: 0.9176
Epoch 34/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0774 - f1: 0.9231
Epoch 35/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0774 - f1: 0.9232
Epoch 36/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0777 - f1: 0.9244
Epoch 37/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0860 - f1: 0.9152
Epoch 38/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0775 - f1: 0.9232
Epoch 39/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0727 - f1: 0.9292
Epoch 40/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0714 - f1: 0.9306
Epoch 41/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0870 - f1: 0.9143
Epoch 42/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0724 - f1: 0.9296
Epoch 43/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0655 - f1: 0.9355
Epoch 44/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0671 - f1: 0.9334
Epoch 45/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0650 - f1: 0.9364
Epoch 46/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0646 - f1: 0.9363
Epoch 47/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0617 - f1: 0.9388
Epoch 48/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0608 - f1: 0.9399
Epoch 49/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0633 - f1: 0.9368
Epoch 50/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0619 - f1: 0.9385
Epoch 51/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0793 - f1: 0.9221
Epoch 52/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0681 - f1: 0.9325
Epoch 53/100
113/113 [==============================] - 3s 23ms/step - loss: 0.0636 - f1: 0.9372
Epoch 54/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0611 - f1: 0.9398
Epoch 55/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0579 - f1: 0.9434
Epoch 56/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0732 - f1: 0.9288
Epoch 57/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0575 - f1: 0.9432
Epoch 58/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0575 - f1: 0.9435
Epoch 59/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0571 - f1: 0.9437
Epoch 60/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0582 - f1: 0.9429
Epoch 61/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0536 - f1: 0.9480
Epoch 62/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0523 - f1: 0.9483
Epoch 63/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0617 - f1: 0.9398
Epoch 64/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0534 - f1: 0.9470
Epoch 65/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0560 - f1: 0.9463
Epoch 66/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0544 - f1: 0.9458
Epoch 67/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0605 - f1: 0.9419
Epoch 68/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0576 - f1: 0.9429
Epoch 69/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0675 - f1: 0.9343
Epoch 70/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0600 - f1: 0.9401
Epoch 71/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0482 - f1: 0.9535
Epoch 72/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0453 - f1: 0.9558
Epoch 73/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0450 - f1: 0.9563
Epoch 74/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0527 - f1: 0.9482
Epoch 75/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0488 - f1: 0.9524
Epoch 76/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0447 - f1: 0.9553
Epoch 77/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0533 - f1: 0.9489
Epoch 78/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0448 - f1: 0.9576
Epoch 79/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0389 - f1: 0.9616
Epoch 80/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0466 - f1: 0.9542
Epoch 81/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0356 - f1: 0.9653
Epoch 82/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0343 - f1: 0.9665
Epoch 83/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0315 - f1: 0.9697
Epoch 84/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0310 - f1: 0.9692
Epoch 85/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0304 - f1: 0.9708
Epoch 86/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0313 - f1: 0.9692
Epoch 87/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0310 - f1: 0.9693
Epoch 88/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0341 - f1: 0.9663
Epoch 89/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0332 - f1: 0.9674
Epoch 90/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0414 - f1: 0.9596
Epoch 91/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0332 - f1: 0.9685
Epoch 92/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0339 - f1: 0.9671
Epoch 93/100
113/113 [==============================] - 3s 24ms/step - loss: 0.0300 - f1: 0.9710
Epoch 94/100
113/113 [==============================] - 3s 24ms/step - loss: 0.0440 - f1: 0.9569
Epoch 95/100
113/113 [==============================] - 3s 22ms/step - loss: 0.0412 - f1: 0.9596
Epoch 96/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0344 - f1: 0.9667
Epoch 97/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0314 - f1: 0.9690
Epoch 98/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0301 - f1: 0.9708
Epoch 99/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0359 - f1: 0.9649
Epoch 100/100
113/113 [==============================] - 2s 22ms/step - loss: 0.0327 - f1: 0.9679
Now predicting on train set (0.2 dropout)
Accuracy: 0.9907670947587643
Precision: 0.9850427350427351
Recall: 0.9592176446109031
F1 score: 0.971959


Now predicting on test set (0.2 dropout)
Accuracy: 0.9841269841269841
Precision: 0.9545454545454546
Recall: 0.9402985074626866
F1 score: 0.947368


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9831551668286362
Precision: 0.9676113360323887
Recall: 0.9299610894941635
F1 score: 0.948413


saving LSTM model path_disclosure.  23:16




Process finished with exit code 0
