C:\Python39\python.exe "C:/Users/Lejan/Desktop/Vulnerability Detection/VulnerabilityDetection-master/VulnerabilityDetection-master/Code/makemodel.py"
finished loading.  23:33
cutoff 4975
cutoff2 6041
Creating training dataset... (remote_code_execution)
Creating validation dataset...
Creating finaltest dataset...
Train length: 4975
Test length: 1066
Finaltesting length: 1066
time:  23:33
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:243: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_train =  numpy.array(TrainX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:249: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_test =  numpy.array(ValidateX)
C:\Users\Lejan\Desktop\Vulnerability Detection\VulnerabilityDetection-master\VulnerabilityDetection-master\Code\makemodel.py:251: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  X_finaltest =  numpy.array(FinaltestX)
numpy array done.  23:33
4975 samples in the training set.
1066 samples in the validation set.
1066 samples in the final test set.
percentage of vulnerable samples: 9.38%
absolute amount of vulnerable samples in test set: 112
Starting LSTM:  23:33
Dropout: 0.2
Neurons: 100
Optimizer: adam
Epochs: 100
Batch Size: 128
max length: 200
2021-12-03 23:33:45.594804: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-03 23:33:46.020584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3969 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5
Compiled LSTM:  23:33
2021-12-03 23:33:46.897304: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 796000000 exceeds 10% of free system memory.
Epoch 1/100
2021-12-03 23:33:49.619285: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8200
39/39 [==============================] - 5s 23ms/step - loss: 0.7748 - f1: 0.2324
Epoch 2/100
39/39 [==============================] - 1s 22ms/step - loss: 0.4716 - f1: 0.5531
Epoch 3/100
39/39 [==============================] - 1s 22ms/step - loss: 0.3268 - f1: 0.6817
Epoch 4/100
39/39 [==============================] - 1s 22ms/step - loss: 0.2346 - f1: 0.7739
Epoch 5/100
39/39 [==============================] - 1s 22ms/step - loss: 0.2450 - f1: 0.7590
Epoch 6/100
39/39 [==============================] - 1s 22ms/step - loss: 0.2597 - f1: 0.7456
Epoch 7/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1989 - f1: 0.8085
Epoch 8/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1754 - f1: 0.8289
Epoch 9/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1748 - f1: 0.8274
Epoch 10/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1647 - f1: 0.8317
Epoch 11/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1653 - f1: 0.8385
Epoch 12/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1497 - f1: 0.8516
Epoch 13/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1387 - f1: 0.8604
Epoch 14/100
39/39 [==============================] - 1s 21ms/step - loss: 0.1424 - f1: 0.8551
Epoch 15/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1395 - f1: 0.8600
Epoch 16/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1724 - f1: 0.8293
Epoch 17/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1204 - f1: 0.8845
Epoch 18/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1153 - f1: 0.8860
Epoch 19/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1124 - f1: 0.8884
Epoch 20/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1113 - f1: 0.8929
Epoch 21/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1157 - f1: 0.8839
Epoch 22/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1077 - f1: 0.8946
Epoch 23/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1065 - f1: 0.8944
Epoch 24/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1059 - f1: 0.8935
Epoch 25/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0992 - f1: 0.9013
Epoch 26/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1117 - f1: 0.8896
Epoch 27/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1083 - f1: 0.8921
Epoch 28/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1044 - f1: 0.8959
Epoch 29/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1169 - f1: 0.8841
Epoch 30/100
39/39 [==============================] - 1s 22ms/step - loss: 0.2593 - f1: 0.7464
Epoch 31/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1331 - f1: 0.8704
Epoch 32/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0965 - f1: 0.9073
Epoch 33/100
39/39 [==============================] - 1s 21ms/step - loss: 0.0851 - f1: 0.9159
Epoch 34/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0925 - f1: 0.9080
Epoch 35/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0996 - f1: 0.8975
Epoch 36/100
39/39 [==============================] - 1s 22ms/step - loss: 0.3658 - f1: 0.6313
Epoch 37/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1413 - f1: 0.8657
Epoch 38/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1020 - f1: 0.9027
Epoch 39/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0843 - f1: 0.9165
Epoch 40/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0885 - f1: 0.9096
Epoch 41/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0843 - f1: 0.9155
Epoch 42/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0872 - f1: 0.9146
Epoch 43/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0828 - f1: 0.9176
Epoch 44/100
39/39 [==============================] - 1s 22ms/step - loss: 0.1176 - f1: 0.8888
Epoch 45/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0914 - f1: 0.9178
Epoch 46/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0769 - f1: 0.9245
Epoch 47/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0697 - f1: 0.9352
Epoch 48/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0559 - f1: 0.9493
Epoch 49/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0505 - f1: 0.9525
Epoch 50/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0480 - f1: 0.9547
Epoch 51/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0433 - f1: 0.9598
Epoch 52/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0368 - f1: 0.9656
Epoch 53/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0434 - f1: 0.9560
Epoch 54/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0411 - f1: 0.9596
Epoch 55/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0427 - f1: 0.9580
Epoch 56/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0439 - f1: 0.9573
Epoch 57/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0441 - f1: 0.9562
Epoch 58/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0408 - f1: 0.9588
Epoch 59/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0391 - f1: 0.9614
Epoch 60/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0390 - f1: 0.9608
Epoch 61/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0364 - f1: 0.9645
Epoch 62/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0435 - f1: 0.9577
Epoch 63/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0436 - f1: 0.9585
Epoch 64/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0410 - f1: 0.9580
Epoch 65/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0427 - f1: 0.9541
Epoch 66/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0415 - f1: 0.9573
Epoch 67/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0391 - f1: 0.9610
Epoch 68/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0415 - f1: 0.9593
Epoch 69/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0381 - f1: 0.9613
Epoch 70/100
39/39 [==============================] - 1s 23ms/step - loss: 0.0372 - f1: 0.9642
Epoch 71/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0430 - f1: 0.9574
Epoch 72/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0361 - f1: 0.9648
Epoch 73/100
39/39 [==============================] - 1s 23ms/step - loss: 0.0338 - f1: 0.9675
Epoch 74/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0367 - f1: 0.9648
Epoch 75/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0407 - f1: 0.9591
Epoch 76/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0389 - f1: 0.9601
Epoch 77/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0359 - f1: 0.9638
Epoch 78/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0386 - f1: 0.9600
Epoch 79/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0386 - f1: 0.9612
Epoch 80/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0368 - f1: 0.9644
Epoch 81/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0349 - f1: 0.9656
Epoch 82/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0327 - f1: 0.9673
Epoch 83/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0311 - f1: 0.9702
Epoch 84/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0341 - f1: 0.9653
Epoch 85/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0331 - f1: 0.9667
Epoch 86/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0338 - f1: 0.9653
Epoch 87/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0348 - f1: 0.9645
Epoch 88/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0336 - f1: 0.9674
Epoch 89/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0366 - f1: 0.9621
Epoch 90/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0342 - f1: 0.9648
Epoch 91/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0329 - f1: 0.9672
Epoch 92/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0337 - f1: 0.9662
Epoch 93/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0351 - f1: 0.9628
Epoch 94/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0347 - f1: 0.9659
Epoch 95/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0339 - f1: 0.9675
Epoch 96/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0338 - f1: 0.9672
Epoch 97/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0368 - f1: 0.9641
Epoch 98/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0345 - f1: 0.9675
Epoch 99/100
39/39 [==============================] - 1s 22ms/step - loss: 0.0339 - f1: 0.9667
Epoch 100/100
39/39 [==============================] - 1s 21ms/step - loss: 0.0380 - f1: 0.9598
Now predicting on train set (0.2 dropout)
Accuracy: 0.9935678391959799
Precision: 0.9657387580299786
Recall: 0.9657387580299786
F1 score: 0.965739


Now predicting on test set (0.2 dropout)
Accuracy: 0.9934333958724203
Precision: 0.972972972972973
Recall: 0.9642857142857143
F1 score: 0.968610


Now predicting on finaltest set (0.2 dropout)
Accuracy: 0.9924953095684803
Precision: 0.9583333333333334
Recall: 0.9583333333333334
F1 score: 0.958333


saving LSTM model remote_code_execution.  23:35




Process finished with exit code 0
